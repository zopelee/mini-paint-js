function VINTAGE_CLASS(){var e=!1;this.adjust_color=function(e,a,t,i){var r=0,s=0,n=e.getImageData(0,0,a,t),o=ImageFilters.ColorTransformFilter(n,1,1,1,1,i,r,s,1);e.putImageData(o,0,0)},this.lower_contrast=function(e,a,t,i){var r=e.getImageData(0,0,a,t),s=ImageFilters.BrightnessContrastPhotoshop(r,0,-i);e.putImageData(s,0,0)},this.blur=function(e,a,t,i){if(i<1)return e;var r=e.getImageData(0,0,a,t),s=ImageFilters.GaussianBlur(r,i);e.putImageData(s,0,0)},this.light_leak=function(e,a,t,i){var r=this.getRandomInt(0,a),s=this.getRandomInt(0,t),n=.6*Math.min(a,t),o=canvas_active().createRadialGradient(r,s,n*i/255,r,s,n);o.addColorStop(0,"rgba(255, 165, 0, "+i/255+")"),o.addColorStop(1,"rgba(255, 255, 255, 0)"),e.fillStyle=o,e.fillRect(0,0,a,t)},this.chemicals=function(e,a,t,i){var r=e.getImageData(0,0,a,t),s=ImageFilters.HSLAdjustment(r,0,-i,0);e.putImageData(s,0,0)},this.exposure=function(e,a,t,i){e.rect(0,0,a,t);var r=canvas_active().createLinearGradient(0,0,0,t);this.getRandomInt(1,10)<5?(r.addColorStop(0,"rgba(0, 0, 0, "+i/255+")"),r.addColorStop(1,"rgba(255, 255, 255, "+i/255+")")):(r.addColorStop(0,"rgba(255, 255, 255, "+i/255+")"),r.addColorStop(1,"rgba(0, 0, 0, "+i/255+")")),e.fillStyle=r,e.fill()},this.grains=function(e,a,t,i){if(0==i)return e;for(var r=e.getImageData(0,0,a,t),s=r.data,n=0;n<t;n++)for(var o=0;o<a;o++){var l=4*(o+n*a);if(0!=s[l+3]){var c=this.getRandomInt(0,i);0!=c&&(s[l]-c<0?s[l]=-(s[l]-c):s[l]=s[l]-c,s[l+1]-c<0?s[l+1]=-(s[l+1]-c):s[l+1]=s[l+1]-c,s[l+2]-c<0?s[l+2]=-(s[l+2]-c):s[l+2]=s[l+2]-c)}}e.putImageData(r,0,0)},this.grains_big=function(e,a,t,i){if(0==i)return e;for(var r=a*t/100*i,s=200,n=0;n<r;n++){var o=this.getRandomInt(5,10+i),l=2,c=this.getRandomInt(0,a),d=this.getRandomInt(0,t);e.fillStyle="rgba("+s+", "+s+", "+s+", "+o/255+")",e.fillRect(c,d,l,l)}},this.optics=function(a,t,i,r,s){0==e&&(e=fx.canvas());var n=e.texture(a.getImageData(0,0,t,i));e.draw(n).vignette(r,s).update(),a.drawImage(e,0,0)},this.dusts=function(e,a,t,i){var r=i/100*(a*t)/1e3;e.fillStyle="rgba(200, 200, 200, 0.3)";for(var s=0;s<r;s++){var n=this.getRandomInt(0,a),o=this.getRandomInt(0,t),l=this.getRandomInt(1,2);if(1==l)var c=1,d=this.getRandomInt(1,3);else if(2==l)var c=this.getRandomInt(1,3),d=1;e.beginPath(),e.rect(n,o,c,d),e.fill()}e.strokeStyle="rgba(200, 200, 200, 0.2)";for(var s=0;s<r/3;s++){var n=this.getRandomInt(0,a),o=this.getRandomInt(0,t),u=this.getRandomInt(5,15),h=this.getRandomInt(0,20)/10,m=Math.PI*h,v=Math.PI*(h+this.getRandomInt(7,15)/10);e.beginPath(),e.arc(n,o,u,m,v),e.stroke()}return e},this.getRandomInt=function(e,a){return Math.floor(Math.random()*(a-e+1))+e}}function SIFT_CLASS(){var e=50,a=4;this.generate_keypoints=function(t,i){var r=t.width,s=t.height;HELPER.timer_init();var n=IMAGE.trim_info(t);r=r-n.left-n.right,s=s-n.top-n.bottom;var o=document.createElement("canvas");o.width=r,o.height=s;var l=o.getContext("2d");l.drawImage(t,-n.left,-n.top,t.width,t.height);var c=l.getImageData(0,0,r,s),d=ImageFilters.GrayScale(c);l.putImageData(d,0,0);for(var u=5,h=[],m=0;m<u;m++){var v=document.createElement("canvas");v.width=r,v.height=s;var g=v.getContext("2d");g.drawImage(o,0,0);var c=g.getImageData(0,0,r,s),d=ImageFilters.GaussianBlur(c,m+.5);g.putImageData(d,0,0),h.push(v)}for(var p=[],_=2*a+1,f=1;f<h.length-1;f++)for(var c=h[f].getContext("2d").getImageData(0,0,r,s).data,I=h[f-1].getContext("2d").getImageData(0,0,r,s).data,y=h[f+1].getContext("2d").getImageData(0,0,r,s).data,b=a;b<s-a;b++)for(var m=a;m<r-a;m++){var E=4*(m+b*r);if(0!=c[E+3]&&(c[E]<c[E-4]||c[E]<c[E+4]||c[E]>c[E-4]||c[E]>c[E+4])){for(var T=4*(m+(b-1)*r),k=4*(m+(b+1)*r),H=0,P=-a;P<=a;P++)for(var w=4*(m+(b-P)*r),D=-a;D<=a;D++)H+=c[w+4*D];if(H/=_*_,c[E]+e<H){var x=Math.min(c[T-4],c[T],c[T+4],c[E-4],c[E+4],c[k-4],c[k],c[k+4]);if(c[E]<=x){var S=Math.min(I[T-4],I[T],I[T+4],I[E-4],I[E+4],I[k-4],I[k],I[k+4]);if(c[E]<=S){var R=Math.min(y[T-4],y[T],y[T+4],y[E-4],y[E+4],y[k-4],y[k],y[k+4]);c[E]<=R&&p.push({x:m+n.left,y:b+n.top,w:Math.round(H-c[E]-e)})}}continue}if(c[E]-e>H){var z=Math.max(c[T-4],c[T],c[T+4],c[E-4],c[E+4],c[k-4],c[k],c[k+4]);if(c[E]>=z){var A=Math.max(I[T-4],I[T],I[T+4],I[E-4],I[E+4],I[k-4],I[k],I[k+4]);if(c[E]>=A){var G=Math.max(y[T-4],y[T],y[T+4],y[E-4],y[E+4],y[k-4],y[k],y[k+4]);c[E]>=G&&p.push({x:m+n.left,y:b+n.top,w:Math.round(c[E]-H-e)})}}}}}for(var m=0;m<p.length;m++)for(var b=0;b<p.length;b++)if(m!=b&&p[m].x==p[b].x&&p[m].y==p[b].y){p.splice(m,1),m--;break}if(i!==!0)return p.sort(function(e,a){return parseFloat(a.w)-parseFloat(e.w)}),{points:p,trim_details:n};var L=HELPER.timer("",!0);console.log("key points: "+p.length+", "+L),LAYER.layer_add();var O=3;canvas_active().fillStyle="#ff0000";for(var m in p){var C=p[m];canvas_active().beginPath(),canvas_active().rect(C.x-Math.floor(O/2)+1,C.y-Math.floor(O/2)+1,O,O),canvas_active().fill()}},this.get_area_average=function(e,a,t,i,r){var s=a.data,n=0,o=0;r/=100;for(var l,c,d=t+Math.round(r*e.x)+Math.round(r*e.w),u=i+Math.round(r*e.y)+Math.round(r*e.h),h=4*a.width,m=i+Math.round(r*e.y);m<u;m++){l=m*h;for(var v=t+Math.round(r*e.x);v<d;v++)c=l+4*v,n+=s[c],o++}return Math.round(n/o)}}function HELPER_CLASS(){var e;this.timer_init=function(){e=Date.now()},this.timer=function(a,t){var i="time("+a+") = "+Math.round(Date.now()-e)/1e3+" s";return t===!0?i:void console.log(i)},this.strpos=function(e,a,t){var i=(e+"").indexOf(a,t||0);return i!==-1&&i},this.getCookie=function(e){return document.cookie.length>0&&(begin=document.cookie.indexOf(e+"="),begin!=-1)?(begin+=e.length+1,end=document.cookie.indexOf(";",begin),end==-1&&(end=document.cookie.length),unescape(document.cookie.substring(begin,end))):""},this.setCookie=function(e,a,t){var i=new Date;i.setTime(i.getTime()+24*t*3600*1e3),document.cookie=e+"="+escape(a)+(null==t?"":"; expires="+i.toGMTString())},this.delCookie=function(e){HELPER.getCookie(e)&&(document.cookie=e+"=; expires=Thu, 01-Jan-70 00:00:01 GMT")},this.getRandomInt=function(e,a){return Math.floor(Math.random()*(a-e+1))+e},this.font_pixel_to_height=function(e){return Math.round(.75*e)},this.rgbToHex=function(e,a,t){if(e>255||a>255||t>255)throw"Invalid color component";return(e<<16|a<<8|t).toString(16)},this.rgb2hex_all=function(e){return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+HELPER.hex(e[1])+HELPER.hex(e[2])+HELPER.hex(e[3])},this.hex=function(e){return("0"+parseInt(e).toString(16)).slice(-2)},this.hex2rgb=function(e){if("#"==e[0]&&(e=e.substr(1)),3==e.length){var a=e;e="",a=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(a).slice(1);for(var t=0;t<3;t++)e+=a[t]+a[t]}var i=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(e).slice(1);return{r:parseInt(i[0],16),g:parseInt(i[1],16),b:parseInt(i[2],16),a:255}},this.remove_selection=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},this.get_dimensions=function(){var e,a;return window.innerWidth?e=window.innerWidth:document.documentElement&&document.documentElement.clientWidth?e=document.documentElement.clientWidth:document.body&&(e=document.body.clientWidth),window.innerHeight?a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&(a=document.body.clientHeight),[e,a]},this.darkenColor=function(e,a){e.length>6&&(e=e.substring(1,e.length));var t=parseInt(e,16),i=Math.abs((t>>16&255)+a);i>255&&(i-=i-255);var r=Math.abs((t>>8&255)+a);r>255&&(r-=r-255);var s=Math.abs((255&t)+a);return s>255&&(s-=s-255),i=Number(i<0||isNaN(i))?0:(i>255?255:i).toString(16),1==i.length&&(i="0"+i),r=Number(r<0||isNaN(r))?0:(r>255?255:r).toString(16),1==r.length&&(r="0"+r),s=Number(s<0||isNaN(s))?0:(s>255?255:s).toString(16),1==s.length&&(s="0"+s),"#"+i+r+s},this.number_format=function(e,a,t,i){var a=isNaN(a=Math.abs(a))?2:a,i=void 0==i?".":i,t=void 0==t?",":t,r=e<0?"-":"",s=parseInt(e=Math.abs(+e||0).toFixed(a))+"",n=(n=s.length)>3?n%3:0;return r+(n?s.substr(0,n)+t:"")+s.substr(n).replace(/(\d{3})(?=\d)/g,"$1"+t)+(a?i+Math.abs(e-s).toFixed(a).slice(2):"")},this.chech_input_color_support=function(e){return void 0!=document.getElementById(e).value&&"#"==document.getElementById(e).value[0]},this.b64toBlob=function(e,a,t){a=a||"",t=t||512;for(var i=atob(e),r=[],s=0;s<i.length;s+=t){for(var n=i.slice(s,s+t),o=new Array(n.length),l=0;l<n.length;l++)o[l]=n.charCodeAt(l);var c=new Uint8Array(o);r.push(c)}var d=new Blob(r,{type:a});return d},this.escapeHtml=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},this.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)}}function popup(){this.active=!1,this.handler="",this.preview=!1,this.onload=!1,this.width_mini=184,this.height_mini=195,this.preview_in_main=!1,this.effects=!1,this.id=0;var e=[],a=document.createElement("canvas"),t=a.getContext("2d");this.add=function(a){e.push(a)},this.show=function(i,r,s,n){if(POP.id=HELPER.getRandomInt(0,999999999),1==this.active)return this.hide(),!1;this.active=!0,this.handler=r,void 0!=s&&(this.preview=s),void 0!=n&&(this.onload=n);var o="",l=HELPER.get_dimensions();if(popup=document.getElementById("popup"),popup.style.top="150px",popup.style.left=Math.round(l[0]/2)+"px",1==this.effects){for(var c,d=0;d<EFFECTS.FILTERS_LIST.length;d++)if(EFFECTS.FILTERS_LIST[d].name==GUI.last_menu){c=d;break}var u=c-1;u<0&&(u=0);var h=c+1;h>EFFECTS.FILTERS_LIST.length-1&&(h=EFFECTS.FILTERS_LIST.length-1),o+='<span style="float:right;">',o+='<input id="previous_filter" type="button" value="&lt;"> ',o+='<select id="effect_browser">',o+='<option class="trn" value="">--- Select effect ---</option>';for(var d=0;d<EFFECTS.FILTERS_LIST.length;d++){var m="";if(EFFECTS.FILTERS_LIST[d].name==GUI.last_menu)var m="selected";o+=" <option "+m+' value="'+d+'">'+EFFECTS.FILTERS_LIST[d].title+"</option>"}o+="</select>",o+=' <input id="next_filter" onclick="" type="button" value="&gt;"> ',o+="</span>"}o+='<h2 id="popup_drag" class="trn">'+i+"</h2>",this.preview!==!1&&0==this.preview_in_main&&(o+='<div style="margin-top:15px;margin-bottom:15px;">',o+='<canvas style="position:relative;float:left;margin-right:5px;border:1px solid #393939;" width="'+POP.width_mini+'" height="'+POP.height_mini+'" id="pop_pre"></canvas>',o+='<canvas style="position:relative;border:1px solid #393939;background-color:#ffffff;" width="'+POP.width_mini+'" height="'+POP.height_mini+'" id="pop_post"></canvas>',o+="</div>"),o+='<table style="width:99%;">';for(var d in e){var v=e[d];if(o+='<tr id="popup-tr-'+e[d].name+'">',"Error"!=i&&(o+='<td style="font-weight:bold;padding-right:3px;width:130px;" class="trn">'+v.title+"</td>"),void 0!=v.name){if(void 0!=v.values){var g="";if(void 0!=v.onchange&&(g=' onchange="'+v.onchange+';" '),v.values.length>10||"select"==v.type){""==g&&void 0!=s&&(g=' onchange="POP.view();" '),o+='<td colspan="2"><select '+g+' style="font-size:12px;" id="pop_data_'+v.name+'">';var p=0;for(var _ in v.values){var f="";v.value==v.values[_]&&(f='selected="selected"'),void 0==v.value&&0==p&&(f='selected="selected"'),o+="<option "+f+' name="'+v.values[_]+'">'+v.values[_]+"</option>",p++}o+="</select></td>"}else{o+='<td colspan="2">',v.values.length>2&&(o+='<div class="group">');var p=0;for(var _ in v.values){var I="";v.value==v.values[_]&&(I='checked="checked"'),void 0==v.value&&0==p&&(I='checked="checked"'),""==g&&void 0!=s&&(g=' onchange="POP.view();" '),o+='<input type="radio" '+g+" "+I+' name="'+v.name+'" id="pop_data_'+v.name+"_poptmp"+_+'" value="'+v.values[_]+'">',o+='<label style="margin-right:20px;" class="trn" for="pop_data_'+v.name+"_poptmp"+_+'">'+v.values[_]+"</label>",v.values.length>2&&(o+="<br />"),p++}v.values.length>2&&(o+="</div>"),o+="</td>"}}else if(void 0!=v.value){var y=1;if(void 0!=v.step&&(y=v.step),void 0!=v.range){var b="";this.preview!==!1&&(b="POP.view();"),o+='<td><input type="range" id="pop_data_'+v.name+'" value="'+v.value+'" min="'+v.range[0]+'" max="'+v.range[1]+'" step="'+y+'" " oninput="document.getElementById(\'pv'+d+"').innerHTML=Math.round(this.value*100)/100;"+b+'" /></td>',o+='<td style="padding-left:10px;width:50px;" id="pv'+d+'">'+v.value+"</td>"}else if("color"==v.type){var b="";this.preview!==!1&&(b="POP.view();"),o+='<td><input type="color" id="pop_data_'+v.name+'" value="'+v.value+'" onchange="'+b+'" /></td>'}else if(void 0==v.placeholder&&(v.placeholder=""),"textarea"==v.type)o+='<td><textarea style="height:80px;" id="pop_data_'+v.name+'" placeholder="'+v.placeholder+'">'+v.value+"</textarea></td>";else{var E="text";void 0==v.placeholder||""==v.placeholder||isNaN(v.placeholder)||(E="number"),void 0!=v.value&&"number"==typeof v.value&&(E="number"),o+='<td colspan="2"><input type="'+E+'" id="pop_data_'+v.name+'" value="'+v.value+'" placeholder="'+v.placeholder+'" onkeyup="POP.validate(this);" /></td>'}}}else if(void 0!=v.function){var T;T="string"==typeof v.function?window[v.function]():v.function(),o+='<td colspan="3">'+T+"</td>"}else if(void 0!=v.html)o+='<td style="padding-bottom:3px;padding-top:3px;" colspan="2">'+v.html+"</td>";else{str=""+v.value;var k=v.title.toLowerCase().replace(/[^\w]+/g,"").replace(/ +/g,"-");k=k.substring(0,10),o+=str.length<40?'<td colspan="2"><div class="trn" id="pop_data_'+k+'" style="padding: 2px 0px;">'+v.value+"</div></td>":'<td style="font-size:11px;" colspan="2"><textarea disabled="disabled">'+v.value+"</textarea></td>"}o+="</tr>"}if(o+="</table>",o+='<div style="text-align:center;margin-top:20px;margin-bottom:15px;">',o+='<button onclick="POP.save();" class="button trn">Ok</button>',o+='<button onclick="POP.hide();" class="button trn">Cancel</button>',this.preview_in_main!==!1&&(o+='<button onclick="POP.view();" class="button trn">Preview</button>'),o+="</div>",document.getElementById("popup").innerHTML=o,document.getElementById("popup").style.display="block",e.length>15?document.getElementById("popup").style.overflowY="scroll":document.getElementById("popup").style.overflowY="hidden",""!=this.onload&&("string"==typeof this.onload?window[this.onload]():this.onload()),1==this.effects){document.getElementById("previous_filter").disabled=!1,document.getElementById("next_filter").disabled=!1,0==c&&(document.getElementById("previous_filter").disabled=!0),c==EFFECTS.FILTERS_LIST.length-1&&(document.getElementById("next_filter").disabled=!0),document.getElementById("previous_filter").addEventListener("click",function(e){POP.hide(),GUI.last_menu=EFFECTS.FILTERS_LIST[u].name,call_menu(EFFECTS,EFFECTS.FILTERS_LIST[u].name)}),document.getElementById("next_filter").addEventListener("click",function(e){POP.hide(),GUI.last_menu=EFFECTS.FILTERS_LIST[h].name,call_menu(EFFECTS,EFFECTS.FILTERS_LIST[h].name)});var H=document.getElementById("effect_browser");H.addEventListener("change",function(e){var a=H.options[H.selectedIndex].value;POP.hide(),GUI.last_menu=EFFECTS.FILTERS_LIST[a].name,call_menu(EFFECTS,EFFECTS.FILTERS_LIST[a].name)})}if(this.preview!==!1&&0==this.preview_in_main){var P=document.getElementById("pop_pre").getContext("2d");P.rect(0,0,POP.width_mini,POP.height_mini),P.fillStyle="#ffffff",P.fill(),GUI.draw_background(P,POP.width_mini,POP.height_mini,5),P.drawImage(document.getElementById(LAYER.layers[LAYER.layer_active].name),0,0,POP.width_mini,POP.height_mini),pop_post=document.getElementById("pop_post").getContext("2d"),pop_post.rect(0,0,POP.width_mini,POP.height_mini),pop_post.fillStyle="#ffffff",pop_post.fill(),GUI.draw_background(pop_post,POP.width_mini,POP.height_mini,5),pop_post.drawImage(document.getElementById(LAYER.layers[LAYER.layer_active].name),0,0,POP.width_mini,POP.height_mini),a.width=POP.width_mini,a.height=POP.height_mini,t.drawImage(document.getElementById(LAYER.layers[LAYER.layer_active].name),0,0,POP.width_mini,POP.height_mini),POP.view()}HELP.help_translate(LANG)},this.hide=function(){document.getElementById("popup").style.display="none",e=[],this.handler="",this.active=!1,this.preview=!1,this.onload=!1,this.preview_in_main=!1,this.effects=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT)},this.view=function(){if(this.preview!==!1){0==this.preview_in_main&&(pop_post.clearRect(0,0,POP.width_mini,POP.height_mini),pop_post.drawImage(a,0,0));var e={};for(inputs=document.getElementsByTagName("input"),i=0;i<inputs.length;i++)if("pop_data_"==inputs[i].id.substr(0,9)){var t=inputs[i].id.substr(9);0!=HELPER.strpos(t,"_poptmp")&&(t=t.substring(0,HELPER.strpos(t,"_poptmp")));var r=inputs[i].value;"radio"==inputs[i].type?1==inputs[i].checked&&(e[t]=r):e[t]=r}for(selects=document.getElementsByTagName("select"),i=0;i<selects.length;i++)if("pop_data_"==selects[i].id.substr(0,9)){var t=selects[i].id.substr(9),r=selects[i].value;e[t]=r}for(textareas=document.getElementsByTagName("textarea"),i=0;i<textareas.length;i++)if("pop_data_"==textareas[i].id.substr(0,9)){var t=textareas[i].id.substr(9),r=textareas[i].value;e[t]=r}0==this.preview_in_main?this.preview(e,pop_post,POP.width_mini,POP.height_mini):this.preview(e)}},this.save=function(){this.active=!1,document.getElementById("popup").style.display="none";var a={};for(inputs=document.getElementsByTagName("input"),i=0;i<inputs.length;i++)if("pop_data_"==inputs[i].id.substr(0,9)){var t=inputs[i].id.substr(9);0!=HELPER.strpos(t,"_poptmp")&&(t=t.substring(0,HELPER.strpos(t,"_poptmp")));var r=inputs[i].value;"radio"==inputs[i].type?1==inputs[i].checked&&(a[t]=r):a[t]=r}for(selects=document.getElementsByTagName("select"),i=0;i<selects.length;i++)if("pop_data_"==selects[i].id.substr(0,9)){var t=selects[i].id.substr(9),r=selects[i].value;a[t]=r}for(textareas=document.getElementsByTagName("textarea"),i=0;i<textareas.length;i++)if("pop_data_"==textareas[i].id.substr(0,9)){var t=textareas[i].id.substr(9),r=textareas[i].value;a[t]=r}e=[],this.preview=!1,this.onload=!1,this.preview_in_main=!1,this.effects=!1,""!=this.handler&&("object"==typeof this.handler?this.handler[0][this.handler[1]](a):"function"==typeof this.handler?this.handler(a):console.log("error: wrong function type: "+this.handler)),this.handler=""},this.validate=function(a){for(var t in e){var i=e[t];if("pop_data_"+i.name==a.id&&void 0!=i.range){if("-"==a.value||""==a.value)return!0;var r=parseFloat(a.value);(isNaN(r)||r!=a.value)&&(a.value=i.value),r<i.range[0]?a.value=i.range[0]:r>i.range[1]&&(a.value=i.range[1])}}}}function ELEMENTS_CLASS(){this.line=function(e,a,t,i,r,s){e.beginPath(),void 0!=s&&(e.lineWidth=s),e.moveTo(a+.5,t+.5),e.lineTo(i+.5,r+.5),e.stroke()},this.rectangle=function(e,a,t,i,r,s,n){a+=.5,t+=.5,"undefined"==typeof n&&(n=!0),0==s&&void 0==n&&(n=!0),e.beginPath(),e.moveTo(a,t),e.lineTo(a+i,t),e.quadraticCurveTo(a+i,t,a+i,t),e.lineTo(a+i,t+r),e.quadraticCurveTo(a+i,t+r,a+i,t+r),e.lineTo(a,t+r),e.quadraticCurveTo(a,t+r,a,t+r),e.lineTo(a,t),e.quadraticCurveTo(a,t,a,t),e.closePath(),n&&e.stroke(),s&&e.fill()},this.square=function(e,a,t,i,r,s,n){a+=.5,t+=.5,"undefined"==typeof n&&(n=!0),0==s&&void 0==n&&(n=!0),Math.abs(i)<Math.abs(r)?i=i>0?Math.abs(r):-Math.abs(r):r=r>0?Math.abs(i):-Math.abs(i),e.beginPath(),e.moveTo(a,t),e.lineTo(a+i,t),e.quadraticCurveTo(a+i,t,a+i,t),e.lineTo(a+i,t+r),e.quadraticCurveTo(a+i,t+r,a+i,t+r),e.lineTo(a,t+r),e.quadraticCurveTo(a,t+r,a,t+r),e.lineTo(a,t),e.quadraticCurveTo(a,t,a,t),e.closePath(),n&&e.stroke(),s&&e.fill()},this.circle=function(e,a,t,i,r){e.lineWidth=1,void 0!=r?e.strokeStyle=r:e.strokeStyle="#000000",e.beginPath(),e.arc(a,t,i/2,0,2*Math.PI,!0),e.stroke()},this.ellipse_by_center=function(e,a,t,i,r,s,n){this.ellipse(e,a-i/2,t-r/2,i,r,s,n)},this.ellipse=function(e,a,t,i,r,s,n){var o=.5522848,l=i/2*o,c=r/2*o,d=a+i,u=t+r,h=a+i/2,m=t+r/2;e.beginPath(),e.moveTo(a,m),e.bezierCurveTo(a,m-c,h-l,t,h,t),e.bezierCurveTo(h+l,t,d,m-c,d,m),e.bezierCurveTo(d,m+c,h+l,u,h,u),e.bezierCurveTo(h-l,u,a,m+c,a,m),e.closePath(),e.fillStyle=s,e.strokeStyle=s,void 0==n?e.stroke():e.fill()},this.arrow=function(e,a,t,i,r,s){void 0==s&&(s=10);var n=i-a,o=r-t,l=Math.atan2(o,n);e.beginPath(),e.moveTo(a,t),e.lineTo(i,r),e.stroke(),e.beginPath(),e.moveTo(i-s*Math.cos(l-Math.PI/6),r-s*Math.sin(l-Math.PI/6)),e.lineTo(i,r),e.lineTo(i-s*Math.cos(l+Math.PI/6),r-s*Math.sin(l+Math.PI/6)),e.stroke()},this.rectangle_dashed=function(e,a,t,i,r,s,n){this.line_dashed(e,a,t,i,t,s,n),this.line_dashed(e,i,t,i,r,s,n),this.line_dashed(e,i,r,a,r,s,n),this.line_dashed(e,a,r,a,t,s,n)},this.line_dashed=function(e,a,t,i,r,s,n){a+=.5,t+=.5,i+=.5,r+=.5,void 0!=n?e.strokeStyle=n:e.strokeStyle="#000000",void 0==s&&(s=4),e.beginPath(),e.moveTo(a,t);for(var o=i-a,l=r-t,c=Math.floor(Math.sqrt(o*o+l*l)/s),d=o/c,u=l/c,h=0;h++<c;)a+=d,t+=u,e[h%2==0?"moveTo":"lineTo"](a,t);e[h%2==0?"moveTo":"lineTo"](i,r),e.stroke(),e.closePath()},this.image_round=function(e,a,t,i,r,s,n){var o=Math.round(i/2),l=s.getContext("2d"),c=a-o,d=t-o;c<0&&(c=0),d<0&&(d=0),l.clearRect(0,0,WIDTH,HEIGHT),l.save();try{l.drawImage(r,a-o,t-o,i,i)}catch(e){try{l.putImageData(r,c,d)}catch(e){console.log("Error: "+e.message)}}if(l.globalCompositeOperation="destination-in",l.fillStyle="#ffffff",1==n){var u=l.createRadialGradient(a,t,0,a,t,o);u.addColorStop(0,"#ffffff"),u.addColorStop(.8,"#ffffff"),u.addColorStop(1,"rgba(25115,255,255,0"),l.fillStyle=u}l.beginPath(),l.arc(a,t,o,0,2*Math.PI,!0),l.fill(),c+i>WIDTH&&(i=WIDTH-c),d+i>HEIGHT&&(i=HEIGHT-d),e.drawImage(s,c,d,i,i,c,d,i,i),l.restore(),l.clearRect(0,0,WIDTH,HEIGHT)}}function EVENTS_CLASS(){this.mouse={},this.ctrl_pressed=!1,this.command_pressed=!1,this.shift_pressed=!1,this.isDrag=!1,this.sr_size=8,this.clear_front_on_release=!0;var e=[!1,!1],a=[!1,!1],t=!1,i=!1,r=[0,0],s=[0,0],n=!1;this.on_keyboard_action=function(e){if(k=e.keyCode,27!=k){if(void 0!=POP&&1==POP.active)return!0;if("text"==document.activeElement.type||"number"==document.activeElement.type)return!0}if(1==e.ctrlKey&&(EVENTS.ctrl_pressed=!0),1==e.metaKey&&(EVENTS.command_pressed=!0,EVENTS.ctrl_pressed=!0),38==k){if("select_tool"==DRAW.active_tool)return EDIT.save_state(),LAYER.layer_move_active(0,-1),GUI.zoom(),!1}else if(40==k){if("select_tool"==DRAW.active_tool)return EDIT.save_state(),LAYER.layer_move_active(0,1),GUI.zoom(),!1}else if(39==k){if("select_tool"==DRAW.active_tool)return EDIT.save_state(),LAYER.layer_move_active(1,0),GUI.zoom(),!1}else if(37==k){if("select_tool"==DRAW.active_tool)return EDIT.save_state(),LAYER.layer_move_active(-1,0),GUI.zoom(),!1}else if(27==k)void 0!=POP&&1==POP.active&&POP.hide(),DRAW.last_line=[],DRAW.curve_points=[],0!=DRAW.select_data&&EDIT.edit_clear();else if(90==k)1==EVENTS.ctrl_pressed&&EDIT.undo();else if(84==k)EDIT.save_state(),IMAGE.trim();else if(79==k)FILE.open();else if(83==k)void 0!=POP&&FILE.save_dialog(e);else if(76==k)EDIT.save_state(),IMAGE.rotate_resize_doc(270,WIDTH,HEIGHT),IMAGE.rotate_layer({angle:270},canvas_active(),WIDTH,HEIGHT);else if(82==k)IMAGE.resize_box();else if(71==k)0==GUI.grid?GUI.grid=!0:GUI.grid=!1,GUI.draw_grid();else if(46==k)0!=DRAW.select_data&&(EDIT.save_state(),canvas_active().clearRect(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h),DRAW.select_data=!1,DRAW.select_square_action="",canvas_front.clearRect(0,0,WIDTH,HEIGHT));else if(16==k)EVENTS.shift_pressed=!0;else if(68==k)call_menu(LAYER,"layer_dublicate");else if(65==k){if(1==EVENTS.ctrl_pressed)return DRAW.select_data={x:0,y:0,w:WIDTH,h:HEIGHT},GUI.draw_selected_area(),!1}else 86==k?(EDIT.save_state(),1==EVENTS.ctrl_pressed&&EDIT.paste()):70==k?(EDIT.save_state(),IMAGE.auto_adjust(canvas_active(),WIDTH,HEIGHT)):72==k?IMAGE.histogram():109==k?GUI.zoom(-1):107==k?GUI.zoom(1):78==k&&LAYER.layer_add();return GUI.zoom(),!0},this.on_keyboardup_action=function(e){k=e.keyCode,16==k?EVENTS.shift_pressed=!1:0==e.ctrlKey&&1==EVENTS.ctrl_pressed?EVENTS.ctrl_pressed=!1:0==e.metaKey&&1==EVENTS.command_pressed&&(EVENTS.command_pressed=!1,EVENTS.ctrl_pressed=!1)},this.get_mouse_position=function(t){t.changedTouches&&(t=t.changedTouches[0]);var r=!0,s=t.pageX,n=t.pageY,o=document.body.getBoundingClientRect(),l=document.getElementById("canvas_front").getBoundingClientRect(),c=l.left-o.left,d=l.top-o.top,u=t.pageX-c,h=t.pageY-d;if("canvas_front"!=t.target.id&&(r=!1),"canvas_preview"==t.target.id){var m=document.getElementById("canvas_preview").getBoundingClientRect(),v=m.left-o.left,g=m.top-o.top;u=t.pageX-v,h=t.pageY-g}"canvas_preview"!=t.target.id&&100!=GUI.ZOOM&&(u=Math.floor(u/GUI.ZOOM*100),h=Math.floor(h/GUI.ZOOM*100)),EVENTS.mouse={x:u,y:h,click_x:e[0],click_y:e[1],last_x:a[0],last_y:a[1],valid:r,click_valid:i,abs_x:s,abs_y:n}},this.mouse_right_click=function(a){if(void 0!=POP&&1==POP.active)return!0;if(EVENTS.get_mouse_position(a),EVENTS.mouse.x!=EVENTS.mouse.click_x&&EVENTS.mouse.y!=EVENTS.mouse.click_y)return a.preventDefault(),a.stopPropagation(),!1;e[0]=EVENTS.mouse.x,e[1]=EVENTS.mouse.y;for(var t in DRAW)if(t==DRAW.active_tool)return DRAW[t]("right_click",EVENTS.mouse,a)},this.mouse_click=function(a){if(EVENTS.isDrag=!0,void 0!=POP&&1==POP.active)return EVENTS.get_mouse_position(a),r[0]=EVENTS.mouse.abs_x,r[1]=EVENTS.mouse.abs_y,popup=document.getElementById("popup"),s[0]=parseInt(popup.style.top),s[1]=parseInt(popup.style.left),n="popup_drag"==a.target.id,!0;if(EVENTS.get_mouse_position(a),e[0]=EVENTS.mouse.x,e[1]=EVENTS.mouse.y,3==a.which)return!0;i=0!=EVENTS.mouse.valid;for(var o in DRAW)if(o==DRAW.active_tool){DRAW[o]("click",EVENTS.mouse,a);break}"canvas_preview"==a.target.id&&EVENTS.calc_preview_by_mouse(EVENTS.mouse.x,EVENTS.mouse.y),t=!1,100==GUI.ZOOM&&("resize-w"==a.target.id?t="w":"resize-h"==a.target.id?t="h":"resize-wh"==a.target.id&&(t="wh"))},this.mouse_move=function(e){if(void 0!=POP&&1==POP.active)return 1==EVENTS.isDrag&&1==n&&(EVENTS.get_mouse_position(e),popup=document.getElementById("popup"),popup.style.top=s[0]+EVENTS.mouse.abs_y-r[1]+"px",popup.style.left=s[1]+EVENTS.mouse.abs_x-r[0]+"px"),!0;if(EVENTS.get_mouse_position(e),"canvas_preview"==e.target.id&&1==EVENTS.isDrag&&EVENTS.calc_preview_by_mouse(EVENTS.mouse.x,EVENTS.mouse.y),LAYER.update_info_block(),100==GUI.ZOOM&&("resize-w"==e.target.id?document.body.style.cursor="w-resize":"resize-h"==e.target.id?document.body.style.cursor="n-resize":"resize-wh"==e.target.id?document.body.style.cursor="nw-resize":document.body.style.cursor="auto",0!=t&&1==EVENTS.isDrag))return document.body.style.cursor="auto","w"==t?(new_w=EVENTS.mouse.x,new_h=HEIGHT):"h"==t?(new_w=WIDTH,new_h=EVENTS.mouse.y):"wh"==t&&(new_w=EVENTS.mouse.x,new_h=EVENTS.mouse.y),canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.lineWidth=1,canvas_front.fillStyle="#ff0000",EL.rectangle_dashed(canvas_front,0,0,new_w-1,new_h-1),e.preventDefault(),HELPER.remove_selection(),!1;if(EVENTS.isDrag===!1)for(i in DRAW)if(i==DRAW.active_tool){DRAW[i]("move",EVENTS.mouse,e);break}if(EVENTS.isDrag===!1)return!1;for(var i in DRAW)if(i==DRAW.active_tool){DRAW[i]("drag",EVENTS.mouse,e);break}"select_square"!=DRAW.active_tool&&(DRAW.select_square_action=""),a[0]=EVENTS.mouse.x,a[1]=EVENTS.mouse.y},this.mouse_release=function(e){if(EVENTS.isDrag=!1,void 0!=POP&&1==POP.active)return!0;EVENTS.get_mouse_position(e),a[0]=!1,a[1]=!1,""==DRAW.select_square_action&&1==EVENTS.mouse.valid&&(DRAW.select_data=!1),1==EVENTS.clear_front_on_release&&canvas_front.clearRect(0,0,WIDTH,HEIGHT),GUI.draw_selected_area();for(var i in DRAW)if(i==DRAW.active_tool){DRAW[i]("release",EVENTS.mouse,e);break}0!=t&&100==GUI.ZOOM&&EVENTS.mouse.x>0&&EVENTS.mouse.y>0&&(EDIT.save_state(),EVENTS.autosize=!1,document.body.style.cursor="auto","w"==t?WIDTH=EVENTS.mouse.x:"h"==t?HEIGHT=EVENTS.mouse.y:"wh"==t&&(WIDTH=EVENTS.mouse.x,HEIGHT=EVENTS.mouse.y),LAYER.set_canvas_size(),GUI.zoom()),t=!1,GUI.zoom()},this.upload_drop=function(e){e.preventDefault(),FILE.open_handler(e)},this.mouse_wheel_handler=function(e){if(e.preventDefault(),1==EVENTS.ctrl_pressed){var a=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));return a>0?GUI.zoom(1,!0):GUI.zoom(-1,!0),!1}},this.scroll_window=function(){var e=document.querySelector("#canvas_wrapper"),a=e.clientWidth/GUI.ZOOM*100,t=e.clientHeight/GUI.ZOOM*100;1==this.mouse.valid&&(GUI.zoom_center=[this.mouse.x/WIDTH*100,this.mouse.y/HEIGHT*100]),1==this.mouse.valid?(xx=(GUI.zoom_center[0]*WIDTH/100-a*GUI.zoom_center[0]/100)*GUI.ZOOM/100,yy=(GUI.zoom_center[1]*HEIGHT/100-t*GUI.zoom_center[1]/100)*GUI.ZOOM/100):(xx=(GUI.zoom_center[0]*WIDTH/100-a/2)*GUI.ZOOM/100,yy=(GUI.zoom_center[1]*HEIGHT/100-t/2)*GUI.ZOOM/100),e.scrollLeft=xx,e.scrollTop=yy},this.calc_preview_by_mouse=function(e,a){return GUI.zoom_center[0]=e/GUI.PREVIEW_SIZE.w*100,GUI.zoom_center[1]=a/GUI.PREVIEW_SIZE.h*100,GUI.zoom(void 0,!0),!0},this.on_resize=function(){GUI.redraw_preview();var e=HELPER.get_dimensions();popup=document.getElementById("popup"),popup.style.top="150px",popup.style.left=Math.round(e[0]/2)+"px",document.querySelector("#sidebar_left").classList.remove("active"),document.querySelector("#sidebar_right").classList.remove("active")};var o=this;o.bindAllEvents=function(){document.onkeydown=function(e){return EVENTS.on_keyboard_action(e)},document.onkeyup=function(e){return EVENTS.on_keyboardup_action(e)},window.ondrop=function(e){EVENTS.upload_drop(e)},window.ondragover=function(e){e.preventDefault()},window.onresize=function(e){EVENTS.on_resize()},document.onmousedown=EVENTS.mouse_click,document.onmousemove=EVENTS.mouse_move,document.onmouseup=EVENTS.mouse_release,document.addEventListener("mousewheel",EVENTS.mouse_wheel_handler,!1),document.addEventListener("DOMMouseScroll",EVENTS.mouse_wheel_handler,!1),document.oncontextmenu=function(e){return EVENTS.mouse_right_click(e)},document.getElementById("color_hex").onkeyup=function(e){GUI.set_color_manual(e)},document.getElementById("color_hex").onpaste=function(e){GUI.set_color_manual(e)},document.addEventListener("MSPointerDown",EVENTS.mouse_click,!1),document.addEventListener("MSPointerMove",EVENTS.mouse_move,!1),document.addEventListener("MSPointerUp",EVENTS.mouse_release,!1),document.addEventListener("touchstart",EVENTS.mouse_click,!1),document.addEventListener("touchend",EVENTS.mouse_release,!1),document.addEventListener("touchmove",EVENTS.mouse_move,!1)},o.unbindAllEvents=function(){document.onkeydown=null,document.onkeyup=null,window.ondrop=null,window.ondragover=null,window.onresize=null,document.onmousedown=null,document.onmousemove=null,document.onmouseup=null,document.removeEventListener("mousewheel",EVENTS.mouse_wheel_handler,!1),document.removeEventListener("DOMMouseScroll",EVENTS.mouse_wheel_handler,!1),document.oncontextmenu=null,document.getElementById("color_hex").onkeyup=null,document.getElementById("color_hex").onpaste=null,document.removeEventListener("MSPointerDown",EVENTS.mouse_click,!1),document.removeEventListener("MSPointerMove",EVENTS.mouse_move,!1),document.removeEventListener("MSPointerUp",EVENTS.mouse_release,!1),document.removeEventListener("touchstart",EVENTS.mouse_click,!1),document.removeEventListener("touchend",EVENTS.mouse_release,!1),document.removeEventListener("touchmove",EVENTS.mouse_move,!1)}}function call_menu(e,a,t){var i=document.querySelector("#main_menu .selected");void 0!=i&&i.click(),GUI.last_menu=a,e[a](t),GUI.zoom()}function CLIPBOARD_CLASS(e,a){var t=this;if(""!=e)var i=document.getElementById(e),r=document.getElementById(e).getContext("2d");var s,n,o=!1,l=!1;this.init=function(){document.addEventListener("keydown",t.on_keyboard_action,!1),document.addEventListener("keyup",t.on_keyboardup_action,!1),document.addEventListener("paste",t.paste_auto,!1),s=document.createElement("div"),s.setAttribute("id","paste_ff"),s.setAttribute("contenteditable",""),s.style.cssText="opacity:0;position:fixed;top:0px;left:0px;",s.style.marginLeft="-20px",s.style.width="10px",document.body.appendChild(s);var e=new MutationObserver(function(e){e.forEach(function(e){return"auto"==n||0==o||"childList"!=e.type||void(1==e.addedNodes.length&&(void 0!=e.addedNodes[0].src&&t.paste_createImage(e.addedNodes[0].src),setTimeout(function(){s.innerHTML=""},20)))})}),a=document.getElementById("paste_ff"),i={
attributes:!0,childList:!0,characterData:!0};e.observe(a,i)},this.destroy=function(){document.removeEventListener("keydown",t.on_keyboard_action),document.removeEventListener("keyup",t.on_keyboardup_action),document.removeEventListener("paste",t.paste_auto)},this.paste_auto=function(e){n="",s.innerHTML="";if(e.clipboardData){var a=e.clipboardData.items;if(a){n="auto";for(var t=0;t<a.length;t++)if(a[t].type.indexOf("image")!==-1){var i=a[t].getAsFile(),r=window.URL||window.webkitURL,o=r.createObjectURL(i);this.paste_createImage(o)}e.preventDefault()}}},this.on_keyboard_action=function(e){if(1==POP.active)return!0;if(k=e.keyCode,(17==k||e.metaKey||e.ctrlKey)&&0==o&&(o=!0),86==k){if(void 0!=document.activeElement&&"text"==document.activeElement.type)return!1;1!=o||window.Clipboard||s.focus()}},this.on_keyboardup_action=function(e){0==e.ctrlKey&&1==o?o=!1:0==e.metaKey&&1==l&&(l=!1,o=!1)},this.paste_createImage=function(t){var s=new Image;s.onload=function(){""!=e&&(1==a?(i.width=s.width,i.height=s.height):r.clearRect(0,0,i.width,i.height)),LAYER.layer_add("Paste",t)},s.src=t}}function FILE_CLASS(){this.file_info={general:[],exif:[]},this.SAVE_NAME="example",this.SAVE_TYPES=["PNG - Portable Network Graphics","JPG - JPG/JPEG Format","JSON - Full layers data","BMP - Windows Bitmap","WEBP - Weppy File Format"],this.file_new=function(){var e=["Custom"];for(var a in GUI.common_dimensions)e.push(GUI.common_dimensions[a][0]+"x"+GUI.common_dimensions[a][1]);POP.add({name:"width",title:"Width:",value:WIDTH}),POP.add({name:"height",title:"Height:",value:HEIGHT}),POP.add({name:"transparency",title:"Transparent:",values:["Yes","No"]}),POP.add({name:"resolution",title:"Resolution:",values:e}),POP.show("New file...",function(e){var a=parseInt(e.width),t=parseInt(e.height),i=e.resolution;if("Custom"!=i){var r=i.split("x");a=r[0],t=r[1]}"Yes"==e.transparency?GUI.TRANSPARENCY=!0:GUI.TRANSPARENCY=!1,GUI.ZOOM=100,WIDTH=a,HEIGHT=t,MAIN.init()})},this.file_open=function(){this.open()},this.file_save=function(){this.save_dialog()},this.file_print=function(){window.print()},this.open=function(){var e=this;document.getElementById("tmp").innerHTML="";var a=document.createElement("input");a.setAttribute("id","file_open"),a.type="file",a.multiple="multiple ",document.getElementById("tmp").appendChild(a),document.getElementById("file_open").addEventListener("change",function(a){e.open_handler(a)},!1),document.querySelector("#file_open").click()},this.open_handler=function(e){var a=e.target.files,t=this;void 0==a&&(a=e.dataTransfer.files);for(var i,r=0;r<a.length;r++)if(i=a[r],i.type.match("image.*")||i.name.match(".json")){1==a.length&&(this.SAVE_NAME=i.name.split(".")[i.name.split(".").length-2]);var s=new FileReader;s.file=a[r],s.onload=function(e){if(this.file.type.match("image.*"))LAYER.layer_add(this.file.name,e.target.result,this.file.type),t.save_file_info(this.file);else{var a=t.load_json(e.target.result);if(a===!0)return!1}},"text/plain"==i.type?s.readAsText(i):i.name.match(".json")?s.readAsText(i):s.readAsDataURL(i)}else console.log("Wrong file type, must be image or json.")},this.save_dialog=function(e){var a=this.SAVE_TYPES[0];"jpg"==HELPER.getCookie("save_default")&&(a=this.SAVE_TYPES[1]),POP.add({name:"name",title:"File name:",value:this.SAVE_NAME}),POP.add({name:"type",title:"Save as type:",values:this.SAVE_TYPES,value:a}),POP.add({name:"quality",title:"Quality (jpeg):",value:90,range:[1,100]}),POP.add({name:"layers",title:"Save layers:",values:["All","Selected"]}),POP.add({name:"trim",title:"Trim:",values:["No","Yes"]}),POP.show("Save as",[FILE,"save"]),document.getElementById("pop_data_name").select(),void 0!=e&&e.preventDefault()},this.save=function(e){fname=e.name;var a=document.createElement("canvas"),t=a.getContext("2d"),i=!1;window.Blob&&window.navigator.msSaveOrOpenBlob&&window.FileReader&&(i=!0),a.width=WIDTH,a.height=HEIGHT;var r=this.SAVE_TYPES[0];"jpg"==HELPER.getCookie("save_default")&&(r=this.SAVE_TYPES[1]),e.type!=r&&e.type==this.SAVE_TYPES[0]?HELPER.setCookie("save_default","png",30):e.type!=r&&e.type==this.SAVE_TYPES[1]&&HELPER.setCookie("save_default","jpg",30);var s=e.type.split(" ");e.type=s[0],HELPER.strpos(fname,".png")!==!1?e.type="PNG":HELPER.strpos(fname,".jpg")!==!1?e.type="JPG":HELPER.strpos(fname,".json")!==!1?e.type="JSON":HELPER.strpos(fname,".bmp")!==!1?e.type="BMP":HELPER.strpos(fname,".webp")!==!1&&(e.type="WEBP"),0!=GUI.TRANSPARENCY&&"JPG"!=e.type||(t.beginPath(),t.rect(0,0,WIDTH,HEIGHT),t.fillStyle="#ffffff",t.fill());for(var n=LAYER.layers.length-1;n>=0;n--)0!=LAYER.layers[n].visible&&("Selected"==e.layers&&"JSON"!=e.type&&n!=LAYER.layer_active||t.drawImage(document.getElementById(LAYER.layers[n].name),0,0,WIDTH,HEIGHT));if("Yes"==e.trim&&"JSON"!=e.type){var o=IMAGE.trim_info(a);tmp_data=t.getImageData(0,0,WIDTH,HEIGHT),t.clearRect(0,0,WIDTH,HEIGHT),a.width=WIDTH-o.right-o.left,a.height=HEIGHT-o.bottom-o.top,t.putImageData(tmp_data,-o.left,-o.top)}if("PNG"==e.type)0==HELPER.strpos(fname,".png")&&(fname+=".png"),a.toBlob(function(e){saveAs(e,fname)});else if("JPG"==e.type){0==HELPER.strpos(fname,".jpg")&&(fname+=".jpg");var l=parseInt(e.quality);(l>100||l<1||1==isNaN(l))&&(l=90),l/=100,a.toBlob(function(e){saveAs(e,fname)},"image/jpeg",l)}else if("WEBP"==e.type){0==HELPER.strpos(fname,".webp")&&(fname+=".webp");var c="image/webp";if(0==this.check_format_support(a,c))return!1;a.toBlob(function(e){saveAs(e,fname)},c)}else if("BMP"==e.type){0==HELPER.strpos(fname,".webp")&&(fname+=".webp");var c="image/bmp";if(0==this.check_format_support(a,c))return!1;a.toBlob(function(e){saveAs(e,fname)},c)}else if("JSON"==e.type){0==HELPER.strpos(fname,".json")&&(fname+=".json");var d={};d.info={width:WIDTH,height:HEIGHT},d.layers=[];for(var n=LAYER.layers.length-1;n>=0;n--){var u={name:LAYER.layers[n].name,title:LAYER.layers[n].title,visible:1,opacity:LAYER.layers[n].opacity};0==LAYER.layers[n].visible&&(u.visible=0),d.layers.push(u)}d.image_data=[];for(var n=LAYER.layers.length-1;n>=0;n--){var h=document.getElementById(LAYER.layers[n].name).toDataURL("image/png");d.image_data.push({name:LAYER.layers[n].name,data:h})}var m=JSON.stringify(d,null,6);delete d;var v=new Blob([m],{type:"text/plain"});saveAs(v,fname)}},this.check_format_support=function(e,a){var t=e.toDataURL(a),i=t.replace(/^data:([^;]*).*/,"$1");return a!=i&&"text/plain"!=a?(POP.add({title:"Error:",value:"Your browser do not support this format."}),POP.show("Sorry",""),delete t,!1):(delete t,!0)},this.save_cleanup=function(e){e.textContent="Downloaded",setTimeout(function(){e.href="";var a=document.getElementById("save_data");a.parentNode.removeChild(a)},1500)},this.save_file_info=function(e){this.file_info={general:[],exif:[]},EXIF.getData(e,function(){FILE.file_info.exif=this.exifdata}),void 0!=e.name&&(FILE.file_info.general.Name=e.name),void 0!=e.size&&(FILE.file_info.general.Size=HELPER.number_format(e.size/1e3,2)+" KB"),void 0!=e.type&&(FILE.file_info.general.Type=e.type),void 0!=e.lastModifiedDate&&(FILE.file_info.general["Last modified"]=e.lastModifiedDate)},this.load_json=function(e){var a=JSON.parse(e);GUI.ZOOM=100,MAIN.init(),LAYER.remove_all_layers(),WIDTH=parseInt(a.info.width),HEIGHT=parseInt(a.info.height),LAYER.set_canvas_size();for(var t in a.layers){var i=a.layers[t],r=i.name.replace(/[^0-9a-zA-Z-_\. ]/g,""),s=i.title,n=parseInt(i.visible),o=parseInt(i.opacity);LAYER.layer_add(r),LAYER.layers[LAYER.layer_active].title=s,0==n&&LAYER.layer_visibility(LAYER.layer_active),LAYER.layers[LAYER.layer_active].opacity=o}LAYER.layer_renew();for(var t in a.image_data){var i=a.image_data[t],r=i.name.replace(/[^0-9a-zA-Z-_\. ]/g,""),e=i.data,l=new Image;l.onload=function(e,a){return function(){document.getElementById(e).getContext("2d").drawImage(a,0,0),LAYER.layer_renew(),GUI.zoom()}}(r,l),l.src=e}},this.open_from_url=function(e){var a=this,t=new FileReader,i=new Image;i.setAttribute("crossOrigin","anonymous"),i.src=e,i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var a=e.getContext("2d");a.drawImage(i,0,0),e.toBlob(function(e){t.file=e,t.readAsDataURL(e)})},t.onload=function(e){LAYER.layer_add("Layer #1",this.result,this.file.type),a.save_file_info(this.file)}}}function EDIT_CLASS(){var e=!1,a=0;this.edit_undo=function(){this.undo()},this.edit_cut=function(){this.save_state(),0!=DRAW.select_data&&(this.copy_to_clipboard(),canvas_active().clearRect(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h),DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT))},this.edit_copy=function(){0!=DRAW.select_data&&this.copy_to_clipboard()},this.edit_paste=function(){this.save_state(),this.paste("menu")},this.edit_select=function(){DRAW.select_data={x:0,y:0,w:WIDTH,h:HEIGHT},canvas_front.clearRect(0,0,WIDTH,HEIGHT),GUI.draw_selected_area()},this.edit_clear=function(){DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT),DRAW.select_square_action=""},this.copy_to_clipboard=function(){e=!1,e=document.createElement("canvas"),e.width=DRAW.select_data.w,e.height=DRAW.select_data.h,e.getContext("2d").drawImage(canvas_active(!0),DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h,0,0,DRAW.select_data.w,DRAW.select_data.h)},this.paste=function(a){if(0==e)return"menu"==a&&(POP.add({title:"Error:",value:"Empty data"}),POP.add({title:"Notice:",value:"To paste from clipboard, use Ctrl-V."}),POP.show("Notice","")),!1;tmp=new Array;var t="Layer #"+(LAYER.layers.length+1);LAYER.create_canvas(t),LAYER.layers.unshift({name:t,title:t,visible:!0}),LAYER.layer_active=0,canvas_active().drawImage(e,0,0),LAYER.layer_renew(),EDIT.edit_clear()},this.save_state=function(){a=0,j=0,layers_archive[2]=layers_archive[1],layers_archive[1]=layers_archive[0],layers_archive[j]={},layers_archive[j].width=WIDTH,layers_archive[j].height=HEIGHT,layers_archive[j].data={};for(var e in LAYER.layers)layers_archive[j].data[LAYER.layers[e].name]=document.createElement("canvas"),layers_archive[j].data[LAYER.layers[e].name].width=WIDTH,layers_archive[j].data[LAYER.layers[e].name].height=HEIGHT,layers_archive[j].data[LAYER.layers[e].name].getContext("2d").drawImage(document.getElementById(LAYER.layers[e].name),0,0);return!0},this.undo=function(){if(0==layers_archive.length)return!1;if(j=a,a++,void 0==layers_archive[j]||void 0==layers_archive[j].width)return!1;WIDTH==layers_archive[j].width&&HEIGHT==layers_archive[j].height||(WIDTH=layers_archive[j].width,HEIGHT=layers_archive[j].height,LAYER.set_canvas_size(!0));for(var e in LAYER.layers)void 0!=layers_archive[j].data[LAYER.layers[e].name]&&(document.getElementById(LAYER.layers[e].name).getContext("2d").clearRect(0,0,WIDTH,HEIGHT),document.getElementById(LAYER.layers[e].name).getContext("2d").drawImage(layers_archive[j].data[LAYER.layers[e].name],0,0));return GUI.zoom(),!0}}function IMAGE_CLASS(){this.image_information=function(){var e=this.unique_colors_count(canvas_active(!0));e=HELPER.number_format(e,0),POP.add({title:"Width:",value:WIDTH}),POP.add({title:"Height:",value:HEIGHT}),POP.add({title:"Unique colors:",value:e});for(var a in FILE.file_info.general)POP.add({title:a+":",value:FILE.file_info.general[a]});var t=0;for(var a in FILE.file_info.exif)"undefined"!=a&&(0==t&&POP.add({title:"==== EXIF ====",value:""}),POP.add({title:a+":",value:FILE.file_info.exif[a]}),t++);POP.show("Information","")},this.image_size=function(){POP.add({name:"width",title:"Width:",value:WIDTH,placeholder:WIDTH}),POP.add({name:"height",title:"Height:",value:HEIGHT,placeholder:HEIGHT}),POP.show("Attributes",[IMAGE,"resize_custom"])},this.image_trim=function(){EDIT.save_state(),this.trim()},this.image_crop=function(){if(EDIT.save_state(),0==DRAW.select_data)POP.add({html:"Select area first"}),POP.show("Error","");else{for(var e in LAYER.layers){var a=document.getElementById(LAYER.layers[e].name).getContext("2d"),t=a.getImageData(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h);a.clearRect(0,0,WIDTH,HEIGHT),a.putImageData(t,0,0)}EDIT.save_state(),WIDTH=DRAW.select_data.w,HEIGHT=DRAW.select_data.h,LAYER.set_canvas_size(),DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT)}},this.image_resize=function(){this.resize_box()},this.image_rotate_left=function(){EDIT.save_state(),this.rotate_resize_doc(270,WIDTH,HEIGHT),this.rotate_layer({angle:270},canvas_active(),WIDTH,HEIGHT)},this.image_rotate_right=function(){EDIT.save_state(),this.rotate_resize_doc(90,WIDTH,HEIGHT),this.rotate_layer({angle:90},canvas_active(),WIDTH,HEIGHT)},this.image_rotate=function(){POP.add({name:"angle",title:"Enter angle (0-360):",value:0,range:[0,360]}),POP.add({name:"mode",title:"Area:",values:["All","Visible"]}),POP.show("Rotate",function(e){EDIT.save_state(),"All"==e.mode&&IMAGE.rotate_resize_doc(e.angle,WIDTH,HEIGHT),IMAGE.rotate_layer(e,canvas_active(),WIDTH,HEIGHT)},function(e,a,t,i){IMAGE.rotate_layer(e,a,t,i)})},this.image_vflip=function(){EDIT.save_state();var e=document.createElement("canvas"),a=e.getContext("2d");e.width=WIDTH,e.height=HEIGHT,a.drawImage(canvas_active(!0),0,0,WIDTH,HEIGHT),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().save(),canvas_active().scale(-1,1),canvas_active().drawImage(e,-WIDTH,0),canvas_active().restore()},this.image_hflip=function(){EDIT.save_state();var e=document.createElement("canvas"),a=e.getContext("2d");e.width=WIDTH,e.height=HEIGHT,a.drawImage(canvas_active(!0),0,0,WIDTH,HEIGHT),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().save(),canvas_active().scale(1,-1),canvas_active().drawImage(e,0,-HEIGHT),canvas_active().restore()},this.image_colors=function(){POP.add({name:"param1",title:"Brightness:",value:"0",range:[-100,100]}),POP.add({name:"param2",title:"Contrast:",value:"0",range:[-100,100]}),POP.add({name:"param_red",title:"Red channel:",value:"0",range:[-255,255]}),POP.add({name:"param_green",title:"Green channel:",value:"0",range:[-255,255]}),POP.add({name:"param_blue",title:"Blue channel:",value:"0",range:[-255,255]}),POP.add({name:"param_h",title:"Hue:",value:"0",range:[-180,180]}),POP.add({name:"param_s",title:"Saturation:",value:"0",range:[-100,100]}),POP.add({name:"param_l",title:"Luminance:",value:"0",range:[-100,100]}),POP.show("Brightness Contrast",function(e){EDIT.save_state();var a=parseInt(e.param1),t=parseInt(e.param2),i=parseInt(e.param_red),r=parseInt(e.param_green),s=parseInt(e.param_blue),n=parseInt(e.param_h),o=parseInt(e.param_s),l=parseInt(e.param_l),c=canvas_active().getImageData(0,0,WIDTH,HEIGHT),d=ImageFilters.BrightnessContrastPhotoshop(c,a,t),d=ImageFilters.ColorTransformFilter(d,1,1,1,1,i,r,s,1),d=ImageFilters.HSLAdjustment(d,n,o,l);canvas_active().putImageData(d,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=parseInt(e.param2),n=parseInt(e.param_red),o=parseInt(e.param_green),l=parseInt(e.param_blue),c=parseInt(e.param_h),d=parseInt(e.param_s),u=parseInt(e.param_l),h=a.getImageData(0,0,t,i),m=ImageFilters.BrightnessContrastPhotoshop(h,r,s),m=ImageFilters.ColorTransformFilter(m,1,1,1,1,n,o,l,1),m=ImageFilters.HSLAdjustment(m,c,d,u);a.putImageData(m,0,0)})},this.image_auto_adjust=function(){EDIT.save_state(),this.auto_adjust(canvas_active(),WIDTH,HEIGHT)},this.image_GrayScale=function(){EDIT.save_state();var e=canvas_active().getImageData(0,0,WIDTH,HEIGHT),a=ImageFilters.GrayScale(e);canvas_active().putImageData(a,0,0)},this.image_decrease_colors=function(){POP.add({name:"param1",title:"Colors:",value:"10",range:[2,256]}),POP.add({name:"param2",title:"Dithering:",values:["No","Yes"]}),POP.add({name:"param3",title:"Greyscale:",values:["No","Yes"]}),POP.show("Decrease colors",function(e){EDIT.save_state();var a=parseInt(e.param1);"Yes"==e.param2?param2=!0:param2=!1,"Yes"==e.param3?param3=!0:param3=!1,IMAGE.decrease_colors(canvas_active(!0),canvas_active(!0),WIDTH,HEIGHT,a,param2,param3),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1);"Yes"==e.param2?param2=!0:param2=!1,"Yes"==e.param3?param3=!0:param3=!1,IMAGE.decrease_colors(canvas_active(!0),document.getElementById("pop_post"),t,i,r,param2,param3)})},this.image_negative=function(){if(EDIT.save_state(),0==DRAW.select_data)var e=canvas_active().getImageData(0,0,WIDTH,HEIGHT);else var e=canvas_active().getImageData(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h);for(var a=e.data,t=0;t<a.length;t+=4)a[t]=255-a[t],a[t+1]=255-a[t+1],a[t+2]=255-a[t+2];0==DRAW.select_data?canvas_active().putImageData(e,0,0):canvas_active().putImageData(e,DRAW.select_data.x,DRAW.select_data.y)},this.image_grid=function(){POP.add({name:"visible",title:"Visible:",value:"Yes",values:["Yes","No"]}),POP.add({name:"gap_x",title:"Horizontal gap:",value:GUI.grid_size[0]}),POP.add({name:"gap_y",title:"Vertical gap:",value:GUI.grid_size[1]}),POP.show("Grid",function(e){"Yes"==e.visible?(GUI.grid=!0,gap_x=e.gap_x,gap_y=e.gap_y,GUI.draw_grid(gap_x,gap_y)):(GUI.grid=!1,GUI.draw_grid())})},this.image_histogram=function(){this.histogram()},this.resize_custom=function(e){EDIT.save_state(),EVENTS.autosize=!1,e.width==WIDTH&&e.height==HEIGHT||(WIDTH=e.width,HEIGHT=e.height,LAYER.set_canvas_size())},this.rotate_resize_doc=function(e,a,t){var i=e*Math.PI/180,r=a*Math.abs(Math.cos(i))+t*Math.abs(Math.sin(i)),s=a*Math.abs(Math.sin(i))+t*Math.abs(Math.cos(i));if(r=Math.ceil(Math.round(1e3*r)/1e3),s=Math.ceil(Math.round(1e3*s)/1e3),WIDTH!=r||HEIGHT!=s){EDIT.save_state();var n=0,o=0;r>WIDTH&&(n=Math.ceil(r-WIDTH)/2,WIDTH=r),s>HEIGHT&&(o=Math.ceil(s-HEIGHT)/2,HEIGHT=s),LAYER.set_canvas_size();var l=canvas_active().getImageData(0,0,WIDTH,HEIGHT);canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().putImageData(l,n,o)}},this.rotate_layer=function(e,a,t,i){var r=Math.PI/180;angle=e.angle,mode=e.mode;var s=0,n=0,o=t,l=i,c=0,d=0;if("Visible"==mode){var u=this.trim_info(a.canvas);s=u.left,n=u.top,o=t-u.left-u.right,l=i-u.top-u.bottom;var h=angle*Math.PI/180,m=o*Math.abs(Math.cos(h))+l*Math.abs(Math.sin(h)),v=o*Math.abs(Math.sin(h))+l*Math.abs(Math.cos(h));if(m=Math.ceil(Math.round(1e3*m)/1e3),v=Math.ceil(Math.round(1e3*v)/1e3),(m>o||v>l)&&(m>o&&(c=Math.ceil(m-o)/2,s>c&&(c=0)),v>l&&(d=Math.ceil(v-l)/2,n>d&&(d=0)),t==WIDTH&&i==HEIGHT)){var g=a.getImageData(0,0,t,i);a.clearRect(0,0,t,i),a.putImageData(g,c,d)}var u=this.trim_info(a.canvas);s=u.left,n=u.top,o=t-u.left-u.right,l=i-u.top-u.bottom}var p=document.createElement("canvas"),_=p.getContext("2d");p.width=o,p.height=l;var f=a.getImageData(s,n,o,l);_.putImageData(f,0,0),a.clearRect(s,n,o,l),a.save(),a.translate(s+Math.round(o/2),n+Math.round(l/2)),a.rotate(angle*r),a.drawImage(p,-Math.round(o/2),-Math.round(l/2)),a.restore(),t==WIDTH&&i==HEIGHT&&GUI.zoom()},this.resize_box=function(){POP.add({name:"width",title:"Width (pixels):",value:"",placeholder:WIDTH}),POP.add({name:"height",title:"Height (pixels):",value:"",placeholder:HEIGHT}),POP.add({name:"width_percent",title:"Width (%):",value:"",placeholder:100}),POP.add({name:"height_percent",title:"Height (%):",value:"",placeholder:100}),POP.add({name:"mode",title:"Mode:",values:["Resample - Hermite","Basic","HQX"]}),POP.add({name:"preblur",title:"Pre-Blur:",values:["Yes","No"],value:"No"}),POP.add({name:"sharpen",title:"Sharpen:",values:["Yes","No"],value:"No"}),POP.show("Resize",[IMAGE,"resize_layer"])},this.resize_layer=function(e){EDIT.save_state();var a=parseInt(e.width),t=parseInt(e.height),i=parseInt(e.width_percent),r=parseInt(e.height_percent),s=e.preblur,n=e.sharpen;if(isNaN(a)&&isNaN(t)&&isNaN(i)&&isNaN(r))return!1;if(a==WIDTH&&t==HEIGHT)return!1;if(isNaN(a)&&isNaN(t)&&(0==isNaN(i)&&(a=Math.round(WIDTH*i/100)),0==isNaN(r)&&(t=Math.round(HEIGHT*r/100))),isNaN(a)||isNaN(t)){var o=WIDTH/HEIGHT;isNaN(a)&&(a=Math.round(t*o)),isNaN(t)&&(t=Math.round(a/o))}if("Yes"==s){var l=WIDTH/a,c=HEIGHT/t,d=Math.max(l,c),u=.3*d;if(u>.6){var h=canvas_active().getImageData(0,0,WIDTH,HEIGHT),m=ImageFilters.GaussianBlur(h,u);canvas_active().putImageData(m,0,0)}}"Resample - Hermite"==e.mode&&(a>WIDTH||t>HEIGHT)&&(e.mode="Resize"),"HQX"==e.mode&&a<WIDTH&&t<HEIGHT&&(e.mode="Resample - Hermite");var v;Date.now();if("Resample - Hermite"==e.mode)v="Hermite",this.resample_hermite(canvas_active(!0),WIDTH,HEIGHT,a,t),"layer_resize"!=GUI.last_menu&&(WIDTH=a,HEIGHT=t,WIDTH<1&&(WIDTH=1),HEIGHT<1&&(HEIGHT=1),LAYER.set_canvas_size()),GUI.zoom();else if("HQX"==e.mode){v="HQX";var g=Math.max(a/WIDTH,t/HEIGHT);g=Math.round(g),g<2&&(g=2),g>4&&(g=4);var p=hqx(canvas_active(!0),g);canvas_active().clearRect(0,0,WIDTH,HEIGHT),WIDTH*=g,HEIGHT*=g,LAYER.set_canvas_size(),canvas_active().putImageData(p,0,0),GUI.zoom()}else v="Default",tmp_data=document.createElement("canvas"),tmp_data.width=WIDTH,tmp_data.height=HEIGHT,tmp_data.getContext("2d").drawImage(canvas_active(!0),0,0),canvas_active().clearRect(0,0,WIDTH,HEIGHT),WIDTH=a,HEIGHT=t,LAYER.set_canvas_size(),canvas_active().drawImage(tmp_data,0,0,a,t),GUI.zoom();if("Yes"==n){var h=canvas_active().getImageData(0,0,WIDTH,HEIGHT),m=ImageFilters.Sharpen(h,1);canvas_active().putImageData(m,0,0)}},this.trim_info=function(e,a,t){var i=0,r=0,s=0,n=0,o=e.getContext("2d").getImageData(0,0,e.width,e.height),l=o.data;e:for(var c=0;c<o.height;c++){for(var d=0;d<o.width;d++){var u=c*(4*o.width)+4*d;if(0!=l[u+3]&&(t===!0||255!=l[u]||255!=l[u+1]||255!=l[u+2]))break e}i++}e:for(var d=0;d<o.width;d++){for(var c=0;c<o.height;c++){var u=c*(4*o.width)+4*d;if(0!=l[u+3]&&(t===!0||255!=l[u]||255!=l[u+1]||255!=l[u+2]))break e}r++}e:for(var c=o.height-1;c>=0;c--){for(var d=o.width-1;d>=0;d--){var u=c*(4*o.width)+4*d;if(0!=l[u+3]&&(t===!0||255!=l[u]||255!=l[u+1]||255!=l[u+2]))break e}s++}e:for(var d=o.width-1;d>=0;d--){for(var c=o.height-1;c>=0;c--){var u=c*(4*o.width)+4*d;if(0!=l[u+3]&&(t===!0||255!=l[u]||255!=l[u+1]||255!=l[u+2]))break e}n++}return{top:i,left:r,bottom:s,right:n}},this.trim=function(e,a,t){var i=HEIGHT,r=WIDTH,s=HEIGHT,n=WIDTH;for(var o in LAYER.layers)if(void 0==e||LAYER.layers[o].name==e){var l=0,c=0,d=0,u=0,h=document.getElementById(LAYER.layers[o].name).getContext("2d").getImageData(0,0,WIDTH,HEIGHT),m=h.data;e:for(var v=0;v<h.height;v++){for(var g=0;g<h.width;g++){var p=v*(4*h.width)+4*g;if(0!=m[p+3]&&(t===!0||255!=m[p]||255!=m[p+1]||255!=m[p+2]))break e}l++}e:for(var g=0;g<h.width;g++){for(var v=0;v<h.height;v++){var p=v*(4*h.width)+4*g;if(0!=m[p+3]&&(t===!0||255!=m[p]||255!=m[p+1]||255!=m[p+2]))break e}c++}e:for(var v=h.height-1;v>=0;v--){for(var g=h.width-1;g>=0;g--){var p=v*(4*h.width)+4*g;if(0!=m[p+3]&&(t===!0||255!=m[p]||255!=m[p+1]||255!=m[p+2]))break e}d++}e:for(var g=h.width-1;g>=0;g--){for(var v=h.height-1;v>=0;v--){var p=v*(4*h.width)+4*g;if(0!=m[p+3]&&(t===!0||255!=m[p]||255!=m[p+1]||255!=m[p+2]))break e}u++}i=Math.min(i,l),r=Math.min(r,c),s=Math.min(s,d),n=Math.min(n,u)}for(var o in LAYER.layers)if(void 0==e||LAYER.layers[o].name==e){tmp_data=document.getElementById(LAYER.layers[o].name).getContext("2d").getImageData(0,0,WIDTH,HEIGHT),document.getElementById(LAYER.layers[o].name).getContext("2d").clearRect(0,0,WIDTH,HEIGHT),document.getElementById(LAYER.layers[o].name).getContext("2d").putImageData(tmp_data,-r,-i);LAYER.layers[o].name}if(void 0!=a)return!1;if(void 0!=e){var _=Math.round(WIDTH-r-n),f=Math.round(HEIGHT-i-s),I=document.getElementById(e).getContext("2d").getImageData(0,0,_,f);return document.getElementById(e).width=_,document.getElementById(e).height=f,document.getElementById(e).getContext("2d").clearRect(0,0,_,f),document.getElementById(e).getContext("2d").putImageData(I,0,0),{top:i,left:r,bottom:s,right:n}}WIDTH=WIDTH-r-n,HEIGHT=HEIGHT-i-s,WIDTH<1&&(WIDTH=1),HEIGHT<1&&(HEIGHT=1),LAYER.set_canvas_size(),LAYER.update_info_block()},this.decrease_colors=function(e,a,t,i,r,s,n){var o=a.getContext("2d"),l=o.getImageData(0,0,t,i),c=l.data,d=[],u=10,h=canvas_front;h.clearRect(0,0,t,i),h.drawImage(e,0,0,Math.ceil(e.width/u),Math.ceil(e.height/u));var m=h.getImageData(0,0,Math.ceil(e.width/u),Math.ceil(e.height/u)),v=m.data;h.clearRect(0,0,t,i);for(var g=0;g<v.length;g+=4)if(0!=v[g+3]){var p=Math.round(.2126*v[g]+.7152*v[g+1]+.0722*v[g+2]);d.push([v[g],v[g+1],v[g+2],p])}for(var _=[],g=0;g<256;g++)_[g]=0;for(var g=0;g<d.length;g++)_[d[g][3]]++;for(var f=30;f<300&&!(d.length<=r);f+=30)for(var g=0;g<d.length&&!(d.length<=r);g++){for(var I=!0,y=0;y<d.length&&!(d.length<=r);y++)if(g!=y&&Math.abs(d[g][0]-d[y][0])+Math.abs(d[g][1]-d[y][1])+Math.abs(d[g][2]-d[y][2])<f){if(!(_[d[g][3]]>_[d[y][3]])){I=!1;break}d.splice(y,1),y--}0==I&&(d.splice(g,1),g--)}for(var b=d.length,y=0;y<i;y++)for(var g=0;g<t;g++){var E=y*(4*t)+4*g;if(0!=c[E+3]){for(var T,p=Math.round(.2126*v[E]+.7152*v[E+1]+.0722*v[E+2]),k=0,H=999999,P=0;P<b;P++){var w=Math.abs(d[P][0]-c[E])+Math.abs(d[P][1]-c[E+1])+Math.abs(d[P][2]-c[E+2]);w<H&&(H=w,k=P,T=w)}if(0==s)c[E]=d[k][0],c[E+1]=d[k][1],c[E+2]=d[k][2];else{if(T>=10)for(var D,x,S=768,P=0;P<b;P++)if(P!=k&&!(d[k][3]<p&&d[P][3]<p||d[k][3]>p&&d[P][3]>p)){var w=Math.abs(d[P][0]-c[E])+Math.abs(d[P][1]-c[E+1])+Math.abs(d[P][2]-c[E+2]);w<S&&(S=w,D=P,x=w)}var R;if(void 0==D)R=d[k];else{var z=HELPER.getRandomInt(-T,x);R=z<0?d[D]:d[k]}c[E]=R[0],c[E+1]=R[1],c[E+2]=R[2]}if(1==n){var A=Math.round(.2126*c[E]+.7152*c[E+1]+.0722*c[E+2]);c[E]=A,c[E+1]=A,c[E+2]=A}}}a.getContext("2d").putImageData(l,0,0)},this.auto_adjust=function(e,a,t){var i=240,r=30,s=1,n=.5,o=1.1,l=10;document.body.style.cursor="wait";for(var c=e.getImageData(0,0,a,t),d=c.data,u=0,h=0,m=0;m<d.length;m+=4)0!=d[m+3]&&((d[m]+d[m+1]+d[m+2])/3>i&&h++,u++);target=s;for(var v=0,g=!1,p=0;p<l&&(100*h/u>=target&&(g=!0),1!=g);p++){v++;for(var m=0;m<d.length;m+=4)if(0!=d[m+3])for(var _=0;_<3;_++){var f=m+_;d[f]<10||(d[f]*=o,d[f]=Math.round(d[f]),d[f]>255&&(d[f]=255))}h=0;for(var m=0;m<d.length;m+=4)0!=d[m+3]&&(d[m]+d[m+1]+d[m+2])/3>i&&h++}h=0;for(var m=0;m<d.length;m+=4)0!=d[m+3]&&(d[m]+d[m+1]+d[m+2])/3<r&&h++;target=n;for(var I=0,g=!1,p=0;p<l&&(100*h/u>=target&&(g=!0),1!=g);p++){I++;for(var m=0;m<d.length;m+=4)if(0!=d[m+3])for(var _=0;_<3;_++){var f=m+_;d[f]>240||(d[f]-=(255-d[f])*o-(255-d[f]),d[f]=Math.round(d[f]))}h=0;for(var m=0;m<d.length;m+=4)0!=d[m+3]&&(d[m]+d[m+1]+d[m+2])/3<r&&h++}e.putImageData(c,0,0),document.body.style.cursor="auto"},this.resample_hermite=function(e,a,t,i,r){for(var s=e.getContext("2d").getImageData(0,0,a,t),n=e.getContext("2d").getImageData(0,0,i,r),o=s.data,l=n.data,c=a/i,d=t/r,u=Math.ceil(c/2),h=Math.ceil(d/2),m=0;m<r;m++)for(var v=0;v<i;v++){for(var g=4*(v+m*i),p=0,_=0,f=0,I=gx_g=gx_b=gx_a=0,y=(m+.5)*d,b=Math.floor(m*d);b<(m+1)*d;b++)for(var E=Math.abs(y-(b+.5))/h,T=(v+.5)*c,k=E*E,H=Math.floor(v*c);H<(v+1)*c;H++){var P=Math.abs(T-(H+.5))/u,w=Math.sqrt(k+P*P);w>=-1&&w<=1&&(p=2*w*w*w-3*w*w+1,p>0&&(P=4*(H+b*a),gx_a+=p*o[P+3],f+=p,o[P+3]<255&&(p=p*o[P+3]/250),I+=p*o[P],gx_g+=p*o[P+1],gx_b+=p*o[P+2],_+=p))}l[g]=I/_,l[g+1]=gx_g/_,l[g+2]=gx_b/_,l[g+3]=gx_a/f}e.getContext("2d").clearRect(0,0,Math.max(a,i),Math.max(t,r)),e.getContext("2d").putImageData(n,0,0)},this.histogram=function(){POP.add({name:"param1",title:"Channel:",values:["Gray","Red","Green","Blue"],onchange:"IMAGE.histogram_onload()"}),POP.add({title:"Histogram:",function:function(){var e='<canvas style="position:relative;" id="c_h" width="256" height="100"></canvas>';return e}}),POP.add({title:"Total pixels:",value:""}),POP.add({title:"Average:",value:""}),POP.show("Histogram",void 0,void 0,this.histogram_onload)},this.histogram_onload=function(e){var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),t=a.data,i=document.getElementById("pop_data_param1_poptmp0"),r=document.getElementById("pop_data_param1_poptmp1"),s=document.getElementById("pop_data_param1_poptmp2"),n=document.getElementById("pop_data_param1_poptmp3");1==i.checked?channel=i.value:1==r.checked?channel=r.value:1==s.checked?channel=s.value:1==n.checked&&(channel=n.value);for(var o=[],l=0;l<=255;l++)o[l]=0;var c,d=t.length/4,u=0;if("Gray"==channel)for(var l=0;l<t.length;l+=4)c=Math.round((t[l]+t[l+1]+t[l+2])/3),o[c]++,u=u+t[l]+t[l+1]+t[l+2];else if("Red"==channel)for(var l=0;l<t.length;l+=4)o[t[l]]++,u+=3*t[l];else if("Green"==channel)for(var l=0;l<t.length;l+=4)o[t[l+1]]++,u+=3*t[l+1];else if("Blue"==channel)for(var l=0;l<t.length;l+=4)o[t[l+2]]++,u+=3*t[l+2];var h=document.getElementById("c_h").getContext("2d");h.rect(0,0,255,100),h.fillStyle="#ffffff",h.fill();for(var l=0;l<=255;l++)0!=o[l]&&(h.beginPath(),h.strokeStyle="#000000",h.lineWidth=1,h.moveTo(l+.5,100.5),h.lineTo(l+.5,100-Math.round(255*o[l]*100/d/6)+.5),h.stroke());document.getElementById("pop_data_totalpixel").innerHTML=HELPER.number_format(d,0),d>0?average=Math.round(10*u/d/3)/10:average="-",document.getElementById("pop_data_average").innerHTML=average},this.unique_colors_count=function(e){for(var a=e.getContext("2d").getImageData(0,0,e.width,e.height),t=a.data,i=[],r=0,s=0;s<t.length;s+=4)if(0!=t[s+3]){var n=t[s]+"."+t[s+1]+"."+t[s+2];void 0==i[n]&&(i[n]=1,r++)}return r},this.zoom_in=function(){GUI.zoom(1,!0)},this.zoom_out=function(){GUI.zoom(-1,!0)},this.zoom_original=function(){GUI.zoom(100,!0)},this.zoom_auto=function(e){var a=document.querySelector("#canvas_wrapper"),t=a.clientWidth,i=a.clientHeight,r=t/WIDTH*100,s=i/HEIGHT*100,n=Math.floor(Math.min(r,s));return!(void 0!=e&&n>100)&&void GUI.zoom(Math.min(r,s),!0)}}function LAYER_CLASS(){this.layer_active=0,this.layers=[];var e=0;this.layer_new=function(){this.layer_add()},this.remove_all_layers=function(){for(var a=LAYER.layers.length-1;a>=0;a--)LAYER.layer_remove(a,!0);e=0,this.layer_renew()},this.layer_add=function(a,t){e++;var i=!1,r=LAYER.layer_active;if(0!=DRAW.select_data&&void 0==t&&(i=document.createElement("canvas"),i.width=DRAW.select_data.w,i.height=DRAW.select_data.h,i.getContext("2d").drawImage(canvas_active(!0),DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h,0,0,DRAW.select_data.w,DRAW.select_data.h)),void 0==t){void 0==a&&(a="Layer #"+e);var s=[];s.name=a,s.title=a,s.visible=!0,s.opacity=1,LAYER.create_canvas(a),this.layers.unshift(s),0!=DRAW.select_data&&(canvas_active().drawImage(i,0,0),DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT),LAYER.layer_active=r)}else{var n=new Image;"http"==t.substring(0,4)&&(n.crossOrigin="Anonymous");var o=this;n.onload=function(){if((n.width>WIDTH||n.height>HEIGHT)&&(n.width>WIDTH&&(WIDTH=n.width),n.height>HEIGHT&&(HEIGHT=n.height),LAYER.set_canvas_size()),1==o.layers.length&&1==EVENTS.autosize){var t=IMAGE.trim_info(document.getElementById(o.layers[0].name));t.left==WIDTH&&(o.layer_remove(0,!0),WIDTH=n.width,HEIGHT=n.height,LAYER.set_canvas_size(!1))}for(var i in o.layers)o.layers[i].name==a&&(a="Layer #"+e);LAYER.create_canvas(a),o.layers.unshift({name:a,title:a,visible:!0,opacity:1}),LAYER.layer_active=0,document.getElementById(a).getContext("2d").globalAlpha=1,document.getElementById(a).getContext("2d").drawImage(n,0,0),LAYER.layer_renew(),IMAGE.zoom_auto(!0),GUI.redraw_preview()},n.onerror=function(e){POP.add({html:"<b>The image could not be loaded.<br /><br /></b>"}),"http"==t.substring(0,4)&&POP.add({title:"Reason:",value:"Cross-origin resource sharing (CORS) not supported. Try to save image first."}),POP.show("Error",".")},n.src=t}LAYER.layer_active=0,document.getElementById(this.layers[LAYER.layer_active].name).getContext("2d").globalAlpha=1,this.layer_renew()},this.layer_remove=function(e,a){return 1==this.layers.length&&void 0==a?(canvas_active().clearRect(0,0,WIDTH,HEIGHT),!1):(element=document.getElementById(this.layers[e].name),element.getContext("2d").clearRect(0,0,WIDTH,HEIGHT),element.parentNode.removeChild(element),this.layers.splice(e,1),LAYER.layer_active==e&&(LAYER.layer_active=Math.max(0,LAYER.layer_active-1)),this.layer_renew(),void GUI.redraw_preview())},this.layer_dublicate=function(){if(EDIT.save_state(),0!=DRAW.select_data)EDIT.copy_to_clipboard(),DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT),EDIT.paste("menu"),LAYER.layer_active=0,LAYER.layer_renew();else{e++,tmp_data=document.createElement("canvas"),tmp_data.width=WIDTH,tmp_data.height=HEIGHT,tmp_data.getContext("2d").drawImage(canvas_active(!0),0,0);var a="Layer #"+e;
LAYER.create_canvas(a),this.layers.unshift({name:a,title:a,visible:!0}),LAYER.layer_active=0,canvas_active().drawImage(tmp_data,0,0),LAYER.layer_renew()}},this.layer_show_hide=function(){LAYER.layer_visibility(LAYER.layer_active)},this.layer_crop=function(){if(EDIT.save_state(),0==DRAW.select_data)POP.add({html:"Select area first"}),POP.show("Error","");else{var e=LAYER.canvas_active(),a=e.getImageData(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h);e.clearRect(0,0,WIDTH,HEIGHT),e.putImageData(a,0,0),DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT)}},this.layer_delete=function(){EDIT.save_state(),LAYER.layer_remove(LAYER.layer_active)},this.layer_move_up=function(){EDIT.save_state(),LAYER.move_layer("up")},this.layer_move_down=function(){EDIT.save_state(),LAYER.move_layer("down")},this.layer_opacity=function(){LAYER.set_alpha()},this.layer_rename=function(){var e=this;POP.add({name:"param1",title:"Name:",value:this.layers[LAYER.layer_active].title}),POP.show("Rename layer",function(a){EDIT.save_state();var t=a.param1;e.layers[LAYER.layer_active].title=t,LAYER.layer_renew()})},this.layer_trim=function(){EDIT.save_state(),IMAGE.trim(this.layers[LAYER.layer_active].name,!0)},this.layer_resize=function(){IMAGE.resize_box()},this.layer_clear=function(){EDIT.save_state(),canvas_active().clearRect(0,0,WIDTH,HEIGHT)},this.layer_differences=function(){return parseInt(LAYER.layer_active)+1>=this.layers.length?(POP.add({html:"This can not be last layer"}),POP.show("Error",""),!1):(POP.add({name:"param1",title:"Sensitivity:",value:"0",range:[0,255]}),void POP.show("Differences",function(e){var a=parseInt(e.param1);LAYER.calc_differences(a)},function(e,a,t,i){var r=parseInt(e.param1);LAYER.calc_differences(r,a,t,i)}))},this.layer_merge_down=function(){var e=["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],a=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"];return LAYER.layer_active+1>=this.layers.length?(POP.add({html:"This can not be last layer."}),POP.show("Error",""),!1):(POP.add({name:"param1",title:"Composition:",values:e}),POP.add({name:"param2",title:"Blend:",values:a}),POP.add({name:"param3",title:"Mode:",values:["Composite","Blend"]}),void POP.show("Merge",function(e){var a=e.param1,t=e.param2,i=e.param3;EDIT.save_state();var r=document.createElement("canvas");r.width=WIDTH,r.height=HEIGHT,r.getContext("2d").drawImage(LAYER.canvas_active(!0),0,0),LAYER.canvas_active().save(),LAYER.canvas_active().clearRect(0,0,WIDTH,HEIGHT),LAYER.canvas_active().drawImage(document.getElementById(LAYER.layers[LAYER.layer_active+1].name),0,0),"Composite"==i?LAYER.canvas_active().globalCompositeOperation=a:LAYER.canvas_active().globalCompositeOperation=t,LAYER.canvas_active().drawImage(r,0,0),LAYER.canvas_active().restore(),LAYER.layer_remove(LAYER.layer_active+1),LAYER.layer_renew()},function(e,a,t,i){var r=e.param1,s=e.param2,n=e.param3;a.save(),a.clearRect(0,0,t,i),LAYER.layer_active++,a.drawImage(LAYER.canvas_active(!0),0,0,WIDTH,HEIGHT,0,0,t,i),LAYER.layer_active--,"Composite"==n?a.globalCompositeOperation=r:a.globalCompositeOperation=s,a.drawImage(LAYER.canvas_active(!0),0,0,WIDTH,HEIGHT,0,0,t,i),a.restore()}))},this.layer_flatten=function(){if(EDIT.save_state(),1==this.layers.length)return!1;LAYER.layer_active=0,tmp_data=document.createElement("canvas"),tmp_data.width=WIDTH,tmp_data.height=HEIGHT;for(var e=this.layers.length-2;e>=0;e--)LAYER.layer_active=e,tmp_data.getContext("2d").clearRect(0,0,WIDTH,HEIGHT),tmp_data.getContext("2d").drawImage(canvas_active(!0),0,0),LAYER.layer_active=this.layers.length-1,canvas_active().drawImage(tmp_data,0,0);for(var e=this.layers.length-2;e>=0;e--)LAYER.layer_active=e,LAYER.layer_remove(LAYER.layer_active);LAYER.layer_renew()},this.create_canvas=function(e){var a=document.createElement("canvas");a.setAttribute("id",e),document.getElementById("canvas_more").appendChild(a),a.width=WIDTH,a.height=HEIGHT,a.getContext("2d").mozImageSmoothingEnabled=!1,a.getContext("2d").webkitImageSmoothingEnabled=!1,a.getContext("2d").msImageSmoothingEnabled=!1,a.getContext("2d").imageSmoothingEnabled=!1,a.style.width=Math.round(WIDTH*GUI.ZOOM/100)+"px",a.style.height=Math.round(HEIGHT*GUI.ZOOM/100)+"px"},this.move_layer=function(e){if(this.layers.length<2)return!1;var a=this.layers[this.layer_active],t=document.getElementById("canvas_more"),i=document.getElementById(this.layers[this.layer_active].name);if("up"==e){if(0==this.layer_active)return!1;var r=this.layers[this.layer_active-1];1!=this.layer_active?t.insertBefore(i,document.getElementById(this.layers[this.layer_active-2].name)):t.insertBefore(i,null),this.layer_active--}else if("down"==e){if(this.layer_active==this.layers.length-1)return!1;t.insertBefore(i,document.getElementById(this.layers[this.layer_active+1].name)),this.layer_active++}var r=this.layers[this.layer_active];for(var s in r){var n=r[s];r[s]=a[s],a[s]=n}return this.layer_renew(),GUI.zoom(),!0},this.layer_visibility=function(e){1==this.layers[e].visible?(this.layers[e].visible=!1,document.getElementById(this.layers[e].name).style.visibility="hidden",document.getElementById("layer_"+e).src="img/yes-grey.png"):(this.layers[e].visible=!0,document.getElementById(this.layers[e].name).style.visibility="visible",document.getElementById("layer_"+e).src="img/yes.png"),this.layer_renew(),GUI.redraw_preview()},this.layer_move_active=function(e,a){var t=10;1==EVENTS.ctrl_pressed&&(t=50),1==EVENTS.shift_pressed&&(t=1),dx=e*t,dy=a*t;var i=canvas_active().getImageData(0,0,WIDTH,HEIGHT);canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().putImageData(i,dx,dy)},this.select_layer=function(e){LAYER.layer_active!=e&&(LAYER.layer_active=parseInt(e),this.layer_renew()),LAYER.shake(e)},this.layer_renew=function(){var e="";for(var a in this.layers){e+=LAYER.layer_active==a?'<div class="layer active">':'<div class="layer">';var t=this.layers[a].title;e+='<span class="layer_title" ondblclick="LAYER.layer_rename();" onclick="LAYER.select_layer(\''+a+"')\">"+HELPER.escapeHtml(t)+"</span>",e+='<a class="layer_visible" onclick="LAYER.layer_remove(\''+a+'\');return false;" title="delete" href="#"></a>',e+=1==this.layers[a].visible?'<a class="layer_delete" id="layer_'+a+'" onclick="LAYER.layer_visibility(\''+a+'\');return false;" title="hide" href="#"></a>':'<a class="layer_delete layer_unvisible" id="layer_'+a+'" onclick="LAYER.layer_visibility(\''+a+'\');return false;" title="show" href="#"></a>',e+="</div>",document.getElementById("layers").innerHTML=e}},this.shake=function(e,a){var t=3,i=10;void 0==a&&(a=0,canvas_front.drawImage(canvas_active(!0),0,0));var r=t*(a%2);0==r&&(r=-t);var s=document.getElementById("canvas_front");s.style.marginLeft=r+"px",a<i?setTimeout(function(){LAYER.shake(e,a+1)},15):(s.style.marginLeft="0px",canvas_front.clearRect(0,0,WIDTH,HEIGHT))},this.update_info_block=function(){document.getElementById("mouse_info_size").innerHTML=WIDTH+"x"+HEIGHT;var e=0,a=0;void 0!=EVENTS.mouse&&(e=EVENTS.mouse.x,a=EVENTS.mouse.y),document.getElementById("mouse_info_mouse").innerHTML=e+", "+a,0!=DRAW.select_data?(document.getElementById("mouse_info_xy").innerHTML=DRAW.select_data.x+", "+DRAW.select_data.y,document.getElementById("mouse_info_area").innerHTML=DRAW.select_data.w+", "+DRAW.select_data.h,document.getElementById("mouse_info_selected").style.display="block"):(document.getElementById("mouse_info_xy").innerHTML="",document.getElementById("mouse_info_area").innerHTML="",document.getElementById("mouse_info_selected").style.display="none")},this.set_canvas_size=function(e){var a=WIDTH/HEIGHT,t=Math.round(WIDTH),i=Math.round(t/a);this.resize_canvas("canvas_back"),GUI.draw_background(canvas_back,WIDTH,HEIGHT),this.resize_canvas("canvas_front",!1),this.resize_canvas("canvas_grid",!0);for(var r in this.layers)e===!1?this.resize_canvas(this.layers[r].name,!1):this.resize_canvas(this.layers[r].name,!0);GUI.draw_grid(),document.getElementById("resize-w").style.marginLeft=t+"px",document.getElementById("resize-w").style.marginTop=Math.round(i/2)+"px",document.getElementById("resize-h").style.marginLeft=Math.round(t/2)+"px",document.getElementById("resize-h").style.marginTop=i+"px",document.getElementById("resize-wh").style.marginLeft=t+"px",document.getElementById("resize-wh").style.marginTop=i+"px",this.update_info_block(),GUI.redraw_preview(),GUI.zoom()},this.resize_canvas=function(e,a){var t=WIDTH/HEIGHT,i=Math.round(WIDTH),r=Math.round(i/t),s=document.getElementById(e),n=s.getContext("2d");if(0==a)s.width=i,s.height=r;else{var o=document.createElement("canvas");o.width=WIDTH,o.height=HEIGHT,o.getContext("2d").drawImage(s,0,0),s.width=i,s.height=r,n.drawImage(o,0,0)}},this.set_alpha=function(){var e=this;void 0==this.layers[LAYER.layer_active].opacity&&(this.layers[LAYER.layer_active].opacity=1),POP.add({name:"param1",title:"Alpha:",value:this.layers[LAYER.layer_active].opacity,range:[0,1],step:.01}),POP.show("Opacity",function(a){var t=parseFloat(a.param1);e.layers[LAYER.layer_active].opacity=t,canvas_active().globalAlpha=t;var i=canvas_active().getImageData(0,0,WIDTH,HEIGHT),r=i.data,s=255*t;s<10&&(s=10),canvas_active().clearRect(0,0,WIDTH,HEIGHT);for(var n=0;n<i.height;n++)for(var o=0;o<i.width;o++){var l=n*(4*i.width)+4*o;r[l+3]>0&&(r[l+3]=s)}canvas_active().putImageData(i,0,0),GUI.zoom()})},this.canvas_active=function(e){return void 0==e?document.getElementById(LAYER.layers[LAYER.layer_active].name).getContext("2d"):document.getElementById(LAYER.layers[LAYER.layer_active].name)},this.calc_differences=function(e,a,t,i){vlayer_active=parseInt(LAYER.layer_active);var r=canvas_active().getImageData(0,0,WIDTH,HEIGHT),s=r.data,n=document.getElementById(this.layers[vlayer_active+1].name).getContext("2d"),o=n.getImageData(0,0,WIDTH,HEIGHT),l=o.data;if(void 0==a){LAYER.layer_add(),canvas_active().rect(0,0,WIDTH,HEIGHT),canvas_active().fillStyle="#ffffff",canvas_active().fill();var c=canvas_active().getImageData(0,0,WIDTH,HEIGHT)}else{var d=document.createElement("canvas");d.width=WIDTH,d.height=HEIGHT;var c=d.getContext("2d").getImageData(0,0,WIDTH,HEIGHT)}for(var u=c.data,h=0;h<WIDTH;h++)for(var m=0;m<HEIGHT;m++){var v=4*(h+m*WIDTH);(Math.abs(s[v]-l[v])>e||Math.abs(s[v+1]-l[v+1])>e||Math.abs(s[v+2]-l[v+2])>e||Math.abs(s[v+3]-l[v+3])>e)&&(u[v]=255,u[v+1]=0,u[v+2]=0,u[v+3]=255)}void 0==a?canvas_active().putImageData(c,0,0):(d.getContext("2d").rect(0,0,WIDTH,HEIGHT),d.getContext("2d").fillStyle="#ffffff",d.getContext("2d").fill(),d.getContext("2d").putImageData(c,0,0),a.clearRect(0,0,t,i),a.save(),a.scale(t/WIDTH,i/HEIGHT),a.drawImage(d,0,0),a.restore())};var a=this;a.reset_layers=function(){LAYER.remove_all_layers(),LAYER.layers=[],LAYER.layer_add(),LAYER.set_canvas_size()}}function canvas_active(e){return LAYER.canvas_active(e)}function EFFECTS_CLASS(){this.FILTERS_LIST=[{title:"Black and White",name:"effects_bw"},{title:"Blur-Box",name:"effects_BoxBlur"},{title:"Blur-Gaussian",name:"effects_GaussianBlur"},{title:"Blur-Stack",name:"effects_StackBlur"},{title:"Blur-Zoom",name:"effects_zoomblur"},{title:"Bulge/Pinch",name:"effects_bulge_pinch"},{title:"Colorize",name:"effects_colorize"},{title:"Denoise",name:"effects_denoise"},{title:"Desaturate",name:"effects_Desaturate"},{title:"Dither",name:"effects_Dither"},{title:"Dot Screen",name:"effects_dot_screen"},{title:"Edge",name:"effects_Edge"},{title:"Emboss",name:"effects_Emboss"},{title:"Enrich",name:"effects_Enrich"},{title:"Gamma",name:"effects_Gamma"},{title:"Grains",name:"effects_Grains"},{title:"Heatmap",name:"effects_heatmap"},{title:"HSL Adjustment",name:"effects_HSLAdjustment"},{title:"JPG Compression",name:"effects_jpg_vintage"},{title:"Mosaic",name:"effects_Mosaic"},{title:"Oil",name:"effects_Oil"},{title:"Posterize",name:"effects_Posterize"},{title:"Sepia",name:"effects_Sepia"},{title:"Sharpen",name:"effects_Sharpen"},{title:"Solarize",name:"effects_Solarize"},{title:"Tilt Shift",name:"effects_tilt_shift"},{title:"Vignette",name:"effects_vignette"},{title:"Vintage",name:"effects_vintage"}];var e=!1;this.load_fx=function(){0==e&&(e=fx.canvas())},this.effects_bw=function(){var e=this.thresholding("otsu",canvas_active(),WIDTH,HEIGHT,!0);POP.add({name:"param1",title:"Level:",value:e,range:[0,255]}),POP.add({name:"param2",title:"Dithering:",values:["No","Yes"],onchange:"EFFECTS.effects_bw_onchange()"}),POP.effects=!0,POP.show("Black and White",function(e){EDIT.save_state();var a=parseInt(e.param1),t=!1;"Yes"==e.param2&&(t=!0),EFFECTS.effect_bw(canvas_active(),WIDTH,HEIGHT,a,t),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=!1;"Yes"==e.param2&&(s=!0),EFFECTS.effect_bw(a,t,i,r,s)})},this.effects_bw_onchange=function(){var e=document.getElementById("pop_data_param1"),a=document.getElementById("pop_data_param2_poptmp0"),t=document.getElementById("pop_data_param2_poptmp1");1==a.checked?e.disabled=!1:1==t.checked&&(e.disabled=!0),POP.view()},this.effects_BoxBlur=function(){POP.add({name:"param1",title:"H Radius:",value:"3",range:[1,20]}),POP.add({name:"param2",title:"V Radius:",value:"3",range:[1,20]}),POP.add({name:"param3",title:"Quality:",value:"2",range:[1,10]}),POP.effects=!0,POP.show("Blur-Box",function(e){EDIT.save_state();var a=parseInt(e.param1),t=parseInt(e.param2),i=parseInt(e.param3),r=canvas_active().getImageData(0,0,WIDTH,HEIGHT),s=ImageFilters.BoxBlur(r,a,t,i);canvas_active().putImageData(s,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=parseInt(e.param2),n=parseInt(e.param3),o=a.getImageData(0,0,t,i),l=ImageFilters.BoxBlur(o,r,s,n);a.putImageData(l,0,0)})},this.effects_GaussianBlur=function(){POP.add({name:"param1",title:"Strength:",value:"2",range:[1,4],step:.1}),POP.effects=!0,POP.show("Blur-Gaussian",function(e){EDIT.save_state();var a=parseFloat(e.param1),t=canvas_active().getImageData(0,0,WIDTH,HEIGHT),i=ImageFilters.GaussianBlur(t,a);canvas_active().putImageData(i,0,0),GUI.zoom()},function(e,a,t,i){var r=parseFloat(e.param1),s=a.getImageData(0,0,t,i),n=ImageFilters.GaussianBlur(s,r);a.putImageData(n,0,0)})},this.effects_StackBlur=function(){POP.add({name:"param1",title:"Radius:",value:"6",range:[1,40]}),POP.effects=!0,POP.show("Blur-Stack",function(e){EDIT.save_state();var a=parseInt(e.param1),t=canvas_active().getImageData(0,0,WIDTH,HEIGHT),i=ImageFilters.StackBlur(t,a);canvas_active().putImageData(i,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=a.getImageData(0,0,t,i),n=ImageFilters.StackBlur(s,r);a.putImageData(n,0,0)})},this.effects_zoomblur=function(){this.load_fx(),POP.add({name:"param1",title:"Strength:",value:"0.3",range:[0,1],step:.01}),POP.add({name:"param2",title:"Center x:",value:Math.round(WIDTH/2),range:[0,WIDTH]}),POP.add({name:"param3",title:"Center y:",value:Math.round(HEIGHT/2),range:[0,HEIGHT]}),POP.effects=!0,POP.show("Blur-Zoom",function(a){EDIT.save_state();var t=parseFloat(a.param1),i=parseInt(a.param2),r=parseInt(a.param3),s=e.texture(canvas_active(!0));e.draw(s).zoomBlur(i,r,t).update(),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(e,0,0),GUI.zoom()},function(a,t,i,r){var s=parseFloat(a.param1),n=parseInt(a.param2),o=parseInt(a.param3);n=n/WIDTH*i,o=o/HEIGHT*r;var l=e.texture(t.getImageData(0,0,i,r));e.draw(l).zoomBlur(n,o,s).update(),t.drawImage(e,0,0),t.beginPath(),t.strokeStyle="#ff0000",t.lineWidth=1,t.beginPath(),t.arc(n,o,5,0,2*Math.PI,!0),t.stroke()})},this.effects_bulge_pinch=function(){this.load_fx(),POP.add({name:"param1",title:"Strength:",value:1,range:[-1,1],step:.1});var a=Math.min(WIDTH,HEIGHT);a=Math.round(a/2),POP.add({name:"param2",title:"Radius:",value:a,range:[0,600]}),POP.effects=!0,POP.show("Bulge/Pinch",function(a){EDIT.save_state();var t=parseFloat(a.param1),i=parseInt(a.param2),r=e.texture(canvas_active(!0));e.draw(r).bulgePinch(Math.round(WIDTH/2),Math.round(HEIGHT/2),i,t).update(),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(e,0,0),GUI.zoom()},function(a,t,i,r){var s=parseFloat(a.param1),n=parseInt(a.param2);n=n/Math.min(WIDTH,HEIGHT)*Math.min(i,r);var o=e.texture(t.getImageData(0,0,i,r));e.draw(o).bulgePinch(Math.round(i/2),Math.round(r/2),n,s).update(),t.drawImage(e,0,0)})},this.effects_colorize=function(){var e,a=this;POP.add({name:"param1",title:"Power:",value:"3",range:[1,10]}),POP.add({name:"param2",title:"Limit:",value:"30",range:[10,200]}),POP.add({name:"param3",title:"Dithering:",values:["Yes","No"]}),POP.preview_in_main=!0,POP.effects=!0,POP.show("Auto colorize",function(t){EDIT.save_state();var i=parseInt(t.param1),r=parseInt(t.param2);"Yes"==t.param3?param3=!0:param3=!1,a.colorize(canvas_active(),WIDTH,HEIGHT,i,r,param3,e),GUI.zoom(),canvas_front.clearRect(0,0,WIDTH,HEIGHT)},function(t){POP.preview_in_main=!0;var i=parseInt(t.param1),r=parseInt(t.param2);"Yes"==t.param3?param3=!0:param3=!1,e=a.colorize(!1,WIDTH,HEIGHT,i,r,param3,!0),canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.drawImage(canvas_active(!0),0,0),a.colorize(canvas_front,WIDTH,HEIGHT,i,r,param3,e)})},this.effects_denoise=function(){this.load_fx(),POP.add({name:"param1",title:"Exponent:",value:"20",range:[0,50]}),POP.effects=!0,POP.show("Denoise",function(a){EDIT.save_state();var t=parseFloat(a.param1),i=e.texture(canvas_active(!0));e.draw(i).denoise(t).update(),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(e,0,0),GUI.zoom()},function(a,t,i,r){var s=parseFloat(a.param1),n=e.texture(t.getImageData(0,0,i,r));e.draw(n).denoise(s).update(),t.drawImage(e,0,0)})},this.effects_Desaturate=function(){POP.effects=!0,POP.show("Desaturate",function(e){EDIT.save_state();var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),t=ImageFilters.Desaturate(a);canvas_active().putImageData(t,0,0),GUI.zoom()},function(e,a,t,i){var r=a.getImageData(0,0,t,i),s=ImageFilters.Desaturate(r);a.putImageData(s,0,0)})},this.effects_Dither=function(){POP.add({name:"param1",title:"Levels:",value:"8",range:[2,32]}),POP.effects=!0,POP.show("Dither",function(e){EDIT.save_state();var a=parseInt(e.param1),t=canvas_active().getImageData(0,0,WIDTH,HEIGHT),i=ImageFilters.Dither(t,a);canvas_active().putImageData(i,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=a.getImageData(0,0,t,i),n=ImageFilters.Dither(s,r);a.putImageData(n,0,0)})},this.effects_dot_screen=function(){this.load_fx(),POP.add({name:"param2",title:"Size:",value:"3",range:[1,20]}),POP.effects=!0,POP.show("Dot Screen",function(a){EDIT.save_state();var t=parseInt(a.param2),i=e.texture(canvas_active(!0));e.draw(i).dotScreen(Math.round(WIDTH/2),Math.round(HEIGHT/2),0,t).update(),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(e,0,0),GUI.zoom()},function(a,t,i,r){var s=parseInt(a.param2),n=e.texture(t.getImageData(0,0,i,r));e.draw(n).dotScreen(Math.round(i/2),Math.round(r/2),0,s).update(),t.drawImage(e,0,0)})},this.effects_Edge=function(){POP.effects=!0,POP.show("Edge",function(e){EDIT.save_state();var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),t=ImageFilters.Edge(a);canvas_active().putImageData(t,0,0),GUI.zoom()},function(e,a,t,i){var r=a.getImageData(0,0,t,i),s=ImageFilters.Edge(r);a.putImageData(s,0,0)})},this.effects_Emboss=function(){POP.effects=!0,POP.show("Emboss",function(e){EDIT.save_state();var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),t=ImageFilters.Emboss(a);canvas_active().putImageData(t,0,0),GUI.zoom()},function(e,a,t,i){var r=a.getImageData(0,0,t,i),s=ImageFilters.Emboss(r);a.putImageData(s,0,0)})},this.effects_Enrich=function(){POP.effects=!0,POP.show("Enrich",function(e){EDIT.save_state();var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),t=ImageFilters.Enrich(a);canvas_active().putImageData(t,0,0),GUI.zoom()},function(e,a,t,i){var r=a.getImageData(0,0,t,i),s=ImageFilters.Enrich(r);a.putImageData(s,0,0)})},this.effects_Gamma=function(){POP.add({name:"param1",title:"Gamma:",value:"1",range:[0,3],step:.1}),POP.effects=!0,POP.show("Gamma",function(e){EDIT.save_state();var a=parseFloat(e.param1),t=canvas_active().getImageData(0,0,WIDTH,HEIGHT),i=ImageFilters.Gamma(t,a);canvas_active().putImageData(i,0,0),GUI.zoom()},function(e,a,t,i){var r=parseFloat(e.param1),s=a.getImageData(0,0,t,i),n=ImageFilters.Gamma(s,r);a.putImageData(n,0,0)})},this.effects_Grains=function(){var e=this;POP.effects=!0,POP.add({name:"param1",title:"Level:",value:"30",range:[0,50]}),POP.show("Grains",function(a){var t=parseInt(a.param1);EDIT.save_state(),e.grains_effect(canvas_active(),WIDTH,HEIGHT,t)},function(a,t,i,r){var s=parseInt(a.param1);e.grains_effect(t,i,r,s)})},this.effects_heatmap=function(){var e=this;POP.effects=!0,POP.show("Heatmap",function(a){EDIT.save_state(),e.heatmap_effect(canvas_active(),WIDTH,HEIGHT)},function(a,t,i,r){e.heatmap_effect(t,i,r)})},this.effects_HSLAdjustment=function(){POP.add({name:"param1",title:"Hue:",value:"0",range:[-180,180]}),POP.add({name:"param2",title:"Saturation:",value:"0",range:[-100,100]}),POP.add({name:"param3",title:"Luminance:",value:"0",range:[-100,100]}),POP.effects=!0,POP.show("HSL Adjustment",function(e){EDIT.save_state();var a=parseInt(e.param1),t=parseInt(e.param2),i=parseInt(e.param3),r=canvas_active().getImageData(0,0,WIDTH,HEIGHT),s=ImageFilters.HSLAdjustment(r,a,t,i);canvas_active().putImageData(s,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=parseInt(e.param2),n=parseInt(e.param3),o=a.getImageData(0,0,t,i),l=ImageFilters.HSLAdjustment(o,r,s,n);a.putImageData(l,0,0)})},this.effects_jpg_vintage=function(){POP.add({name:"param1",title:"Quality:",value:80,range:[1,100]}),POP.effects=!0,POP.show("JPG Compression",function(e){EDIT.save_state();var a=parseInt(e.param1);(a>100||a<1||1==isNaN(a))&&(a=80),a/=100;var t=canvas_active(!0).toDataURL("image/jpeg",a),i=new Image;i.onload=function(){canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(i,0,0)},i.src=t,GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1);(r>100||r<1||1==isNaN(r))&&(r=80),r/=100;var s=document.getElementById("pop_post"),n=s.toDataURL("image/jpeg",r),o=new Image;o.onload=function(){a.clearRect(0,0,t,i),a.drawImage(o,0,0)},o.src=n})},this.effects_Mosaic=function(){POP.add({name:"param1",title:"Size:",value:"10",range:[1,100]}),POP.effects=!0,POP.show("Mosaic",function(e){EDIT.save_state();var a=parseInt(e.param1),t=canvas_active().getImageData(0,0,WIDTH,HEIGHT),i=ImageFilters.Mosaic(t,a);canvas_active().putImageData(i,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=a.getImageData(0,0,t,i),n=ImageFilters.Mosaic(s,r);a.putImageData(n,0,0)})},this.effects_Oil=function(){POP.add({name:"param1",title:"Range:",value:"2",range:[1,5]}),POP.add({name:"param2",title:"Levels:",value:"32",range:[1,256]}),POP.effects=!0,POP.show("Oil",function(e){EDIT.save_state();var a=parseInt(e.param1),t=parseInt(e.param2),i=canvas_active().getImageData(0,0,WIDTH,HEIGHT),r=ImageFilters.Oil(i,a,t);canvas_active().putImageData(r,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=parseInt(e.param2),n=a.getImageData(0,0,t,i),o=ImageFilters.Oil(n,r,s);a.putImageData(o,0,0)})},this.effects_perspective=function(){function a(e,a){canvas_front.beginPath(),canvas_front.rect(e-round(EVENTS.sr_size/2),a-round(EVENTS.sr_size/2),EVENTS.sr_size,EVENTS.sr_size),canvas_front.fillStyle="#0000c8",canvas_front.fill()}this.load_fx(),POP.add({name:"param1",title:"X1:",value:WIDTH/4,range:[0,WIDTH]}),POP.add({name:"param2",title:"Y1:",value:HEIGHT/4,range:[0,HEIGHT]}),POP.add({name:"param3",title:"X2:",value:3*WIDTH/4,range:[0,WIDTH]}),POP.add({name:"param4",title:"Y2:",value:HEIGHT/4,range:[0,HEIGHT]}),POP.add({name:"param5",title:"X3:",value:3*WIDTH/4,range:[0,WIDTH]}),POP.add({name:"param6",title:"Y3:",value:3*HEIGHT/4,range:[0,HEIGHT]}),POP.add({name:"param7",title:"X4:",value:WIDTH/4,range:[0,WIDTH]}),POP.add({name:"param8",title:"Y4:",value:3*HEIGHT/4,range:[0,HEIGHT]}),POP.preview_in_main=!0,POP.effects=!0,POP.show("Perspective",function(a){EDIT.save_state();var t=parseInt(a.param1),i=parseInt(a.param2),r=parseInt(a.param3),s=parseInt(a.param4),n=parseInt(a.param5),o=parseInt(a.param6),l=parseInt(a.param7),c=parseInt(a.param8),d=e.texture(canvas_active(!0));e.draw(d).perspective([WIDTH/4,HEIGHT/4,3*WIDTH/4,HEIGHT/4,3*WIDTH/4,3*HEIGHT/4,WIDTH/4,3*HEIGHT/4],[t,i,r,s,n,o,l,c]).update(),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(e,0,0),GUI.zoom()},function(t){var i=parseInt(t.param1),r=parseInt(t.param2),s=parseInt(t.param3),n=parseInt(t.param4),o=parseInt(t.param5),l=parseInt(t.param6),c=parseInt(t.param7),d=parseInt(t.param8);canvas_front.rect(0,0,WIDTH,HEIGHT),canvas_front.fillStyle="#ffffff",canvas_front.fill();var u=e.texture(canvas_active(!0));e.draw(u).perspective([WIDTH/4,HEIGHT/4,3*WIDTH/4,HEIGHT/4,3*WIDTH/4,3*HEIGHT/4,WIDTH/4,3*HEIGHT/4],[i,r,s,n,o,l,c,d]).update(),canvas_front.drawImage(e,0,0),a(i,r),a(s,n),a(o,l),a(c,d)})},this.effects_Posterize=function(){POP.add({name:"param1",title:"Levels:",value:"8",range:[2,32]}),POP.effects=!0,POP.show("Posterize",function(e){EDIT.save_state();var a=parseInt(e.param1),t=canvas_active().getImageData(0,0,WIDTH,HEIGHT),i=ImageFilters.Posterize(t,a);canvas_active().putImageData(i,0,0),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=a.getImageData(0,0,t,i),n=ImageFilters.Posterize(s,r);a.putImageData(n,0,0)})},this.effects_Sepia=function(){POP.effects=!0,POP.show("Sepia",function(e){EDIT.save_state();var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),t=ImageFilters.Sepia(a);canvas_active().putImageData(t,0,0)},function(e,a,t,i){var r=a.getImageData(0,0,t,i),s=ImageFilters.Sepia(r);a.putImageData(s,0,0)})},this.effects_Sharpen=function(){POP.add({name:"param1",title:"Factor:",value:"3",range:[1,10],step:.1}),POP.effects=!0,POP.show("Sharpen",function(e){EDIT.save_state();var a=parseFloat(e.param1),t=canvas_active().getImageData(0,0,WIDTH,HEIGHT),i=ImageFilters.Sharpen(t,a);canvas_active().putImageData(i,0,0),GUI.zoom()},function(e,a,t,i){var r=parseFloat(e.param1),s=a.getImageData(0,0,t,i),n=ImageFilters.Sharpen(s,r);a.putImageData(n,0,0)})},this.effects_Solarize=function(){POP.effects=!0,POP.show("Solarize",function(e){EDIT.save_state();var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),t=ImageFilters.Solarize(a);canvas_active().putImageData(t,0,0)},function(e,a,t,i){var r=a.getImageData(0,0,t,i),s=ImageFilters.Solarize(r);a.putImageData(s,0,0)})},this.effects_tilt_shift=function(){this.load_fx(),POP.add({name:"param7",title:"Saturation:",value:"3",range:[0,100]}),POP.add({name:"param8",title:"Sharpen:",value:"1",range:[1,10]}),POP.add({name:"param1",title:"Blur Radius:",value:"15",range:[0,50]}),POP.add({name:"param2",title:"Gradient Radius:",value:"200",range:[0,400]}),POP.add({name:"param3",title:"X start:",value:"0",range:[0,WIDTH]}),POP.add({name:"param4",title:"Y start:",value:Math.round(HEIGHT/2),range:[0,HEIGHT]}),POP.add({name:"param5",title:"X end:",value:WIDTH,range:[0,WIDTH]}),POP.add({name:"param6",title:"Y end:",value:Math.round(HEIGHT/2),range:[0,HEIGHT]}),POP.effects=!0,POP.show("Tilt Shift",function(a){EDIT.save_state();var t=parseInt(a.param1),i=parseInt(a.param2),r=parseInt(a.param3),s=parseInt(a.param4),n=parseInt(a.param5),o=parseInt(a.param6),l=parseInt(a.param7),c=parseInt(a.param8),d=e.texture(canvas_active(!0));e.draw(d).tiltShift(r,s,n,o,t,i).update(),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(e,0,0);var u=canvas_active().getImageData(0,0,WIDTH,HEIGHT),h=ImageFilters.HSLAdjustment(u,0,l,0);canvas_active().putImageData(h,0,0);var u=canvas_active().getImageData(0,0,WIDTH,HEIGHT),h=ImageFilters.Sharpen(u,c);canvas_active().putImageData(h,0,0),GUI.zoom()},function(a,t,i,r){var s=parseInt(a.param1),n=parseInt(a.param2),o=parseInt(a.param3),l=parseInt(a.param4),c=parseInt(a.param5),d=parseInt(a.param6),u=parseInt(a.param7),h=parseInt(a.param8),o=o/WIDTH*i,l=l/HEIGHT*r,c=c/WIDTH*i,d=d/HEIGHT*r,m=e.texture(t.getImageData(0,0,i,r));e.draw(m).tiltShift(o,l,c,d,s,n).update(),t.drawImage(e,0,0);var v=t.getImageData(0,0,i,r),g=ImageFilters.HSLAdjustment(v,0,u,0);t.putImageData(g,0,0);var v=t.getImageData(0,0,i,r),g=ImageFilters.Sharpen(v,h);t.putImageData(g,0,0),t.beginPath(),t.strokeStyle="#ff0000",t.lineWidth=1,t.moveTo(o+.5,l+.5),t.lineTo(c+.5,d+.5),t.stroke()})},this.effects_vignette=function(){this.load_fx(),POP.add({name:"param1",title:"Size:",value:"0.5",range:[0,1],step:.01}),POP.add({name:"param2",title:"Amount:",value:"0.5",range:[0,1],step:.01}),POP.effects=!0,POP.show("Vignette",function(a){EDIT.save_state();var t=parseFloat(a.param1),i=parseFloat(a.param2),r=e.texture(canvas_active(!0));e.draw(r).vignette(t,i).update(),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().drawImage(e,0,0),GUI.zoom()},function(a,t,i,r){var s=parseFloat(a.param1),n=parseFloat(a.param2),o=e.texture(t.getImageData(0,0,i,r));e.draw(o).vignette(s,n).update(),t.drawImage(e,0,0)})},this.effects_vintage=function(){POP.add({name:"red_offset",title:"Color adjust:",value:"70",range:[0,200]}),POP.add({name:"contrast",title:"Contrast:",value:"15",range:[0,50]}),POP.add({name:"blur",title:"Blur:",value:"0",range:[0,2],step:.1}),POP.add({name:"light_leak",title:"Light leak:",value:"90",range:[0,150]}),POP.add({name:"de_saturation",title:"Desaturation:",value:"40",range:[0,100]}),POP.add({name:"exposure",title:"Exposure level:",value:"80",range:[0,150]}),POP.add({name:"grains",title:"Grains level:",value:"20",range:[0,50]}),POP.add({name:"big_grains",title:"Big grains level:",value:"20",range:[0,50]}),POP.add({name:"vignette1",title:"Vignette size:",value:"0.3",range:[0,.5],step:.01}),POP.add({name:"vignette2",title:"Vignette amount:",value:"0.5",range:[0,.7],step:.01}),POP.add({name:"dust_level",title:"Dusts level:",value:"70",range:[0,100]}),POP.effects=!0,POP.show("Vintage",function(e){EDIT.save_state();var a=parseInt(e.red_offset),t=parseInt(e.contrast),i=parseFloat(e.blur),r=parseInt(e.light_leak),s=parseInt(e.de_saturation),n=parseInt(e.exposure),o=parseInt(e.grains),l=parseInt(e.big_grains),c=parseFloat(e.vignette1),d=parseFloat(e.vignette2),u=parseInt(e.dust_level);VINTAGE.adjust_color(canvas_active(),WIDTH,HEIGHT,a),VINTAGE.lower_contrast(canvas_active(),WIDTH,HEIGHT,t),VINTAGE.blur(canvas_active(),WIDTH,HEIGHT,i),VINTAGE.light_leak(canvas_active(),WIDTH,HEIGHT,r),VINTAGE.chemicals(canvas_active(),WIDTH,HEIGHT,s),VINTAGE.exposure(canvas_active(),WIDTH,HEIGHT,n),VINTAGE.grains(canvas_active(),WIDTH,HEIGHT,o),VINTAGE.grains_big(canvas_active(),WIDTH,HEIGHT,l),VINTAGE.optics(canvas_active(),WIDTH,HEIGHT,c,d),VINTAGE.dusts(canvas_active(),WIDTH,HEIGHT,u),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.red_offset),s=parseInt(e.contrast),n=parseFloat(e.blur),o=parseInt(e.light_leak),l=parseInt(e.de_saturation),c=parseInt(e.exposure),d=parseInt(e.grains),u=parseInt(e.big_grains),h=parseFloat(e.vignette1),m=parseFloat(e.vignette2),v=parseInt(e.dust_level);VINTAGE.adjust_color(a,t,i,r),VINTAGE.lower_contrast(a,t,i,s),VINTAGE.blur(a,t,i,n),VINTAGE.light_leak(a,t,i,o),VINTAGE.chemicals(a,t,i,l),VINTAGE.exposure(a,t,i,c),VINTAGE.grains(a,t,i,d),VINTAGE.grains_big(a,t,i,u),VINTAGE.optics(a,t,i,h,m),VINTAGE.dusts(a,t,i,v)})},this.effect_bw=function(e,a,t,i,r){var s,n,o,l,c=e.getImageData(0,0,a,t),d=c.data;if(r!==!0)for(var u=0;u<d.length;u+=4)0!=d[u+3]&&(s=Math.round(.2126*d[u]+.7152*d[u+1]+.0722*d[u+2]),n=s<=i?0:255,d[u]=n,d[u+1]=n,d[u+2]=n);else{canvas_front.clearRect(0,0,a,t);for(var h=canvas_front.getImageData(0,0,a,t),m=h.data,v=0;v<t;v++)for(var u=0;u<a;u++){var g=v*(4*a)+4*u;0!=d[g+3]&&(s=Math.round(.2126*d[g]+.7152*d[g+1]+.0722*d[g+2]),s+=m[g],n=Math.floor(s/256),1==n&&(n=255),d[g]=n,d[g+1]=n,d[g+2]=n,o=s-n,u+1<a&&(l=g+4,m[l]+=Math.round(7*o/16)),u-1>0&&v+1<t&&(l=g-4+4*a,m[l]+=Math.round(3*o/16)),v+1<t&&(l=g+4*a,m[l]+=Math.round(5*o/16)),u+1<a&&v+1<t&&(l=g+4+4*a,m[l]+=Math.round(1*o/16)));
}}e.putImageData(c,0,0)},this.colorize=function(e,a,t,i,r,s,n){if(void 0==n||n===!0){for(var o=[],l=0;l<3;l++){o[l]=[];for(var c=HELPER.getRandomInt(-1*i,i),d=0;d<=255;d++)o[l][d]=HELPER.getRandomInt(c-i,c+i),o[l][d]<-1*r?o[l][d]+=10:o[l][d]>r&&(o[l][d]-=10),c=o[l][d]}if(n===!0)return o}else var o=n;for(var u=e.getImageData(0,0,a,t),h=u.data,d=0;d<h.length;d+=4)if(0!=h[d+3]){if(1==s){var m=Math.abs(o[0][h[l]])+Math.abs(o[0][h[l]])+Math.abs(o[0][h[l]]);m/=3}for(var v=0;v<3;v++){var l=d+v;if(0==s)h[l]+=o[v][h[l]];else if(m<6*i)h[l]+=o[v][h[l]];else{var g=HELPER.getRandomInt(Math.min(0,o[v][h[l]]),Math.max(0,o[v][h[l]]));h[l]+=g}h[l]>255&&(h[l]=255),h[l]<0&&(h[l]=0)}}return e.putImageData(u,0,0),!1},this.heatmap_effect=function(e,a,t){for(var i,r,s=e.getImageData(0,0,a,t),n=s.data,o=0;o<n.length;o+=4)0!=n[o+3]&&(i=Math.round(.2126*n[o]+.7152*n[o+1]+.0722*n[o+2]),r=this.color2heat(i),n[o]=r.R,n[o+1]=r.G,n[o+2]=r.B);e.putImageData(s,0,0)},this.color2heat=function(e){var a={R:0,G:0,B:0};return e/=255,0<=e&&e<=1/8?(a.R=0,a.G=0,a.B=4*e+.5):1/8<e&&e<=3/8?(a.R=0,a.G=4*e-.5,a.B=1):3/8<e&&e<=5/8?(a.R=4*e-1.5,a.G=1,a.B=-4*e+2.5):5/8<e&&e<=7/8?(a.R=1,a.G=-4*e+3.5,a.B=0):7/8<e&&e<=1?(a.R=-4*e+4.5,a.G=0,a.B=0):(a.R=.5,a.G=0,a.B=0),a.R*=255,a.G*=255,a.B*=255,a.R=Math.round(a.R),a.G=Math.round(a.G),a.B=Math.round(a.B),a},this.thresholding=function(e,a,t,i,r){for(var s,n=a.getImageData(0,0,t,i),o=n.data,l=[],c=0;c<=255;c++)l[c]=0;for(var c=0;c<o.length;c+=4)s=Math.round(.2126*o[c]+.7152*o[c+1]+.0722*o[c+2]),l[s]++;var d;if("otsu"==e?d=this.otsu(l,t*i):alert("ERROR: unknown method in EFFECTS.thresholding()."),r===!0)return d;for(var u,c=0;c<o.length;c+=4)0!=o[c+3]&&(s=Math.round(.2126*o[c]+.7152*o[c+1]+.0722*o[c+2]),u=s<d?0:255,o[c]=u,o[c+1]=u,o[c+2]=u);a.putImageData(n,0,0)},this.otsu=function(e,a){for(var t=0,i=1;i<256;++i)t+=i*e[i];for(var r,s,n,o=0,l=0,c=0,d=0,u=0,i=0;i<256;++i)if(l+=e[i],0!=l){if(c=a-l,0==c)break;o+=i*e[i],r=o/l,s=(t-o)/c,n=l*c*Math.pow(r-s,2),n>d&&(d=n,u=i)}return u},this.grains_effect=function(e,a,t,i){if(0==i)return e;for(var r=e.getImageData(0,0,a,t),s=r.data,n=0;n<t;n++)for(var o=0;o<a;o++){var l=4*(o+n*a);if(0!=s[l+3]){var c=HELPER.getRandomInt(0,i);0!=c&&(s[l]-c<0?s[l]=-(s[l]-c):s[l]=s[l]-c,s[l+1]-c<0?s[l+1]=-(s[l+1]-c):s[l+1]=s[l+1]-c,s[l+2]-c<0?s[l+2]=-(s[l+2]-c):s[l+2]=s[l+2]-c)}}e.putImageData(r,0,0)}}function TOOLS_CLASS(){this.tools_sprites=function(){POP.add({name:"param1",title:"Gap:",value:"50",values:["0","10","50","100"]}),POP.show("Sprites",function(e){EDIT.save_state();var a=parseInt(e.param1);TOOLS.generate_sprites(a)})},this.tools_keypoints=function(){SIFT.generate_keypoints(canvas_active(!0),!0)},this.tools_panorama=function(){SIFT.panorama()},this.tools_color2alpha=function(){POP.add({name:"param1",title:"Color:",value:COLOR,type:"color"}),POP.show("Color to alpha",function(e){EDIT.save_state();var a=e.param1;TOOLS.convert_color_to_alpha(canvas_active(),WIDTH,HEIGHT,a),GUI.zoom()},function(e,a,t,i){var r=e.param1;TOOLS.convert_color_to_alpha(a,t,i,r)})},this.tools_color_zoom=function(){POP.add({name:"param1",title:"Zoom:",value:"2",range:[2,20]}),POP.add({name:"param2",title:"Center:",value:"128",range:[0,255]}),POP.show("Color Zoom",function(e){EDIT.save_state();var a=parseInt(e.param1),t=parseInt(e.param2);TOOLS.color_zoom(canvas_active(),WIDTH,HEIGHT,a,t),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param1),s=parseInt(e.param2);TOOLS.color_zoom(a,t,i,r,s)})},this.tools_restore_alpha=function(){POP.add({name:"param",title:"Level:",value:"128",range:[0,255]}),POP.show("Recover alpha",function(e){EDIT.save_state();var a=parseInt(e.param);TOOLS.recover_alpha(canvas_active(),WIDTH,HEIGHT,a),GUI.zoom()},function(e,a,t,i){var r=parseInt(e.param);TOOLS.recover_alpha(a,t,i,r)})},this.tools_borders=function(){POP.add({name:"color",title:"Color:",value:COLOR,type:"color"}),POP.add({name:"shadow",title:"Shadow:",values:["No","Yes"]}),POP.add({name:"size",title:"Size:",value:"5",range:[1,100]}),POP.show("Borders",function(e){EDIT.save_state();var a=e.color,t=Math.round(WIDTH/100*e.size),i=!1;"Yes"==e.shadow&&(i=!0),TOOLS.add_borders(canvas_active(),WIDTH,HEIGHT,a,t,i),GUI.zoom()},function(e,a,t,i){var r=e.color,s=Math.round(t/100*e.size),n=!1;"Yes"==e.shadow&&(n=!0),TOOLS.add_borders(a,t,i,r,s,n)})},this.generate_sprites=function(e){if(1==LAYER.layers.length)return!1;EDIT.save_state(),LAYER.layer_add();var a=0,t=0,i=0,r=document.createElement("canvas");r.setAttribute("id","tmp_canvas"),r.width=WIDTH,r.height=HEIGHT;for(var s=WIDTH,n=HEIGHT,o=LAYER.layers.length-1;o>=0;o--)if(o!=LAYER.layer_active&&0!=LAYER.layers[o].visible){r.getContext("2d").clearRect(0,0,s,n),r.getContext("2d").drawImage(document.getElementById(LAYER.layers[o].name),0,0);var l=IMAGE.trim_info(r,!1);if(WIDTH!=l.left){var c=s-l.left-l.right,d=n-l.top-l.bottom;a+c>WIDTH&&(a=0,t+=i,i=0),t%e>0&&e>0&&(t=t-t%e+e),t+d>HEIGHT&&(EVENTS.autosize=!1,HEIGHT=t+d,LAYER.set_canvas_size()),canvas_active().drawImage(r,l.left,l.top,c,d,a,t,c,d),a+=c,e>0&&(a=a-a%e+e),d>i&&(i=d),a>WIDTH&&(a=0,t+=i,i=0)}}},this.convert_color_to_alpha=function(e,a,t,i){for(var r=e.getImageData(0,0,a,t),s=r.data,n=HELPER.hex2rgb(i),o=0;o<s.length;o+=4)if(0!=s[o+3]){var l=Math.abs(s[o]-n.r)+Math.abs(s[o+1]-n.g)+Math.abs(s[o+2]-n.b)/3;s[o+3]=Math.round(l),s[o]=Math.ceil((s[o]-n.r*(1-s[o+3]/255))/(s[o+3]/255)),s[o+1]=Math.ceil((s[o+1]-n.g*(1-s[o+3]/255))/(s[o+3]/255)),s[o+2]=Math.ceil((s[o+2]-n.b*(1-s[o+3]/255))/(s[o+3]/255))}e.putImageData(r,0,0)},this.color_zoom=function(e,a,t,i,r){for(var s,n=e.getImageData(0,0,a,t),o=n.data,l=0;l<o.length;l+=4)if(0!=o[l+3]){s=Math.round(.2126*o[l]+.7152*o[l+1]+.0722*o[l+2]);for(var c=0;c<3;c++){var d=l+c;s>r?o[d]+=(o[d]-r)*i:s<r&&(o[d]-=(r-o[d])*i),o[d]<0&&(o[d]=0),o[d]>255&&(o[d]=255)}}e.putImageData(n,0,0)},this.recover_alpha=function(e,a,t,i){var r,s=e.getImageData(0,0,a,t),n=s.data;i=parseInt(i);for(var o=0;o<n.length;o+=4)r=n[o+3]+i,r>255&&(r=255),n[o+3]=r;e.putImageData(s,0,0)},this.add_borders=function(e,a,t,i,r,s){e.save(),1==s?(e.beginPath(),e.lineWidth=r,e.strokeStyle="green",e.shadowColor=i,e.shadowBlur=r/2,e.rect(-r/2,-r/2,a+r,t+r),e.stroke(),e.stroke(),e.stroke(),e.stroke(),e.stroke()):(e.strokeStyle=i,e.lineWidth=r,EL.rectangle(e,0,0,a-1,t-1,!1,!0)),e.restore()}}function DRAW_TOOLS_CLASS(){this.select_square_action="",this.last_line=[],this.select_data=!1,this.active_tool="select_tool";var e=[],a=!1;this.toolFiller=function(e,a,t,i,r,s,n,o){canvas_front.clearRect(0,0,WIDTH,HEIGHT);var l=canvas_front.getImageData(0,0,a,t),c=l.data,d=e.getImageData(0,0,a,t),u=d.data,h=r*(4*d.width)+4*i,m=[0,-1,1,0],v=[-1,0,0,1],g={r:u[h+0],g:u[h+1],b:u[h+2],a:u[h+3]};if(g.r==s.r&&g.g==s.g&&g.b==s.b&&g.a==s.a)return!1;var p=[];for(p.push([i,r]);p.length>0;)for(var _=p.pop(),f=0;f<4;f++){var I=_[0]+m[f],y=_[1]+v[f];if(!(I<0||y<0||I>=a||y>=t)){var h=4*(y*a+I);0==c[h+3]&&Math.abs(u[h+0]-g.r)<=n&&Math.abs(u[h+1]-g.g)<=n&&Math.abs(u[h+2]-g.b)<=n&&Math.abs(u[h+3]-g.a)<=n&&(c[h]=s.r,c[h+1]=s.g,c[h+2]=s.b,c[h+3]=s.a,p.push([I,y]))}}canvas_front.putImageData(l,0,0),1==o&&(e.shadowColor="rgba("+s.r+", "+s.g+", "+s.b+", "+s.a/255+")",e.shadowBlur=5),e.drawImage(document.getElementById("canvas_front"),0,0),e.shadowBlur=0},this.tool_magic_wand=function(e,a,t,i,r,s,n){canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.rect(0,0,WIDTH,HEIGHT),canvas_front.fillStyle="rgba(255, 255, 255, 0)",canvas_front.fill();var o=canvas_front.getImageData(0,0,a,t),l=o.data,c=e.getImageData(0,0,a,t),d=c.data,u=r*(4*c.width)+4*i,h=[0,-1,1,0],m=[-1,0,0,1],v={r:255,g:255,b:255,a:255},g={r:d[u+0],g:d[u+1],b:d[u+2],a:d[u+3]};if(g.r==v.r&&g.g==v.g&&g.b==v.b&&0==g.a)return!1;var p=[];for(p.push([i,r]);p.length>0;)for(var _=p.pop(),f=0;f<4;f++){var I=_[0]+h[f],y=_[1]+m[f];if(!(I<0||y<0||I>=a||y>=t)){var u=4*(y*a+I);0==l[u+3]&&Math.abs(d[u]-g.r)<=s&&Math.abs(d[u+1]-g.g)<=s&&Math.abs(d[u+2]-g.b)<=s&&Math.abs(d[u+3]-g.a)<=s&&(l[u]=v.r,l[u+1]=v.g,l[u+2]=v.b,l[u+3]=v.a,p.push([I,y]))}}1==n&&(o=ImageFilters.StackBlur(o,2)),canvas_front.putImageData(o,0,0),e.globalCompositeOperation="destination-out",e.drawImage(document.getElementById("canvas_front"),0,0),e.shadowBlur=0,e.globalCompositeOperation="source-over"},this.select_tool=function(e,a,t){if(void 0==a)return!1;if(0==a.valid)return!0;if(0==a.click_valid)return!0;if(void 0!=t&&"canvas_preview"==t.target.id)return!0;var i=document.getElementById(LAYER.layers[LAYER.layer_active].name);if("drag"==e)if(canvas_front.clearRect(0,0,WIDTH,HEIGHT),"hidden"!=i.style.visibility&&(i.style.visibility="hidden"),1==EVENTS.ctrl_pressed){var r=a.x,s=a.y;Math.abs(a.click_x-a.x)<Math.abs(a.click_y-a.y)?r=a.click_x:s=a.click_y,canvas_front.drawImage(canvas_active(!0),r-a.click_x,s-a.click_y)}else canvas_front.drawImage(canvas_active(!0),a.x-a.click_x,a.y-a.click_y);else if("release"==e){if(i.style.visibility="visible",0==a.valid||a.click_x===!1)return!1;if(a.x-a.click_x==0&&a.y-a.click_y==0)return!1;EDIT.save_state();var n=canvas_active().getImageData(0,0,WIDTH,HEIGHT);if(canvas_active().clearRect(0,0,WIDTH,HEIGHT),1==EVENTS.ctrl_pressed){var r=a.x,s=a.y;Math.abs(a.click_x-a.x)<Math.abs(a.click_y-a.y)?r=a.click_x:s=a.click_y,canvas_active().putImageData(n,r-a.click_x,s-a.click_y)}else canvas_active().putImageData(n,a.x-a.click_x,a.y-a.click_y)}},this.magic_wand=function(e,a,t){return 0==a.valid||void("click"==e&&(EDIT.save_state(),this.tool_magic_wand(canvas_active(),WIDTH,HEIGHT,a.x,a.y,GUI.action_data().attributes.power,GUI.action_data().attributes.anti_aliasing)))},this.erase=function(e,a,t){if(0==a.valid)return!0;var i=GUI.action_data().attributes.strict,r=GUI.action_data().attributes.size,s=GUI.action_data().attributes.circle,n=document.getElementById("strict");if(0==s?void 0!=n&&(n.style.display="none"):void 0!=n&&(n.style.display="block"),"click"==e)if(EDIT.save_state(),0==s)canvas_active().save(),canvas_active().globalCompositeOperation="destination-out",canvas_active().fillStyle="rgba(255, 255, 255, "+ALPHA/255+")",canvas_active().fillRect(a.x-Math.ceil(r/2)+1,a.y-Math.ceil(r/2)+1,r,r),canvas_active().restore();else{if(0==i){var o=canvas_active().createRadialGradient(a.x,a.y,r/8,a.x,a.y,r/2);o.addColorStop(0,"rgba(255, 255, 255, "+ALPHA/255+")"),o.addColorStop(1,"rgba(255, 255, 255, 0)")}canvas_active().save(),canvas_active().globalCompositeOperation="destination-out",1==i?canvas_active().fillStyle="rgba(255, 255, 255, "+ALPHA/255+")":canvas_active().fillStyle=o,canvas_active().beginPath(),canvas_active().arc(a.x,a.y,r/2,0,2*Math.PI,!0),canvas_active().fill(),canvas_active().restore()}else if("drag"==e){if(0==s)canvas_active().save(),canvas_active().globalCompositeOperation="destination-out",ALPHA<255?canvas_active().fillStyle="rgba(255, 255, 255, "+ALPHA/255/10+")":canvas_active().fillStyle=COLOR,canvas_active().fillRect(a.x-Math.ceil(r/2)+1,a.y-Math.ceil(r/2)+1,r,r),canvas_active().restore();else{if(0==i){var o=canvas_active().createRadialGradient(a.x,a.y,r/10,a.x,a.y,r/2);ALPHA<255?o.addColorStop(0,"rgba(255, 255, 255, "+ALPHA/255/10+")"):o.addColorStop(0,"rgba(255, 255, 255, 1)"),o.addColorStop(1,"rgba(255, 255, 255, 0)")}canvas_active().save(),canvas_active().globalCompositeOperation="destination-out",1==i?ALPHA<255?canvas_active().fillStyle="rgba(255, 255, 255, "+ALPHA/255/10+")":canvas_active().fillStyle=COLOR:canvas_active().fillStyle=o,canvas_active().beginPath(),canvas_active().arc(a.x,a.y,r/2,0,2*Math.PI,!0),canvas_active().fill(),canvas_active().restore()}canvas_front.clearRect(0,0,WIDTH,HEIGHT),0==s?(canvas_front.lineWidth=1,EL.rectangle_dashed(canvas_front,a.x-Math.ceil(r/2)+1,a.y-Math.ceil(r/2)+1,a.x+Math.floor(r/2),a.y+Math.floor(r/2),1,"#000000")):EL.circle(canvas_front,a.x,a.y,r)}else if("move"==e){var l=Math.floor(r/2),c=Math.floor(r/2);r%2==0?c--:l--,canvas_front.clearRect(0,0,WIDTH,HEIGHT),0==s?(canvas_front.lineWidth=1,EL.rectangle_dashed(canvas_front,a.x-Math.ceil(r/2)+1,a.y-Math.ceil(r/2)+1,a.x+Math.floor(r/2),a.y+Math.floor(r/2),1,"#000000")):EL.circle(canvas_front,a.x,a.y,r)}},this.fill=function(e,a,t){if(0==a.valid)return!0;if("click"==e){EDIT.save_state();var i=HELPER.hex2rgb(COLOR);i.a=ALPHA,DRAW.toolFiller(canvas_active(),WIDTH,HEIGHT,a.x,a.y,i,GUI.action_data().attributes.power,GUI.action_data().attributes.anti_aliasing)}},this.pick_color=function(e,a,t){if(0==a.valid)return!0;if("click"==e){var i=canvas_active().getImageData(a.x,a.y,1,1).data;COLOR="#"+("000000"+HELPER.rgbToHex(i[0],i[1],i[2])).slice(-6),ALPHA=i[3],document.getElementById("rgb_a").value=ALPHA,GUI.sync_colors()}},this.pencil=function(e,a,t){if(0==a.valid)return!0;var i=HELPER.hex2rgb(COLOR);if("click"==e)EDIT.save_state();else if("drag"==e){if(0!=a.last_x&&0!=a.last_y){dist_x=a.last_x-a.x,dist_y=a.last_y-a.y,distance=Math.sqrt(dist_x*dist_x+dist_y*dist_y),radiance=Math.atan2(dist_y,dist_x);for(var r=0;r<distance;r++){x_tmp=a.x+Math.cos(radiance)*r,y_tmp=a.y+Math.sin(radiance)*r,x_tmp=Math.round(x_tmp),y_tmp=Math.round(y_tmp);HELPER.hex2rgb(COLOR);canvas_active().fillStyle="rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",canvas_active().fillRect(x_tmp,y_tmp,1,1)}}}else"release"==e&&(canvas_active().fillStyle="rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",canvas_active().fillRect(a.x,a.y,1,1))},this.line=function(a,t,i){if(0==t.click_valid)return!1;var r=HELPER.hex2rgb(COLOR),s=t.x,n=t.y,o=t.click_x,l=t.click_y,c=GUI.action_data().attributes.type;if("move"==a)canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_front.lineWidth=GUI.action_data().attributes.size,"Curve"==c&&2==e.length&&(canvas_front.beginPath(),canvas_front.moveTo(e[0][0]+.5,e[0][1]+.5),canvas_front.quadraticCurveTo(t.x+.5,t.y+.5,e[1][0],e[1][1]),canvas_front.stroke());else if("drag"==a)if(document.body.style.cursor="crosshair",canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.beginPath(),canvas_front.strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_front.lineWidth=GUI.action_data().attributes.size,"Multi-line"==c&&void 0!=this.last_line[0]&&(o=this.last_line[0],l=this.last_line[1]),1==EVENTS.ctrl_pressed&&(Math.abs(o-t.x)<Math.abs(l-t.y)?s=o:n=l),"Arrow"==c){var d=5*GUI.action_data().attributes.size;d<15&&(d=15),EL.arrow(canvas_front,o+.5,l+.5,s+.5,n+.5,d)}else canvas_front.moveTo(o+.5,l+.5),canvas_front.lineTo(s+.5,n+.5),canvas_front.stroke();else if("click"==a)"Curve"==c&&(EDIT.save_state(),canvas_active().beginPath(),canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=GUI.action_data().attributes.size,1==EVENTS.ctrl_pressed&&(Math.abs(o-t.x)<Math.abs(l-t.y)?s=o:n=l),2==e.length&&(canvas_active().beginPath(),canvas_active().moveTo(e[0][0]+.5,e[0][1]+.5),canvas_active().quadraticCurveTo(s+.5,n+.5,e[1][0],e[1][1]),canvas_active().stroke(),e=[]));else if("release"==a){if(document.body.style.cursor="auto",t.x-t.click_x==0&&t.y-t.click_y==0&&"Multi-line"!=c)return!1;if(EDIT.save_state(),canvas_active().beginPath(),canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=GUI.action_data().attributes.size,"Multi-line"==c&&void 0!=this.last_line[0]&&(o=DRAW.last_line[0],l=DRAW.last_line[1]),1==EVENTS.ctrl_pressed&&(Math.abs(o-t.x)<Math.abs(l-t.y)?s=o:n=l),"Arrow"==c){var d=5*GUI.action_data().attributes.size;d<15&&(d=15),EL.arrow(canvas_active(),o+.5,l+.5,s+.5,n+.5,d),this.last_line[0]=s,this.last_line[1]=n}else"Curve"==c?0!=e.length||t.click_x==t.x&&t.click_y==t.y?2==e.length&&(e=[]):(e.push([t.click_x,t.click_y]),e.push([s,n])):(EL.line(canvas_active(),o,l,s,n),this.last_line[0]=s,this.last_line[1]=n)}},this.letters=function(e,a,t){var i=this;if(0==a.valid)return!0;var r=a.x,s=a.y;"click"==e&&(POP.add({name:"text",title:"Text:",value:"",type:"textarea"}),POP.add({name:"size",title:"Size:",value:20,range:[2,1e3],step:2}),POP.add({name:"color",title:"Color:",value:"#000000",type:"color"}),POP.add({name:"style",title:"Font style:",values:["Normal","Italic","Bold","Bold Italic"],type:"select"}),POP.add({name:"family",title:"Font family:",values:["Arial","Courier","Impact","Helvetica","monospace","Times New Roman","Verdana"],type:"select"}),POP.add({name:"size_3d",title:"3D size:",value:0,range:[0,200]}),POP.add({name:"pos_3d",title:"3D position:",values:["Top-left","Top-right","Bottom-left","Bottom-right"],type:"select"}),POP.add({name:"shadow",title:"Shadow:",values:["No","Yes"]}),POP.add({name:"shadow_blur",title:"Shadow blur:",value:6,range:[1,20]}),POP.add({name:"shadow_color",title:"Shadow color:",value:"#000000",type:"color"}),POP.add({name:"fill_style",title:"Fill style:",values:["Fill","Stroke","Both"],type:"select"}),POP.add({name:"stroke_size",title:"Stroke size:",value:1,range:[1,100]}),POP.preview_in_main=!0,POP.show("Text",function(e){EDIT.save_state(),text=e.text.split("\n");for(var a in text){e.text=text[a];var t=s+a*(parseInt(e.size)+2);i.letters_render(canvas_active(),r,t,e)}canvas_front.clearRect(0,0,WIDTH,HEIGHT)},function(e){canvas_front.clearRect(0,0,WIDTH,HEIGHT),text=e.text.split("\n");for(var a in text){e.text=text[a];var t=s+a*(parseInt(e.size)+2);i.letters_render(canvas_front,r,t,e)}}))},this.letters_render=function(e,a,t,i){var r,s,n=i.text,o=parseInt(i.size),l=i.color,c=parseInt(i.size_3d),d=i.pos_3d,u=i.shadow,h=parseInt(i.shadow_blur),m=i.shadow_color,v=i.family,g=i.style,p=i.fill_style,_=i.stroke_size;"Top-left"==d?(r=-1,s=-1):"Top-right"==d?(r=1,s=-1):"Bottom-left"==d?(r=-1,s=1):"Bottom-right"==d&&(r=1,s=1);var f=HELPER.hex2rgb(l);e.fillStyle="rgba("+f.r+", "+f.g+", "+f.b+", "+ALPHA/255+")",e.font=g+" "+o+"px "+v;var I=HELPER.font_pixel_to_height(o);if("Yes"==u&&(e.save(),e.shadowColor=m,e.shadowBlur=h,e.shadowOffsetX=r,e.shadowOffsetY=s,e.fillText(n,a+r*(c-1),t+I+s*(c-1)),e.restore()),c>0){for(e.fillStyle=HELPER.darkenColor(COLOR,-30),alpha_tmp=ALPHA,alpha_tmp<255&&(alpha_tmp/=10),f.r-=50,f.g-=50,f.b-=50,f.r<0&&(f.r*=-1),f.g<0&&(f.g*=-1),f.b<0&&(f.b*=-1),e.fillStyle="rgba("+f.r+", "+f.g+", "+f.b+", "+alpha_tmp/255+")",cnt=0;cnt<c;cnt++)e.fillText(n,a+r*cnt,t+I+s*cnt);f=HELPER.hex2rgb(COLOR)}e.fillStyle="rgba("+f.r+", "+f.g+", "+f.b+", "+ALPHA/255+")",e.strokeStyle="rgba("+f.r+", "+f.g+", "+f.b+", "+ALPHA/255+")",e.lineWidth=_,"Fill"!=p&&"Both"!=p||e.fillText(n,a,t+I),"Stroke"!=p&&"Both"!=p||e.strokeText(n,a,t+I),GUI.zoom()},this.draw_square=function(e,a,t){if(0==a.click_valid)return!0;var i=HELPER.hex2rgb(COLOR),r=GUI.action_data().attributes.fill,s=a.x-a.click_x,n=a.y-a.click_y;if("drag"==e)canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.fillStyle="rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",canvas_front.strokeStyle="rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",canvas_front.lineWidth=1,1==GUI.action_data().attributes.square?EL.square(canvas_front,a.click_x,a.click_y,s,n,r):EL.rectangle(canvas_front,a.click_x,a.click_y,s,n,r);else if("release"==e){if(a.x==a.click_x&&a.y==a.click_y)return!1;EDIT.save_state(),canvas_active().fillStyle="rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",canvas_active().strokeStyle="rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",canvas_active().lineWidth=1,1==GUI.action_data().attributes.square?EL.square(canvas_active(),a.click_x,a.click_y,s,n,r):EL.rectangle(canvas_active(),a.click_x,a.click_y,s,n,r)}},this.draw_circle=function(e,a,t){if(0==a.click_valid)return!0;var i=HELPER.hex2rgb(COLOR);if("drag"==e)dist_x=a.x-a.click_x,dist_y=a.y-a.click_y,canvas_front.clearRect(0,0,WIDTH,HEIGHT),1==GUI.action_data().attributes.circle&&(dist_x=dist_y=Math.min(dist_x,dist_y)),1==GUI.action_data().attributes.fill?EL.ellipse_by_center(canvas_front,a.click_x,a.click_y,2*dist_x,2*dist_y,"rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",!0):EL.ellipse_by_center(canvas_front,a.click_x,a.click_y,2*dist_x,2*dist_y,"rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")");else if("release"==e){if(dist_x=a.x-a.click_x,dist_y=a.y-a.click_y,0==dist_x&&0==dist_y)return!1;EDIT.save_state(),1==GUI.action_data().attributes.circle&&(dist_x=dist_y=Math.min(dist_x,dist_y)),canvas_active().lineWidth=1,1==GUI.action_data().attributes.fill?EL.ellipse_by_center(canvas_active(),a.click_x,a.click_y,2*dist_x,2*dist_y,"rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")",!0):EL.ellipse_by_center(canvas_active(),a.click_x,a.click_y,2*dist_x,2*dist_y,"rgba("+i.r+", "+i.g+", "+i.b+", "+ALPHA/255+")")}},this.update_brush=function(){document.getElementById("anti_aliasing").style.display="","Brush"!=GUI.action_data().attributes.type&&(document.getElementById("anti_aliasing").style.display="none")},this.desaturate_tool=function(e,a,t){if(0==a.valid)return!0;var i=GUI.action_data().attributes.size,r=a.x-i/2,s=a.y-i/2;if(r<0&&(r=0),s<0&&(s=0),"click"==e){EDIT.save_state();var n=canvas_active().getImageData(r,s,i,i),o=ImageFilters.GrayScale(n);EL.image_round(canvas_active(),a.x,a.y,i,o,document.getElementById("canvas_front"),GUI.action_data().attributes.anti_aliasing)}else if("drag"==e){var n=canvas_active().getImageData(r,s,i,i),o=ImageFilters.GrayScale(n);EL.image_round(canvas_active(),a.x,a.y,i,o,document.getElementById("canvas_front"),GUI.action_data().attributes.anti_aliasing)}"move"!=e&&"drag"!=e||(canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i))},this.brush=function(e,a,t){if(0==a.valid)return!0;var i=GUI.action_data().attributes.type,r=HELPER.hex2rgb(COLOR),s=GUI.action_data().attributes.size;if("click"==e&&EDIT.save_state(),"Brush"==i)"click"==e?(canvas_active().beginPath(),canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=GUI.action_data().attributes.size,canvas_active().lineCap="round",canvas_active().lineJoin="round",canvas_front.clearRect(0,0,WIDTH,HEIGHT),ALPHA<255&&(canvas_front.beginPath(),canvas_front.strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_front.lineWidth=GUI.action_data().attributes.size,canvas_front.lineCap="round",canvas_front.lineJoin="round"),canvas_front.beginPath(),canvas_front.arc(a.x,a.y,GUI.action_data().attributes.size/2,0,2*Math.PI,!1),canvas_front.fillStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_front.fill(),canvas_active().shadowBlur=0,1==GUI.action_data().attributes.anti_aliasing&&(canvas_active().shadowColor="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().shadowBlur=Math.round(GUI.action_data().attributes.size))):"drag"==e&&0!=a.last_x&&0!=a.last_y?(255==ALPHA&&canvas_active().beginPath(),canvas_active().moveTo(a.last_x,a.last_y),canvas_active().lineTo(a.x,a.y),255==ALPHA&&canvas_active().stroke(),ALPHA<255&&(canvas_front.beginPath(),canvas_front.globalCompositeOperation="destination-out",canvas_front.strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", 1)",canvas_front.moveTo(a.last_x,a.last_y),canvas_front.lineTo(a.x,a.y),canvas_front.stroke(),canvas_front.strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_front.globalCompositeOperation="source-over",canvas_front.moveTo(a.last_x,a.last_y),canvas_front.lineTo(a.x,a.y),canvas_front.stroke())):"release"==e?(canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_active().stroke(),a.click_x==a.x&&a.click_y==a.y&&(canvas_active().beginPath(),canvas_active().arc(a.x,a.y,GUI.action_data().attributes.size/2,0,2*Math.PI,!1),canvas_active().fillStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().fill()),canvas_active().shadowBlur=0):"move"==e&&(canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,s));else if("BezierCurve"==i){if("click"==e)BezierCurveBrush.startCurve(a.x,a.y);else if("drag"==e&&0!=a.last_x&&0!=a.last_y){var r=HELPER.hex2rgb(COLOR);canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=.5,BezierCurveBrush.draw(canvas_active(),r,a.x,a.y,GUI.action_data().attributes.size)}}else if("Chrome"==i){if("click"==e)chrome_brush.init(canvas_active()),chrome_brush.strokeStart(a.x,a.y);else if("drag"==e&&0!=a.last_x&&0!=a.last_y){var r=HELPER.hex2rgb(COLOR);canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=1,chrome_brush.stroke(r,a.x,a.y,GUI.action_data().attributes.size)}}else if("Fur"==i){if("click"==e)points=new Array,prevMouseX=a.x,prevMouseY=a.y,count=0;else if("drag"==e&&0!=a.last_x&&0!=a.last_y){var r=HELPER.hex2rgb(COLOR);canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", 0.1)",canvas_active().lineWidth=1,f=a.x,c=a.y;var n,o,l,d;for(points.push([f,c]),canvas_active().beginPath(),canvas_active().moveTo(prevMouseX,prevMouseY),canvas_active().lineTo(f,c),canvas_active().stroke(),n=0;n<points.length;n++){o=points[n][0]-points[count][0],l=points[n][1]-points[count][1],d=o*o+l*l;var u=Math.round(400*GUI.action_data().attributes.size);d<u&&Math.random()>d/u&&(canvas_active().beginPath(),canvas_active().moveTo(f+.5*o,c+.5*l),canvas_active().lineTo(f-.5*o,c-.5*l),canvas_active().stroke())}prevMouseX=f,prevMouseY=c,count++}}else if("Grouped"==i){if(groups_n=GUI.action_data().attributes.size,gsize=10,random_power=5,"click"==e){chrome_brush.init(canvas_active()),chrome_brush.strokeStart(a.x,a.y),groups=[];for(var d=0;d<groups_n;d++)groups[d]={},groups[d].x=HELPER.getRandomInt(-gsize,gsize),groups[d].y=HELPER.getRandomInt(-gsize,gsize)}else if("drag"==e&&0!=a.last_x&&0!=a.last_y){canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=.5;for(var d in groups)canvas_active().beginPath(),canvas_active().moveTo(a.last_x+groups[d].x,a.last_y+groups[d].y),groups[d].x+=HELPER.getRandomInt(-random_power,random_power),groups[d].y+=HELPER.getRandomInt(-random_power,random_power),groups[d].x<-gsize&&(groups[d].x=-gsize+random_power),groups[d].y<-gsize&&(groups[d].y=-gsize+random_power),groups[d].x>gsize&&(groups[d].x=gsize-random_power),groups[d].y>gsize&&(groups[d].y=gsize-random_power),canvas_active().lineTo(a.x+groups[d].x,a.y+groups[d].y),canvas_active().stroke()}}else if("Shaded"==i){if("click"==e)shaded_brush.init(canvas_active()),shaded_brush.strokeStart(a.x,a.y);else if("drag"==e&&0!=a.last_x&&0!=a.last_y){var r=HELPER.hex2rgb(COLOR);canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=1,shaded_brush.stroke(r,a.x,a.y,GUI.action_data().attributes.size)}}else if("Sketchy"==i)if("click"==e)sketchy_brush.init(canvas_active()),sketchy_brush.strokeStart(a.x,a.y);else if("drag"==e&&0!=a.last_x&&0!=a.last_y){var r=HELPER.hex2rgb(COLOR);canvas_active().strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+ALPHA/255+")",canvas_active().lineWidth=1,sketchy_brush.stroke(r,a.x,a.y,GUI.action_data().attributes.size)}},this.gradient_tool=function(e,a,t){if(void 0!=a&&0==a.valid&&"init"!=e)return!0;var i=GUI.action_data().attributes.power;if(i>99&&(i=99),"init"==e)POP.add({name:"param1",title:"Color #1:",value:"#000000",type:"color"}),POP.add({name:"param2",title:"Transparency #1:",value:"255",range:[0,255]}),POP.add({name:"param3",title:"Color #2:",value:"#ffffff",type:"color"}),POP.add({name:"param4",title:"Transparency #2:",value:"255",range:[0,255]}),POP.show("Text",function(e){color1=HELPER.hex2rgb(e.param1),color1.a=parseInt(e.param2),color2=HELPER.hex2rgb(e.param3),color2.a=parseInt(e.param4)});else if("drag"==e){if(canvas_front.clearRect(0,0,WIDTH,HEIGHT),0==GUI.action_data().attributes.radial){if(canvas_front.rect(0,0,WIDTH,HEIGHT),a.x>a.click_x)var r=canvas_front.createLinearGradient(a.click_x,a.click_y,a.x,a.y);else var r=canvas_front.createLinearGradient(a.x,a.y,a.click_x,a.click_y);r.addColorStop(0,"rgba("+color1.r+", "+color1.g+", "+color1.b+", "+color1.a/255+")"),r.addColorStop(1,"rgba("+color2.r+", "+color2.g+", "+color2.b+", "+color2.a/255+")"),canvas_front.fillStyle=r,canvas_front.fill()}else{var s=a.click_x-a.x,n=a.click_y-a.y,o=Math.sqrt(s*s+n*n),l=canvas_front.createRadialGradient(a.click_x,a.click_y,o*i/100,a.click_x,a.click_y,o);l.addColorStop(0,"rgba("+color1.r+", "+color1.g+", "+color1.b+", "+color1.a/255+")"),l.addColorStop(1,"rgba("+color2.r+", "+color2.g+", "+color2.b+", "+color2.a/255+")"),canvas_front.fillStyle=l,canvas_front.fillRect(0,0,WIDTH,HEIGHT)}canvas_front.beginPath(),canvas_front.strokeStyle="#ff0000",canvas_front.lineWidth=1;var c=a.x,d=a.y;canvas_front.moveTo(a.click_x+.5,a.click_y+.5),canvas_front.lineTo(c+.5,d+.5),canvas_front.stroke()}else if("release"==e)if(EDIT.save_state(),0==GUI.action_data().attributes.radial){if(canvas_active().rect(0,0,WIDTH,HEIGHT),a.x>a.click_x)var r=canvas_active().createLinearGradient(a.click_x,a.click_y,a.x,a.y);else var r=canvas_active().createLinearGradient(a.x,a.y,a.click_x,a.click_y);r.addColorStop(0,"rgba("+color1.r+", "+color1.g+", "+color1.b+", "+color1.a/255+")"),r.addColorStop(1,"rgba("+color2.r+", "+color2.g+", "+color2.b+", "+color2.a/255+")"),canvas_active().fillStyle=r,canvas_active().fill()}else{var s=a.click_x-a.x,n=a.click_y-a.y,o=Math.sqrt(s*s+n*n),l=canvas_active().createRadialGradient(a.click_x,a.click_y,o*i/100,a.click_x,a.click_y,o);l.addColorStop(0,"rgba("+color1.r+", "+color1.g+", "+color1.b+", "+color1.a/255+")"),l.addColorStop(1,"rgba("+color2.r+", "+color2.g+", "+color2.b+", "+color2.a/255+")"),canvas_active().fillStyle=l,canvas_active().fillRect(0,0,WIDTH,HEIGHT)}},this.blur_tool=function(e,a,t){if(0==a.valid)return!0;var i=GUI.action_data().attributes.size,r=(Math.round(i/2),a.x-i/2),s=a.y-i/2;if(r<0&&(r=0),s<0&&(s=0),"click"==e){EDIT.save_state();var n=GUI.action_data().attributes.power,o=canvas_active().getImageData(r,s,i,i),l=ImageFilters.StackBlur(o,n);EL.image_round(canvas_active(),a.x,a.y,i,l,document.getElementById("canvas_front")),canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i)}else if("drag"==e){var n=GUI.action_data().attributes.power,o=canvas_active().getImageData(r,s,i,i),l=ImageFilters.StackBlur(o,n);EL.image_round(canvas_active(),a.x,a.y,i,l,document.getElementById("canvas_front")),canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i)}else"move"==e&&(canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i))},this.sharpen_tool=function(e,a,t){if(0==a.valid)return!0;var i=GUI.action_data().attributes.size,r=.5,s=a.x-i/2,n=a.y-i/2;if(s<0&&(s=0),n<0&&(n=0),"click"==e){EDIT.save_state();var o=canvas_active().getImageData(s,n,i,i),l=ImageFilters.Sharpen(o,r);EL.image_round(canvas_active(),a.x,a.y,i,l,document.getElementById("canvas_front")),canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i)}else if("drag"==e){var o=canvas_active().getImageData(s,n,i,i),l=ImageFilters.Sharpen(o,r);EL.image_round(canvas_active(),a.x,a.y,i,l,document.getElementById("canvas_front")),canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i)}else"move"==e&&(canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i))},this.burn_dodge_tool=function(e,a,t){if(0==a.valid)return!0;var i=GUI.action_data().attributes.size,r=2.5*GUI.action_data().attributes.power;"click"==e?(EDIT.save_state(),canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.save(),EVENTS.clear_front_on_release=!1,canvas_active().beginPath(),canvas_active().lineWidth=GUI.action_data().attributes.size,canvas_active().lineCap="round",canvas_active().lineJoin="round",canvas_front.beginPath(),1==GUI.action_data().attributes.burn?canvas_front.strokeStyle="rgba(0, 0, 0, "+r/255+")":canvas_front.strokeStyle="rgba(255, 255, 255, "+r/255+")",canvas_front.lineWidth=GUI.action_data().attributes.size,canvas_front.lineCap="round",canvas_front.lineJoin="round"):"drag"==e&&0!=a.last_x&&0!=a.last_y?(canvas_front.beginPath(),canvas_front.globalCompositeOperation="destination-out",canvas_front.moveTo(a.last_x,a.last_y),canvas_front.lineTo(a.x,a.y),canvas_front.stroke(),canvas_front.globalCompositeOperation="source-over",canvas_front.moveTo(a.last_x,a.last_y),canvas_front.lineTo(a.x,a.y),canvas_front.stroke()):"release"==e?(canvas_active().globalCompositeOperation="soft-light",canvas_active().shadowBlur=5,canvas_active().drawImage(document.getElementById("canvas_front"),0,0),
canvas_active().globalCompositeOperation="source-over",canvas_front.clearRect(0,0,WIDTH,HEIGHT),EVENTS.clear_front_on_release=!0,a.click_x==a.x&&a.click_y==a.y&&(canvas_active().globalCompositeOperation="soft-light",canvas_active().beginPath(),canvas_active().arc(a.x,a.y,GUI.action_data().attributes.size/2,0,2*Math.PI,!1),1==GUI.action_data().attributes.burn?canvas_active().fillStyle="rgba(0, 0, 0, "+r/255+")":canvas_active().fillStyle="rgba(255, 255, 255, "+r/255+")",canvas_active().shadowBlur=5,canvas_active().fill(),canvas_active().globalCompositeOperation="source-over"),canvas_active().shadowBlur=0,canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.restore()):"move"==e&&0==EVENTS.isDrag&&(canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,a.x,a.y,i))},this.crop_tool=function(e,a,t){if(0==a.click_valid)return!0;if("drag"==e)a.x<0&&(a.x=0),a.y<0&&(a.y=0),a.x>=WIDTH&&(a.x=WIDTH),a.y>=HEIGHT&&(a.y=HEIGHT),a.click_x>=WIDTH&&(a.click_x=WIDTH),a.click_y>=HEIGHT&&(a.click_y=HEIGHT),""==this.select_square_action&&(document.body.style.cursor="crosshair",canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.fillStyle="rgba(0, 255, 0, 0.3)",canvas_front.fillRect(a.click_x,a.click_y,a.x-a.click_x,a.y-a.click_y));else if("move"==e&&0!=this.select_data){if(1==EVENTS.isDrag)return!0;canvas_front.lineWidth=1,border_size=5,this.select_square_action="",""==this.select_square_action&&a.x>this.select_data.x&&a.y>this.select_data.y&&a.x<this.select_data.x+this.select_data.w&&a.y<this.select_data.y+this.select_data.h&&(this.select_square_action="move",document.body.style.cursor="pointer"),""==this.select_square_action&&1==a.valid&&(document.body.style.cursor="auto")}else if("release"==e)a.x<0&&(a.x=0),a.y<0&&(a.y=0),a.x>=WIDTH&&(a.x=WIDTH),a.y>=HEIGHT&&(a.y=HEIGHT),a.click_x>=WIDTH&&(a.click_x=WIDTH),a.click_y>=HEIGHT&&(a.click_y=HEIGHT),""==this.select_square_action&&a.x!=a.click_x&&a.y!=a.click_y&&(this.select_data={x:Math.min(a.x,a.click_x),y:Math.min(a.y,a.click_y),w:Math.abs(a.x-a.click_x),h:Math.abs(a.y-a.click_y)}),GUI.draw_selected_area(!0),LAYER.update_info_block();else if("click"==e&&0!=this.select_data&&(document.body.style.cursor="auto",a.x>this.select_data.x&&a.y>this.select_data.y&&a.x<this.select_data.x+this.select_data.w&&a.y<this.select_data.y+this.select_data.h)){EDIT.save_state();for(var i in LAYER.layers){var r=document.getElementById(LAYER.layers[i].name).getContext("2d"),s=r.getImageData(this.select_data.x,this.select_data.y,this.select_data.w,this.select_data.h);r.clearRect(0,0,WIDTH,HEIGHT),r.putImageData(s,0,0)}EDIT.save_state(),WIDTH=this.select_data.w,HEIGHT=this.select_data.h,LAYER.set_canvas_size(),EDIT.edit_clear()}},this.clone_tool=function(e,t,i){if(0==t.valid)return!0;var r=GUI.action_data().attributes.size,s=Math.round(r/2);if("click"==e)EDIT.save_state(),a===!1?(POP.add({html:"Source is empty, right click on image first."}),POP.show("Error","")):EL.image_round(canvas_active(),t.x,t.y,r,a,document.getElementById("canvas_front"),GUI.action_data().attributes.anti_aliasing);else{if("right_click"==e){a=document.createElement("canvas"),a.width=r,a.height=r;var n=t.x-s,o=t.y-s;return n<0&&(n=0),o<0&&(o=0),a.getContext("2d").drawImage(canvas_active(!0),n,o,r,r,0,0,r,r),!1}if("drag"==e){if(3==i.which)return!0;if(a===!1)return!1;EL.image_round(canvas_active(),t.x,t.y,r,a,document.getElementById("canvas_front"),GUI.action_data().attributes.anti_aliasing)}else"move"==e&&(canvas_front.clearRect(0,0,WIDTH,HEIGHT),EL.circle(canvas_front,t.x,t.y,r))}},this.select_square=function(e,a,t){if(0==a.click_valid)return!0;if("drag"==e)if(a.x<0&&(a.x=0),a.y<0&&(a.y=0),a.x>=WIDTH&&(a.x=WIDTH),a.y>=HEIGHT&&(a.y=HEIGHT),a.click_x>=WIDTH&&(a.click_x=WIDTH),a.click_y>=HEIGHT&&(a.click_y=HEIGHT),""==this.select_square_action)document.body.style.cursor="crosshair",canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.fillStyle="rgba(0, 255, 0, 0.3)",canvas_front.fillRect(a.click_x,a.click_y,a.x-a.click_x,a.y-a.click_y);else if("move"==this.select_square_action)try{canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.drawImage(canvas_active(!0),this.select_data.x,this.select_data.y,this.select_data.w,this.select_data.h,a.x-a.click_x+this.select_data.x,a.y-a.click_y+this.select_data.y,this.select_data.w,this.select_data.h),canvas_front.restore()}catch(e){console.log("Error: "+e.message)}else{var i=this.select_data.x,r=this.select_data.y,s=this.select_data.w,n=this.select_data.h;"resize-left"==this.select_square_action?(i+=a.x-a.click_x,s-=a.x-a.click_x):"resize-right"==this.select_square_action?s+=a.x-a.click_x:"resize-top"==this.select_square_action?(r+=a.y-a.click_y,n-=a.y-a.click_y):"resize-bottom"==this.select_square_action?n+=a.y-a.click_y:"resize-1"==this.select_square_action?(i+=a.x-a.click_x,r+=a.y-a.click_y,s-=a.x-a.click_x,n-=a.y-a.click_y):"resize-2"==this.select_square_action?(s+=a.x-a.click_x,r+=a.y-a.click_y,n-=a.y-a.click_y):"resize-3"==this.select_square_action?(s+=a.x-a.click_x,n+=a.y-a.click_y):"resize-4"==this.select_square_action&&(i+=a.x-a.click_x,s-=a.x-a.click_x,n+=a.y-a.click_y);var i=Math.max(i,0),r=Math.max(r,0),s=Math.max(s,0),n=Math.max(n,0);canvas_front.save(),canvas_front.clearRect(0,0,WIDTH,HEIGHT),canvas_front.mozImageSmoothingEnabled=!1,canvas_front.webkitImageSmoothingEnabled=!1,canvas_front.msImageSmoothingEnabled=!1,canvas_front.ImageSmoothingEnabled=!1,canvas_front.drawImage(canvas_active(!0),this.select_data.x,this.select_data.y,this.select_data.w,this.select_data.h,i,r,s,n),canvas_front.restore()}else if("move"==e&&0!=this.select_data){if(1==EVENTS.isDrag)return!0;canvas_front.lineWidth=1,border_size=5,this.select_square_action="";var o=Math.ceil(EVENTS.sr_size/GUI.ZOOM*100);1==this.check_mouse_pos(this.select_data.x,this.select_data.y+this.select_data.h/2,o,a.x,a.y)?(document.body.style.cursor="w-resize",this.select_square_action="resize-left"):1==this.check_mouse_pos(this.select_data.x+this.select_data.w/2,this.select_data.y,o,a.x,a.y)?(document.body.style.cursor="n-resize",this.select_square_action="resize-top"):1==this.check_mouse_pos(this.select_data.x+this.select_data.w-o,this.select_data.y+this.select_data.h/2,o,a.x,a.y)?(document.body.style.cursor="w-resize",this.select_square_action="resize-right"):1==this.check_mouse_pos(this.select_data.x+this.select_data.w/2,this.select_data.y+this.select_data.h-o,o,a.x,a.y)&&(document.body.style.cursor="n-resize",this.select_square_action="resize-bottom"),1==this.check_mouse_pos(this.select_data.x,this.select_data.y,o,a.x,a.y)?(document.body.style.cursor="nw-resize",this.select_square_action="resize-1"):1==this.check_mouse_pos(this.select_data.x+this.select_data.w-o,this.select_data.y,o,a.x,a.y)?(document.body.style.cursor="ne-resize",this.select_square_action="resize-2"):1==this.check_mouse_pos(this.select_data.x+this.select_data.w-o,this.select_data.y+this.select_data.h-o,o,a.x,a.y)?(document.body.style.cursor="nw-resize",this.select_square_action="resize-3"):1==this.check_mouse_pos(this.select_data.x,this.select_data.y+this.select_data.h-o,o,a.x,a.y)&&(document.body.style.cursor="ne-resize",this.select_square_action="resize-4"),""==this.select_square_action&&a.x>this.select_data.x&&a.y>this.select_data.y&&a.x<this.select_data.x+this.select_data.w&&a.y<this.select_data.y+this.select_data.h&&(this.select_square_action="move",document.body.style.cursor="move"),""==this.select_square_action&&1==a.valid&&(document.body.style.cursor="auto")}else if("release"==e){if(a.x<0&&(a.x=0),a.y<0&&(a.y=0),a.x>=WIDTH&&(a.x=WIDTH),a.y>=HEIGHT&&(a.y=HEIGHT),a.click_x>=WIDTH&&(a.click_x=WIDTH),a.click_y>=HEIGHT&&(a.click_y=HEIGHT),""==this.select_square_action)a.x!=a.click_x&&a.y!=a.click_y&&(this.select_data={x:Math.min(a.x,a.click_x),y:Math.min(a.y,a.click_y),w:Math.abs(a.x-a.click_x),h:Math.abs(a.y-a.click_y)});else{if(a.x-a.click_x==0&&a.y-a.click_y==0)return!1;if(EDIT.save_state(),"move"==this.select_square_action)0!=this.select_data&&(select_data_tmp=canvas_active().getImageData(this.select_data.x,this.select_data.y,this.select_data.w,this.select_data.h),canvas_active().clearRect(this.select_data.x,this.select_data.y,this.select_data.w,this.select_data.h),canvas_active().putImageData(select_data_tmp,a.x-a.click_x+this.select_data.x,a.y-a.click_y+this.select_data.y)),this.select_data.x+=a.x-a.click_x,this.select_data.y+=a.y-a.click_y;else{var i=this.select_data.x,r=this.select_data.y,s=this.select_data.w,n=this.select_data.h;"resize-left"==this.select_square_action?(i+=a.x-a.click_x,s-=a.x-a.click_x):"resize-right"==this.select_square_action?s+=a.x-a.click_x:"resize-top"==this.select_square_action?(r+=a.y-a.click_y,n-=a.y-a.click_y):"resize-bottom"==this.select_square_action?n+=a.y-a.click_y:"resize-1"==this.select_square_action?(i+=a.x-a.click_x,r+=a.y-a.click_y,s-=a.x-a.click_x,n-=a.y-a.click_y):"resize-2"==this.select_square_action?(s+=a.x-a.click_x,r+=a.y-a.click_y,n-=a.y-a.click_y):"resize-3"==this.select_square_action?(s+=a.x-a.click_x,n+=a.y-a.click_y):"resize-4"==this.select_square_action&&(i+=a.x-a.click_x,s-=a.x-a.click_x,n+=a.y-a.click_y);var i=Math.max(i,0),r=Math.max(r,0),s=Math.max(s,0),n=Math.max(n,0),l=document.createElement("canvas"),c=l.getContext("2d");l.width=Math.max(s,this.select_data.w),l.height=Math.max(n,this.select_data.h),c.drawImage(canvas_active(!0),this.select_data.x,this.select_data.y,this.select_data.w,this.select_data.h,0,0,this.select_data.w,this.select_data.h),canvas_active().clearRect(i,r,s,n),canvas_active().drawImage(l,0,0,this.select_data.w,this.select_data.h,i,r,s,n),this.select_data.x=i,this.select_data.y=r,this.select_data.w=s,this.select_data.h=n}}GUI.draw_selected_area(),LAYER.update_info_block()}},this.check_mouse_pos=function(e,a,t,i,r){return i>e-Math.round(t)&&i<e+Math.round(t)&&r>a-Math.round(t)&&r<a+Math.round(t)}}function GUI_CLASS(){this.PREVIEW_SIZE={w:148,h:100},this.last_menu="",this.grid_size=[50,50],this.grid=!1,this.TRANSPARENCY=!0,this.ZOOM=100,this.zoom_center=[50,50],this.common_dimensions=[[640,480],[800,600],[1024,768],[1280,720],[1600,1200],[1920,1080],[3840,2160],[7680,4320]];var e;this.draw_helpers=function(){var e="";for(var a in DRAW_TOOLS_CONFIG)e+='<a title="'+DRAW_TOOLS_CONFIG[a].title+'"',e+=' style="background-position: '+DRAW_TOOLS_CONFIG[a].icon[1]+"px "+DRAW_TOOLS_CONFIG[a].icon[2]+'px;"',e+=DRAW_TOOLS_CONFIG[a].name==DRAW.active_tool?' class="active trn"':' class="trn"',e+=" onclick=\"return GUI.action('"+DRAW_TOOLS_CONFIG[a].name+"');\"",e+=' id="'+DRAW_TOOLS_CONFIG[a].name+'"',e+=' href="#"></a>\n';document.getElementById("menu_left_container").innerHTML=e;var e="";for(var a in COLORS_DATA){for(var t in COLORS_DATA[a])e+='<div style="background-color:'+COLORS_DATA[a][t]+';" class="mini-color" onclick="GUI.set_color(this);"></div>\n';e+='<div style="clear:both;"></div>\n'}document.getElementById("all_colors").innerHTML=e},this.autodetect_dimensions=function(){for(var e=document.querySelector("#canvas_wrapper"),a=e.clientWidth,t=e.clientHeight,i=!1,r=this.common_dimensions.length-1;r>=0;r--)if(!(this.common_dimensions[r][0]>a||this.common_dimensions[r][1]>t)){WIDTH=this.common_dimensions[r][0],HEIGHT=this.common_dimensions[r][1],i=!0;break}0==i&&(WIDTH=a-5,HEIGHT=t-10,a<585&&(HEIGHT-=15))},this.draw_background=function(e,a,t,i,r){if(0==this.TRANSPARENCY&&void 0==r)return e.beginPath(),e.rect(0,0,a,t),e.fillStyle="#ffffff",e.fill(),!1;void 0==i&&(i=10);for(var s=!0,n=0;n<a;n+=i){s=n%(2*i)==0;for(var o=0;o<t;o+=i)1==s?(e.fillStyle="#eeeeee",e.fillRect(n,o,i,i),s=!1):s=!0}},this.draw_grid=function(e,a){if(0==this.grid)return document.getElementById("canvas_grid").style.display="none",!1;document.getElementById("canvas_grid").style.display="",canvas_grid.clearRect(0,0,WIDTH,HEIGHT),void 0!=e&&void 0!=a?this.grid_size=[e,a]:(e=this.grid_size[0],a=this.grid_size[1]),e=parseInt(e),a=parseInt(a),e<2&&(e=2),a<2&&(a=2);for(var t=e;t<WIDTH&&0!=e;t+=e)t%(5*e)==0?(canvas_grid.strokeStyle="#222222",canvas_grid.beginPath(),canvas_grid.moveTo(.5+t,0),canvas_grid.lineTo(.5+t,HEIGHT),canvas_grid.stroke()):EL.line_dashed(canvas_grid,t,0,t,HEIGHT,3,"#888888");for(var t=a;t<HEIGHT&&0!=a;t+=a)t%(5*a)==0?(canvas_grid.strokeStyle="#222222",canvas_grid.beginPath(),canvas_grid.moveTo(0,.5+t),canvas_grid.lineTo(WIDTH,.5+t),canvas_grid.stroke()):EL.line_dashed(canvas_grid,0,t,WIDTH,t,3,"#888888")},this.redraw_preview=function(){canvas_preview.beginPath(),canvas_preview.rect(0,0,a.PREVIEW_SIZE.w,a.PREVIEW_SIZE.h),canvas_preview.fillStyle="#ffffff",canvas_preview.fill(),this.draw_background(canvas_preview,a.PREVIEW_SIZE.w,a.PREVIEW_SIZE.h,5),canvas_preview.save(),canvas_preview.scale(a.PREVIEW_SIZE.w/WIDTH,a.PREVIEW_SIZE.h/HEIGHT);for(var e=LAYER.layers.length-1;e>=0;e--)0!=LAYER.layers[e].visible&&canvas_preview.drawImage(document.getElementById(LAYER.layers[e].name),0,0,WIDTH,HEIGHT);canvas_preview.restore();var t=document.querySelector("#canvas_wrapper"),i=t.clientWidth/a.ZOOM*100,r=t.clientHeight/a.ZOOM*100,s=a.PREVIEW_SIZE.w*i/WIDTH,n=a.PREVIEW_SIZE.h*r/HEIGHT;return 1==EVENTS.mouse.valid?(mini_rect_x=a.zoom_center[0]*a.PREVIEW_SIZE.w/100-s*a.zoom_center[0]/100,mini_rect_y=a.zoom_center[1]*a.PREVIEW_SIZE.h/100-n*a.zoom_center[1]/100):(mini_rect_x=a.zoom_center[0]*a.PREVIEW_SIZE.w/100-s/2,mini_rect_y=a.zoom_center[1]*a.PREVIEW_SIZE.h/100-n/2),mini_rect_x=Math.max(0,mini_rect_x),mini_rect_y=Math.max(0,mini_rect_y),s=Math.min(a.PREVIEW_SIZE.w-1,s),n=Math.min(a.PREVIEW_SIZE.h-1,n),mini_rect_x+s>a.PREVIEW_SIZE.w&&(mini_rect_x=a.PREVIEW_SIZE.w-s),mini_rect_y+n>a.PREVIEW_SIZE.h&&(mini_rect_y=a.PREVIEW_SIZE.h-n),(0!=mini_rect_x||0!=mini_rect_y||s!=a.PREVIEW_SIZE.w-1||n!=a.PREVIEW_SIZE.h-1)&&(canvas_preview.lineWidth=1,canvas_preview.beginPath(),canvas_preview.rect(Math.round(mini_rect_x)+.5,Math.round(mini_rect_y)+.5,s,n),canvas_preview.fillStyle="rgba(0, 255, 0, 0.3)",canvas_preview.strokeStyle="#00ff00",canvas_preview.fill(),canvas_preview.stroke(),!0)},this.zoom=function(e,t){if(void 0!=e){if(1==e||e==-1){var i=100;this.ZOOM<=110&&e<0&&(i=10),this.ZOOM<=90&&e>0&&(i=10),this.ZOOM=this.ZOOM+e*i,this.ZOOM>100&&this.ZOOM<200&&(this.ZOOM=100)}else this.ZOOM=parseInt(e);this.ZOOM=Math.max(this.ZOOM,10),a.redraw_preview()}document.getElementById("zoom_nr").innerHTML=this.ZOOM,document.getElementById("zoom_range").value=this.ZOOM,document.getElementById("canvas_back").style.width=Math.round(WIDTH*this.ZOOM/100)+"px",document.getElementById("canvas_back").style.height=Math.round(HEIGHT*this.ZOOM/100)+"px";for(var r in LAYER.layers)document.getElementById(LAYER.layers[r].name).style.width=Math.round(WIDTH*this.ZOOM/100)+"px",document.getElementById(LAYER.layers[r].name).style.height=Math.round(HEIGHT*this.ZOOM/100)+"px";return document.getElementById("canvas_front").style.width=Math.round(WIDTH*this.ZOOM/100)+"px",document.getElementById("canvas_front").style.height=Math.round(HEIGHT*this.ZOOM/100)+"px",document.getElementById("canvas_grid").style.width=Math.round(WIDTH*this.ZOOM/100)+"px",document.getElementById("canvas_grid").style.height=Math.round(HEIGHT*this.ZOOM/100)+"px",100!=this.ZOOM?(document.getElementById("resize-w").style.display="none",document.getElementById("resize-h").style.display="none",document.getElementById("resize-wh").style.display="none"):(document.getElementById("resize-w").style.display="block",document.getElementById("resize-h").style.display="block",document.getElementById("resize-wh").style.display="block"),void 0!=t&&EVENTS.scroll_window(),this.redraw_preview(),!0},this.update_attribute=function(e,t){var i=500;for(var r in this.action_data().attributes)if(r==e.id){if(this.action_data().attributes[r]===!0||this.action_data().attributes[r]===!1){var s;s=0==t,this.action_data().attributes[r]=s,this.show_action_attributes()}else if("object"==typeof this.action_data().attributes[r]){var n=e.options[e.selectedIndex],s=n.getAttribute("data-value"),o=r.replace("_values","");this.action_data().attributes[o]=s}else if("#"==this.action_data().attributes[r][0]){var o=r.replace("_values","");this.action_data().attributes[o]=e.value}else{if(void 0!=t)t>0?0==parseInt(this.action_data().attributes[r])?e.value=1:1==parseInt(this.action_data().attributes[r])?e.value=5:5==parseInt(this.action_data().attributes[r])?e.value=10:e.value=parseInt(this.action_data().attributes[r])+t:t<0&&(1==parseInt(this.action_data().attributes[r])?e.value=0:parseInt(this.action_data().attributes[r])<=5?e.value=1:parseInt(this.action_data().attributes[r])<=10?e.value=5:parseInt(this.action_data().attributes[r])<=20?e.value=10:e.value=parseInt(this.action_data().attributes[r])+t),e.value<0&&(e.value=0),e.value>i&&(e.value=i);else{if(0==e.value.length)return!1;e.value=parseInt(e.value),e.value=Math.abs(e.value),(0==e.value||isNaN(e.value)||s>i)&&(e.value=this.action_data().attributes[r])}"power"==r&&e.value>100&&(e.value=100),this.action_data().attributes[r]=e.value,document.getElementById(r).value=e.value}void 0!=this.action_data().on_update&&DRAW[this.action_data().on_update](e.value)}if("erase"==DRAW.active_tool){var l=(this.action_data().attributes.strict,a.action_data().attributes.circle);0==l?document.getElementById("strict").style.display="none":document.getElementById("strict").style.display="block"}},this.action=function(e){return DRAW[e]("init",{valid:!0}),DRAW.active_tool!=e&&(""!=DRAW.active_tool&&document.getElementById(DRAW.active_tool).classList.remove("active","trn"),DRAW.active_tool=e,document.getElementById(e).classList.add("active","trn"),this.show_action_attributes(),!1)},this.action_data=function(){for(var e in DRAW_TOOLS_CONFIG)if(DRAW_TOOLS_CONFIG[e].name==DRAW.active_tool)return DRAW_TOOLS_CONFIG[e]},this.show_action_attributes=function(){html="";var e=10;for(var t in this.action_data().attributes){var i=t[0].toUpperCase()+t.slice(1);if(i=i.replace("_"," "),void 0==this.action_data().attributes[t+"_values"])if(this.action_data().attributes[t]===!0||this.action_data().attributes[t]===!1)1==this.action_data().attributes[t]?html+='<div onclick="GUI.update_attribute(this, 1)" style="background-color:#5680c1;" class="attribute-area trn" id="'+t+'">'+i+"</div>":html+='<div onclick="GUI.update_attribute(this, 0)" class="attribute-area trn" id="'+t+'">'+i+"</div>";else if("object"==typeof a.action_data().attributes[t]){html+='<select style="font-size:11px;margin-bottom:10px;" onchange="GUI.update_attribute(this);" id="'+t+'">';for(var r in a.action_data().attributes[t]){var s="",n=t.replace("_values","");a.action_data().attributes[n]==a.action_data().attributes[t][r]&&(s='selected="selected"'),html+='<option class="trn" '+s+' name="'+a.action_data().attributes[t][r]+'" data-value="'+a.action_data().attributes[t][r]+'">'+a.action_data().attributes[t][r]+"</option>"}html+="</select>"}else"#"==a.action_data().attributes[t][0]?(html+='<table style="width:100%;">',html+="<tr>",html+='<td style="font-weight:bold;width:45px;">'+i+":</td>",html+='<td><input onchange="GUI.update_attribute(this);" type="color" id="'+t+'" value="'+a.action_data().attributes[t]+'" /></td>',html+="</tr>",html+="</table>"):(html+='<div id="'+t+'_container">',html+='<table style="width:100%;">',html+="<tr>",html+='<td style="font-weight:bold;padding-right:2px;white-space:nowrap;" class="trn">'+i+":</td>",html+='<td><input onKeyUp="GUI.update_attribute(this);" type="number" id="'+t+'" value="'+a.action_data().attributes[t]+'" /></td>',html+="</tr>",html+="</table>",html+='<div style="float:left;width:32px;" onclick="GUI.update_attribute(this, '+e+')" class="attribute-area" id="'+t+'">+</div>',html+='<div style="margin-left:48px;margin-bottom:15px;" onclick="GUI.update_attribute(this, '+-e+')" class="attribute-area" id="'+t+'">-</div>',html+="</div>")}document.getElementById("action_attributes").innerHTML=html,HELP.help_translate(LANG)},this.set_color=function(a){COLOR=1==HELPER.chech_input_color_support("main_color")&&"main_color"==a.id?a.value:HELPER.rgb2hex_all(a.style.backgroundColor),e=COLOR,1==HELPER.chech_input_color_support("main_color")?document.getElementById("main_color").value=COLOR:document.getElementById("main_color_alt").style.backgroundColor=COLOR,document.getElementById("color_hex").value=COLOR;var t=HELPER.hex2rgb(COLOR);document.getElementById("rgb_r").value=t.r,document.getElementById("rgb_g").value=t.g,document.getElementById("rgb_b").value=t.b},this.set_color_manual=function(e){var a=e.target;6==a.value.length&&"#"!=a.value[0]&&(COLOR="#"+a.value,this.sync_colors()),7==a.value.length?(COLOR=a.value,this.sync_colors()):a.value.length>7&&(a.value=COLOR)},this.set_color_rgb=function(e,a){var t=HELPER.hex2rgb(COLOR);if(e.value.length>3)e.value=t[a];else if(e.value.length>0){if(value=e.value,value=parseInt(value),isNaN(value)||value!=e.value||value>255||value<0)return e.value=t[a],!1;COLOR="#"+("000000"+HELPER.rgbToHex(document.getElementById("rgb_r").value,document.getElementById("rgb_g").value,document.getElementById("rgb_b").value)).slice(-6),ALPHA=document.getElementById("rgb_a").value,document.getElementById("rgb_a").value=ALPHA,this.sync_colors()}},this.sync_colors=function(){document.getElementById("color_hex").value=COLOR,1==HELPER.chech_input_color_support("main_color")?document.getElementById("main_color").value=COLOR:document.getElementById("main_color_alt").style.backgroundColor=COLOR;var e=HELPER.hex2rgb(COLOR);document.getElementById("rgb_r").value=e.r,document.getElementById("rgb_g").value=e.g,document.getElementById("rgb_b").value=e.b},this.toggle_color_select=function(){0==POP.active?(POP.add({title:"Color:",function:function(){e=COLOR;var a='<canvas style="position:relative;margin-bottom:5px;" id="c_all" width="300" height="300"></canvas>';return a+="<table>",a+="<tr>",a+="\t<td><b>Luminosity:</b></td>",a+='\t<td><input id="lum_ranger" oninput="GUI.change_lum(this.value);document.getElementById(\'lum_preview\').innerHTML=this.value;" type="range" value="0" min="-255" max="255" step="1"></td>',a+='\t<td style="padding-left:10px;width:30px;" id="lum_preview">0</td>',a+="</tr>",a+="<tr>",a+="\t<td><b>Alpha:</b></td>",a+='\t<td><input oninput="GUI.change_alpha(this.value);document.getElementById(\'alpha_preview\').innerHTML=this.value;" type="range" value="'+ALPHA+'" min="0" max="255" step="1"></td>',a+='\t<td style="padding-left:10px;" id="alpha_preview">'+ALPHA+"</td></tr>",a+="</tr>",a+="</table>"}}),POP.show("Select color",function(e){parseInt(e.param1)},void 0,this.toggle_color_select_onload)):POP.hide()},this.change_lum=function(a){a=parseInt(a);var t=HELPER.hex2rgb(e);t.r+=a,t.g+=a,t.b+=a,t.r<0&&(t.r=0),t.g<0&&(t.g=0),t.b<0&&(t.b=0),t.r>255&&(t.r=255),t.g>255&&(t.g=255),t.b>255&&(t.b=255),COLOR="#"+("000000"+HELPER.rgbToHex(t.r,t.g,t.b)).slice(-6),this.sync_colors()},this.change_alpha=function(e){ALPHA=parseInt(e),document.getElementById("rgb_a").value=ALPHA},this.toggle_color_select_onload=function(){var a=new Image;a.onload=function(){document.getElementById("c_all").getContext("2d").drawImage(a,0,0),document.getElementById("c_all").onmousedown=function(a){a.offsetX?(mouse_x=a.offsetX,mouse_y=a.offsetY):a.layerX&&(mouse_x=a.layerX,mouse_y=a.layerY);var t=document.getElementById("c_all").getContext("2d").getImageData(mouse_x,mouse_y,1,1).data;COLOR="#"+("000000"+HELPER.rgbToHex(t[0],t[1],t[2])).slice(-6),this.sync_colors(),e=COLOR,document.getElementById("lum_ranger").value=0}},a.src="img/colorwheel.png"},this.draw_selected_area=function(e){function t(e,t,i,r){var s=Math.ceil(EVENTS.sr_size/a.ZOOM*100);e=Math.round(e),t=Math.round(t),canvas_front.beginPath(),canvas_front.rect(e+i*Math.round(s),t+r*Math.round(s),s,s),canvas_front.fillStyle="#0000ff",canvas_front.fill()}if(0==DRAW.select_data)return!1;canvas_front.clearRect(0,0,WIDTH,HEIGHT);var i=DRAW.select_data.x,r=DRAW.select_data.y,s=DRAW.select_data.w,n=DRAW.select_data.h;return 100!=this.ZOOM&&(i=Math.round(i),r=Math.round(r),s=Math.round(s),n=Math.round(n)),canvas_front.fillStyle="rgba(0, 255, 0, 0.3)",canvas_front.fillRect(i,r,s,n),this.ZOOM<=100&&(canvas_front.strokeStyle="rgba(0, 255, 0, 1)",canvas_front.lineWidth=1,canvas_front.strokeRect(i+.5,r+.5,s,n)),1==e||(t(i,r,0,0),t(i+s,r,-1,0),t(i,r+n,0,-1),t(i+s,r+n,-1,-1),t(i+s/2,r,0,0),t(i,r+n/2,0,0),t(i+s/2,r+n,0,-1),void t(i+s,r+n/2,-1,0))},this.toggle=function(e){document.querySelector(e).classList.toggle("active")};var a=this;a.init=function(){a.draw_background(canvas_back,WIDTH,HEIGHT),document.getElementById("canvas_preview").width=a.PREVIEW_SIZE.w,document.getElementById("canvas_preview").height=a.PREVIEW_SIZE.h;var e=HELPER.hex2rgb(COLOR);document.getElementById("rgb_r").value=e.r,document.getElementById("rgb_g").value=e.g,document.getElementById("rgb_b").value=e.b,document.getElementById("rgb_a").value=ALPHA,a.redraw_preview(),1==HELPER.chech_input_color_support("main_color")?document.getElementById("main_color").value=COLOR:(document.getElementById("main_color").style.display="none",document.getElementById("main_color_alt").style.display="",document.getElementById("main_color_alt").style.backgroundColor=COLOR),canvas_grid.globalAlpha=.8}}function HELP_CLASS(){this.help_shortcuts=function(){POP.add({title:"D",value:"Dublicate"}),POP.add({title:"Del",value:"Delete selection"}),POP.add({title:"F",value:"Auto adjust colors"}),POP.add({title:"G",value:"Grid on/off"}),POP.add({title:"L",value:"Rotate left"}),POP.add({title:"N",value:"New layer"}),POP.add({title:"O",value:"Open file(s)"}),POP.add({title:"R",value:"Resize"}),POP.add({title:"S",value:"Save"}),POP.add({title:"T",value:"Trim"}),POP.add({title:"-",value:"Zoom out"}),POP.add({title:"+",value:"Zoom in"}),POP.add({title:"CTRL + Z",value:"Undo"}),POP.add({title:"CTRL + A",value:"Select all"}),POP.add({title:"CTRL + V",value:"Paste"}),POP.add({title:"Arrow keys",value:"Move active layer by 10px"}),POP.add({title:"CTRL + Arrow keys",value:"Move active layer by 50px"}),POP.add({title:"SHIFT + Arrow keys",value:"Move active layer by 1px"}),POP.add({title:"Drag & Drop",value:"Imports images"}),POP.show("Keyboard Shortcuts","")},this.help_about=function(){var e="www.viliusl@gmail.com";POP.add({title:"Name:",value:"miniPaint "+VERSION}),POP.add({title:"Description:",value:"Online image editor"}),POP.add({title:"Author:",value:"ViliusL"}),POP.add({title:"Email:",html:'<a href="mailto:'+e+'">'+e+"</a>"}),POP.add({title:"Source:",html:'<a href="https://github.com/viliusle/miniPaint">github.com/viliusle/miniPaint</a>'}),POP.show("About","")},this.help_translate=function(e){void 0!=e&&e!=LANG&&HELPER.setCookie("language",e,30);var a="dict_"+e;void 0!=window[a]||"en"==e?($("body").translate({lang:e,t:window[a]}),LANG=e):console.log("Translate error, can not find dictionary: "+a)}}function MAIN_CLASS(){this.init=function(e){var e=e||{};e.firstLoad&&(e.drawHelpers&&GUI.draw_helpers(),GUI.autodetect_dimensions(),POP.height_mini=Math.round(POP.width_mini*HEIGHT/WIDTH)),EVENTS.autosize=!0,FILE.file_info={general:[],exif:[]},DRAW.select_data=!1,canvas_back=document.getElementById("canvas_back").getContext("2d"),canvas_front=document.getElementById("canvas_front").getContext("2d"),canvas_grid=document.getElementById("canvas_grid").getContext("2d"),canvas_preview=document.getElementById("canvas_preview").getContext("2d"),LAYER.reset_layers(),GUI.init(),EVENTS.bindAllEvents(),CLIPBOARD.init();var a=HELPER.getCookie("language");""!=a&&(LANG=a.replace(/([^a-z]+)/gi,"")),HELP.help_translate(LANG),ddsmoothmenu.init({mainmenuid:MENU_ID||"main_menu",orientation:"h",classname:"ddsmoothmenu",contentsource:"markup"})},this.destroy=function(){EVENTS.unbindAllEvents(),CLIPBOARD.destroy(),LAYER.layers=[],DRAW.active_tool="select_tool",layers_archive=[{},{},{}]}}var ddsmoothmenu={mobilemediaquery:"screen and (max-width: 700px)",arrowimages:{down:["downarrowclass","down.gif",23],right:["rightarrowclass","right.gif",6],left:["leftarrowclass","left.gif"]},transition:{overtime:300,outtime:300},mobiletransition:200,shadow:!1,showhidedelay:{showdelay:100,hidedelay:200},zindexvalue:1e3,closeonnonmenuclick:!0,closeonmouseout:!1,overarrowre:/(?=\.(gif|jpg|jpeg|png|bmp))/i,overarrowaddtofilename:"_over",detecttouch:!!("ontouchstart"in window)||!!("ontouchstart"in document.documentElement)||!!window.ontouchstart||!!window.Touch&&!!window.Touch.length||!!window.onmsgesturechange||window.DocumentTouch&&window.document instanceof window.DocumentTouch,detectwebkit:navigator.userAgent.toLowerCase().indexOf("applewebkit")>-1,detectchrome:navigator.userAgent.toLowerCase().indexOf("chrome")>-1,ismobile:null!=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i),idevice:/ipad|iphone/i.test(navigator.userAgent),detectie6:function(){var e;return(e=/MSIE (\d+)/.exec(navigator.userAgent))&&e[1]<7}(),detectie9:function(){var e;return(e=/MSIE (\d+)/.exec(navigator.userAgent))&&e[1]>8}(),ie9shadow:function(){},css3support:"string"==typeof document.documentElement.style.boxShadow||!document.all&&document.querySelector,prevobjs:[],menus:null,mobilecontainer:{$main:null,$topulsdiv:null,$toggler:null,hidetimer:null},mobilezindexvalue:2e3,executelink:function(e,a,t){for(var i=a.length,r=t.target;--i>-1;)a[i]===this&&(a.splice(i,1),r.href!==ddsmoothmenu.emptyhash&&r.href&&e(r).is("a")&&!e(r).children("span."+ddsmoothmenu.arrowimages.down[0]+", span."+ddsmoothmenu.arrowimages.right[0]).length&&(r.target&&"_self"!==r.target?window.open(r.href,r.target):window.location.href=r.href,t.stopPropagation()))},repositionv:function(e,a,t,i,r,s,n){n=n||0;var o=0,l=i+r;for(e.css({top:t,display:"block"});e.offset().top<r;)e.css({top:++t}),++o;return!o&&a.offset().top+a.outerHeight()<l&&e.data("height")+e.offset().top>l&&e.css({top:r-a.parents("ul").last().offset().top-a.position().top}),"toggle"===s&&e.css({display:"none"}),t!==n&&e.addClass("repositionedv"),[o,t]},updateprev:function(e,a,t){for(var i,r=a.length,s=t.parents().add(this);--r>-1;)s.index(i=a[r])<0&&(e(i).trigger("click",[1]),a.splice(r,1));a.push(this)},subulpreventemptyclose:function(e){var a=e.target;a.href===ddsmoothmenu.emptyhash&&$(a).parent("li").find("ul").length<1&&(e.preventDefault(),e.stopPropagation())},getajaxmenu:function(e,a,t){var i=e("#"+a.contentsource[0]);i.html("Loading Menu..."),e.ajax({url:a.contentsource[1],async:!0,dataType:"html",error:function(e){a.menustate="error",i.html("Error fetching content. Server Response: "+e.responseText)},success:function(r){a.menustate="fetched",i.html(r).find("#"+a.mainmenuid).css("display","block"),!t&&ddsmoothmenu.buildmenu(e,a)}})},getajaxmenuMobile:function(e,a){a.mobilemenustate="fetching",e.ajax({url:a.contentsource[1],async:!0,dataType:"html",error:function(e){a.mobilemenustate="error",alert("Error fetching Ajax content "+e.responseText)},success:function(t){var i=e(t).find(">ul");a.mobilemenustate="fetched",ddsmoothmenu.buildmobilemenu(e,a,i)}})},closeall:function(e){var a,t=ddsmoothmenu;if(t.globaltrackopen&&("mouseleave"===e.type||("click"===e.type||"touchstart"===e.type)&&t.menus.index(e.target)<0))for(a=t.prevobjs.length;--a>-1;)$(t.prevobjs[a]).trigger("click"),t.prevobjs.splice(a,1)},emptyhash:$('<a href="#"></a>').get(0).href,togglemobile:function(e,a){if(this.mobilecontainer.$main){clearTimeout(this.mobilecontainer.hidetimer);var t=this.mobilecontainer.$main,a=a||this.mobiletransition;return"hidden"!=t.css("visibility")||e&&"open"!=e?"visible"!=t.css("visibility")||e&&"open"==e||(t.animate({left:"-100%"},a,function(){this.style.visibility="hidden"}),this.mobilecontainer.$toggler.removeClass("open")):(t.css({left:"-100%",visibility:"visible"}).animate({left:0},a),this.mobilecontainer.$toggler.addClass("open")),!1}},buildmobilemenu:function(e,a,t){function i(e,a,t,i){for(var t=t||function(){},i=i||function(){},r=e.find("ul").parent(),s=a?e.clone():e,n=jQuery(document.createDocumentFragment()),r=s.find("ul").parent(),o=r.length-1;o>=0;o--){var l=r.eq(o),c=l.find(">ul").prependTo(n);t(o,l,c)}return s.prependTo(n),i(s),n}var r=(e("#"+a.mainmenuid),t),s=null,n=i(r,!1,function(a,t,i){i.addClass("submenu");var r=e('<li class="breadcrumb" />').html('<img src="'+ddsmoothmenu.arrowimages.left[1]+'" class="'+ddsmoothmenu.arrowimages.left[0]+'" />'+t.text()).prependTo(i);
t.find("a:eq(0)").append('<img src="'+ddsmoothmenu.arrowimages.right[1]+'" class="'+ddsmoothmenu.arrowimages.right[0]+'" />'),t.on("click",function(a){var t=e(this).parent("ul");t=t.hasClass("submenu")?t:t.parent(),t.css({zIndex:ddsmoothmenu.mobilezindexvalue++,left:0}).animate({left:"-100%"},ddsmoothmenu.mobiletransition),i.css({zIndex:ddsmoothmenu.mobilezindexvalue++,left:"100%"}).animate({left:0},ddsmoothmenu.mobiletransition),a.stopPropagation(),a.preventDefault()}),r.on("click",function(e){var a=t.parent("ul");a=a.hasClass("submenu")?a:a.parent(),a.css({zIndex:ddsmoothmenu.mobilezindexvalue++,left:"-100%"}).animate({left:0},ddsmoothmenu.mobiletransition),i.css({zIndex:ddsmoothmenu.mobilezindexvalue++,left:0}).animate({left:"100%"},ddsmoothmenu.mobiletransition),e.stopPropagation(),e.preventDefault()})},function(e){s=e});if(this.mobilecontainer.$main)var o=this.mobilecontainer.$main,l=this.mobilecontainer.$topulsdiv;else{var o=e('<div class="ddsmoothmobile"><div class="topulsdiv"></div></div>').appendTo(document.body);o.css({zIndex:this.mobilezindexvalue++,left:"-100%",visibility:"hidden"}).on("click",function(e){ddsmoothmenu.mobilecontainer.hidetimer=setTimeout(function(){ddsmoothmenu.togglemobile("close",0)},50),e.stopPropagation()}).on("touchstart",function(e){e.stopPropagation()});var l=o.find("div.topulsdiv"),c=e("#ddsmoothmenu-mobiletoggle").css({display:"block"});c.on("click",function(e){ddsmoothmenu.togglemobile(),e.stopPropagation()}).on("touchstart",function(e){e.stopPropagation()});var d=/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?"touchstart":"click";e(document.body).on(d,function(e){o.is(":animated")||ddsmoothmenu.togglemobile("close",0)}),this.mobilecontainer.$main=o,this.mobilecontainer.$topulsdiv=l,this.mobilecontainer.$toggler=c}l.append(s).css({zIndex:this.mobilezindexvalue++}),o.append(n),a.mobilemenustate="done"},buildmenu:function(e,a){var t=this.detecttouch&&!this.detectchrome||this.detectchrome&&this.ismobile,i=ddsmoothmenu;i.globaltrackopen=i.closeonnonmenuclick||i.closeonmouseout;var r=0,s=i.globaltrackopen?i.prevobjs:[],n=e("#"+a.mainmenuid).removeClass("ddsmoothmenu ddsmoothmenu-v").addClass(a.classname||"ddsmoothmenu");a.repositionv=a.repositionv!==!1;var o=n.find(">ul"),l=t?"toggle":"toggle"===a.method?"toggle":"hover",c=o.find(">li>ul").parent(),d="v"!=a.orientation?"down":"right",u=e(document.body);if(o.click(function(e){e.target.href===i.emptyhash&&e.preventDefault()}),"toggle"===l){if(i.globaltrackopen&&(i.menus=i.menus?i.menus.add(o.add(o.find("*"))):o.add(o.find("*"))),i.closeonnonmenuclick?("down"===d&&n.click(function(e){e.stopPropagation()}),e(document).unbind("click.smoothmenu").bind("click.smoothmenu",i.closeall),i.idevice&&(document.removeEventListener("touchstart",i.closeall,!1),document.addEventListener("touchstart",i.closeall,!1))):a.closeonnonmenuclick&&("down"===d&&n.click(function(e){e.stopPropagation()}),e(document).bind("click."+a.mainmenuid,function(e){o.find("li>a.selected").parent().trigger("click")}),i.idevice&&document.addEventListener("touchstart",function(e){o.find("li>a.selected").parent().trigger("click")},!1)),i.closeonmouseout){var h="down"===d?n:o;h.bind("mouseleave.smoothmenu",i.closeall)}else if(a.closeonmouseout){var h="down"===d?n:o;h.bind("mouseleave.smoothmenu",function(){o.find("li>a.selected").parent().trigger("click")})}e('style[title="ddsmoothmenushadowsnone"]').length||e("head").append('<style title="ddsmoothmenushadowsnone" type="text/css">.ddsmoothmenushadowsnone{display:none!important;}</style>');var m;e(window).bind("resize scroll",function(){clearTimeout(m);var t=o.find("li>a.selected").parent(),i=e(".ddshadow").addClass("ddsmoothmenushadowsnone");t.eq(0).trigger("click"),t.trigger("click"),(!window.matchMedia||window.matchMedia&&!a.mobilemql.matches)&&(m=setTimeout(function(){i.removeClass("ddsmoothmenushadowsnone")},100))})}c.each(function(){function t(){c.removeClass("selected")}var n=e(this).css({zIndex:(a.zindexvalue||i.zindexvalue)+r--}),o=n.children("ul:eq(0)").css({display:"block"}).data("timers",{}),c=n.children("a:eq(0)").css({paddingRight:i.arrowimages[d][2]}).append('<span style="display: block;" class="'+i.arrowimages[d][0]+'"></span>'),h={w:c.outerWidth(),h:n.innerHeight(),subulw:o.outerWidth(),subulh:o.outerHeight()},m="down"===d?h.h:0;o.css({top:m}),"toggle"===l&&o.click(i.subulpreventemptyclose),n[l](function(t){n.data("headers")||(i.buildsubheaders(e,o,o.find(">li>ul").parent(),a,l,s),n.data("headers",!0).find(">ul").each(function(a,t){var i=e(t);i.data("height",i.outerHeight())}).css({display:"none",visibility:"visible"})),"toggle"===l&&i.updateprev.call(this,e,s,n),clearTimeout(o.data("timers").hidetimer),c.addClass("selected"),o.data("timers").showtimer=setTimeout(function(){var t,r,s,v="down"===d?0:h.w,g=v,p=0,_=n.offset().left;if(v=_+v+h.subulw>e(window).width()?"down"===d?-h.subulw+h.w:-h.w:v,"right"===d&&v<0){window.pageXOffset||(document.documentElement||document.body.parentNode||document.body).scrollLeft;_-h.subulw<0&&(v=0)}if(g=g!==v,o.css({top:m}).removeClass("repositionedv"),a.repositionv&&c.offset().top+m+o.data("height")>(s=e(window).height())+(r=e(document).scrollTop())&&(t=("down"===d?0:c.outerHeight())-o.data("height"),p=i.repositionv(o,c,t,s,r,l,m)[0]),o.css({left:v,width:h.subulw}).stop(!0,!0).animate({height:"show",opacity:"show"},i.transition.overtime,function(){this.style.removeAttribute&&this.style.removeAttribute("filter")}),g?o.addClass("repositioned"):o.removeClass("repositioned"),a.shadow){n.data("$shadow")||n.data("$shadow",e("<div></div>").addClass("ddshadow toplevelshadow").prependTo(u).css({zIndex:n.css("zIndex")})),i.ie9shadow(n.data("$shadow"));var f=o.offset(),I=f.left,y=f.top;n.data("$shadow").css({overflow:"visible",width:h.subulw,left:I,top:y}).stop(!0,!0).animate({height:h.subulh},i.transition.overtime)}},i.showhidedelay.showdelay)},function(a,r){var c=n.data("$shadow");"hover"===l?t():i.executelink.call(this,e,s,a),clearTimeout(o.data("timers").showtimer),o.data("timers").hidetimer=setTimeout(function(){o.stop(!0,!0).animate({height:"hide",opacity:"hide"},r||i.transition.outtime,function(){"toggle"===l&&t()}),c&&(!i.css3support&&i.detectwebkit&&c.children("div:eq(0)").css({opacity:0}),c.stop(!0,!0).animate({height:0},r||i.transition.outtime,function(){"toggle"===l&&(this.style.overflow="hidden")}))},i.showhidedelay.hidedelay)}),o.css({display:"none"})})},buildsubheaders:function(e,a,t,i,r,s){a.css("display","block"),t.each(function(){function a(){c.removeClass("selected")}var t,n=ddsmoothmenu,o=e(this).css({zIndex:e(this).parent("ul").css("z-index")}),l=o.children("ul:eq(0)").css({display:"block"}).data("timers",{});"toggle"===r&&l.click(n.subulpreventemptyclose);var c=o.children("a:eq(0)").append('<span style="display: block;" class="'+n.arrowimages.right[0]+'"></span>'),d={w:c.outerWidth(),subulw:l.outerWidth(),subulh:l.outerHeight()};l.css({top:0}),o[r](function(a){o.data("headers")||(n.buildsubheaders(e,l,l.find(">li>ul").parent(),i,r,s),o.data("headers",!0).find(">ul").each(function(a,t){var i=e(t);i.data("height",i.height())}).css({display:"none",visibility:"visible"})),"toggle"===r&&n.updateprev.call(this,e,s,o),clearTimeout(l.data("timers").hidetimer),c.addClass("selected"),l.data("timers").showtimer=setTimeout(function(){var a,s,u,h=d.w,m=h,v=0,g=o.offset().left;if(h=g+h+d.subulw>e(window).width()?-d.w:h,h<0){var p=window.pageXOffset||(document.documentElement||document.body.parentNode||document.body).scrollLeft;g-d.subulw<p&&(h=0)}if(m=m!==h,l.css({top:0}).removeClass("repositionedv"),i.repositionv&&c.offset().top+l.data("height")>(u=e(window).height())+(s=e(document).scrollTop())&&(a=c.outerHeight()-l.data("height"),v=n.repositionv(l,c,a,u,s,r),a=v[1],v=v[0]),l.css({left:h,width:d.subulw}).stop(!0,!0).animate({height:"show",opacity:"show"},n.transition.overtime,function(){this.style.removeAttribute&&this.style.removeAttribute("filter")}),m?l.addClass("repositioned"):l.removeClass("repositioned"),i.shadow){o.data("$shadow")||(t=o.parents("li:eq(0)").data("$shadow"),o.data("$shadow",e("<div></div>").addClass("ddshadow").prependTo(t).css({zIndex:t.css("z-index")})));var _=(l.offset(),h),f=o.position().top-(a?l.data("height")-c.outerHeight()-v:0);n.detectwebkit&&!n.css3support&&o.data("$shadow").css({opacity:1}),o.data("$shadow").css({overflow:"visible",width:d.subulw,left:_,top:f}).stop(!0,!0).animate({height:d.subulh},n.transition.overtime)}},n.showhidedelay.showdelay)},function(t,i){var c=o.data("$shadow");"hover"===r?a():n.executelink.call(this,e,s,t),clearTimeout(l.data("timers").showtimer),l.data("timers").hidetimer=setTimeout(function(){l.stop(!0,!0).animate({height:"hide",opacity:"hide"},i||n.transition.outtime,function(){"toggle"===r&&a()}),c&&(!n.css3support&&n.detectwebkit&&c.children("div:eq(0)").css({opacity:0}),c.stop(!0,!0).animate({height:0},i||n.transition.outtime,function(){"toggle"===r&&(this.style.overflow="hidden")}))},n.showhidedelay.hidedelay)})})},initmenu:function(e){function a(){if(!l){if("object"==typeof e.customtheme&&2==e.customtheme.length){var a="v"==e.orientation?n:n+", "+n;o.push([a," ul li a {background:",e.customtheme[0],";}\n",n," ul li a:hover {background:",e.customtheme[1],";}"].join(""))}o.push('\n<style type="text/css">'),o.reverse(),jQuery("head").append(o.join("\n"))}}if(e.mobilemql.matches)return void jQuery(function(a){var t=a("#"+e.mainmenuid);t.css({display:"none"}),e.$mainulclone||(e.$mainulclone=t.find(">ul").clone());var i=e.mobilemenustate;"markup"!=e.contentsource||i?"markup"==e.contentsource||i&&"error"!=i?a("#ddsmoothmenu-mobiletoggle").css({display:"block"}):ddsmoothmenu.getajaxmenuMobile(a,e):ddsmoothmenu.buildmobilemenu(a,e,e.$mainulclone)});var t=e.menustate;if(t&&"error"!=t){var i=$("#"+e.mainmenuid);return i.css({display:"block"}),this.mobilecontainer.$main&&this.togglemobile("close",0),void $("#ddsmoothmenu-mobiletoggle").css({display:"none"})}if(this.detectie6&&parseFloat(jQuery.fn.jquery)>1.3)return this.initmenu=function(e){return"object"==typeof e.contentsource&&jQuery(function(a){ddsmoothmenu.getajaxmenu(a,e,"nobuild")}),!1},jQuery('link[href*="ddsmoothmenu"]').attr("disabled",!0),jQuery(function(e){alert("You Seriously Need to Update Your Browser!\n\nDynamic Drive Smooth Navigational Menu Showing Text Only Menu(s)\n\nDEVELOPER's NOTE: This script will run in IE 6 when using jQuery 1.3.2 or less,\nbut not real well."),e('link[href*="ddsmoothmenu"]').attr("disabled",!0)}),this.initmenu(e);var r,s,n="#"+e.mainmenuid,o=["</style>\n"],l=e.arrowswap?4:2;e.arrowswap&&(r=ddsmoothmenu.arrowimages.right[1].replace(ddsmoothmenu.overarrowre,ddsmoothmenu.overarrowaddtofilename),s=ddsmoothmenu.arrowimages.down[1].replace(ddsmoothmenu.overarrowre,ddsmoothmenu.overarrowaddtofilename),jQuery(new Image).bind("load error",function(t){e.rightswap="load"===t.type,e.rightswap&&o.push([n," ul li a:hover .",ddsmoothmenu.arrowimages.right[0],", ",n," ul li a.selected .",ddsmoothmenu.arrowimages.right[0]," { background-image: url(",this.src,");}"].join("")),--l,a()}).attr("src",r),jQuery(new Image).bind("load error",function(t){e.downswap="load"===t.type,e.downswap&&o.push([n," ul li a:hover .",ddsmoothmenu.arrowimages.down[0],", ",n," ul li a.selected .",ddsmoothmenu.arrowimages.down[0]," { background-image: url(",this.src,");}"].join("")),--l,a()}).attr("src",s)),jQuery(new Image).bind("load error",function(e){"load"===e.type&&o.push([n+" ul li a .",ddsmoothmenu.arrowimages.right[0]," { background: url(",this.src,") no-repeat;width:",this.width,"px;height:",this.height,"px;}"].join("")),--l,a()}).attr("src",ddsmoothmenu.arrowimages.right[1]),jQuery(new Image).bind("load error",function(e){"load"===e.type&&o.push([n+" ul li a .",ddsmoothmenu.arrowimages.down[0]," { background: url(",this.src,") no-repeat;width:",this.width,"px;height:",this.height,"px;}"].join("")),--l,a()}).attr("src",ddsmoothmenu.arrowimages.down[1]),e.shadow=(!this.detectie6||"hover"!==e.method&&"v"!==e.orientation)&&(e.shadow||this.shadow),jQuery(document).ready(function(a){var t=a("#"+e.mainmenuid);t.css({display:"block"}),ddsmoothmenu.mobilecontainer.$main&&ddsmoothmenu.togglemobile("close",0),a("#ddsmoothmenu-mobiletoggle").css({display:"none"}),e.$mainulclone||(e.$mainulclone=t.find(">ul").clone()),e.shadow&&ddsmoothmenu.css3support&&a("body").addClass("ddcss3support"),"object"==typeof e.contentsource?ddsmoothmenu.getajaxmenu(a,e):ddsmoothmenu.buildmenu(a,e),e.menustate="initialized"})},init:function(e){e.mobilemql=window.matchMedia?window.matchMedia(this.mobilemediaquery):{matches:!1,addListener:function(){}},this.initmenu(e),e.mobilemql.addListener(function(){ddsmoothmenu.initmenu(e)})}};(function(e){var a=!1;try{e('<a href="#"></a>').toggle(function(){},function(){a=!0}).trigger("click").trigger("click")}catch(e){}return!a})(jQuery)&&!function(){var e=jQuery.fn.toggle;jQuery.extend(jQuery.fn,{toggle:function(a,t){if(!jQuery.isFunction(a)||!jQuery.isFunction(t))return e.apply(this,arguments);var i=arguments,r=a.guid||jQuery.guid++,s=0,n=function(e){var t=(jQuery._data(this,"lastToggle"+a.guid)||0)%s;return jQuery._data(this,"lastToggle"+a.guid,t+1),e.preventDefault(),i[t].apply(this,arguments)||!1};for(n.guid=r;s<i.length;)i[s++].guid=r;return this.click(n)}})}(),ddsmoothmenu.detectie9&&!function(e){function a(e,a){return parseInt(e)+a+"px"}ddsmoothmenu.ie9shadow=function(t){var i=document.defaultView.getComputedStyle(t.get(0),null),r=i.getPropertyValue("box-shadow").split(" "),s={top:i.getPropertyValue("margin-top"),left:i.getPropertyValue("margin-left")};e("head").append(['\n<style title="ie9shadow" type="text/css">',".ddcss3support .ddshadow {","\tbox-shadow: "+a(r[0],1)+" "+a(r[1],1)+" "+r[2]+" "+r[3]+";","}",".ddcss3support .ddshadow.toplevelshadow {","\topacity: "+(e(".ddcss3support .ddshadow").css("opacity")-.1)+";","\tmargin-top: "+a(s.top,-1)+";","\tmargin-left: "+a(s.left,-1)+";","}","</style>\n"].join("\n")),ddsmoothmenu.ie9shadow=function(){}};var t=e.fn.height,i=e.fn.width;e.extend(e.fn,{height:function(){var e=this.get(0);return this.length<1||arguments.length||e===window||e===document?t.apply(this,arguments):parseFloat(document.defaultView.getComputedStyle(e,null).getPropertyValue("height"))},innerHeight:function(){if(this.length<1)return null;var e=this.height(),a=this.get(0),t=document.defaultView.getComputedStyle(a,null);return e+=parseInt(t.getPropertyValue("padding-top")),e+=parseInt(t.getPropertyValue("padding-bottom"))},outerHeight:function(e){if(this.length<1)return null;var a=this.innerHeight(),t=this.get(0),i=document.defaultView.getComputedStyle(t,null);return a+=parseInt(i.getPropertyValue("border-top-width")),a+=parseInt(i.getPropertyValue("border-bottom-width")),e&&(a+=parseInt(i.getPropertyValue("margin-top")),a+=parseInt(i.getPropertyValue("margin-bottom"))),a},width:function(){var e=this.get(0);return this.length<1||arguments.length||e===window||e===document?i.apply(this,arguments):parseFloat(document.defaultView.getComputedStyle(e,null).getPropertyValue("width"))},innerWidth:function(){if(this.length<1)return null;var e=this.width(),a=this.get(0),t=document.defaultView.getComputedStyle(a,null);return e+=parseInt(t.getPropertyValue("padding-right")),e+=parseInt(t.getPropertyValue("padding-left"))},outerWidth:function(e){if(this.length<1)return null;var a=this.innerWidth(),t=this.get(0),i=document.defaultView.getComputedStyle(t,null);return a+=parseInt(i.getPropertyValue("border-right-width")),a+=parseInt(i.getPropertyValue("border-left-width")),e&&(a+=parseInt(i.getPropertyValue("margin-right")),a+=parseInt(i.getPropertyValue("margin-left"))),a}})}(jQuery);var ImageFilters={};ImageFilters.utils={initSampleCanvas:function(){var e=document.createElement("canvas"),a=e.getContext("2d");e.width=0,e.height=0,this.getSampleCanvas=function(){return e},this.getSampleContext=function(){return a},this.createImageData=a.createImageData?function(e,t){return a.createImageData(e,t)}:function(e,a){return new ImageData(e,a)}},getSampleCanvas:function(){return this.initSampleCanvas(),this.getSampleCanvas()},getSampleContext:function(){return this.initSampleCanvas(),this.getSampleContext()},createImageData:function(e,a){return this.initSampleCanvas(),this.createImageData(e,a)},clamp:function(e){return e>255?255:0>e?0:e},buildMap:function(e){for(var a,t=[],i=0;256>i;i+=1)t[i]=(a=e(i))>255?255:0>a?0:0|a;return t},applyMap:function(e,a,t){for(var i=0,r=e.length;r>i;i+=4)a[i]=t[e[i]],a[i+1]=t[e[i+1]],a[i+2]=t[e[i+2]],a[i+3]=e[i+3]},mapRGB:function(e,a,t){this.applyMap(e,a,this.buildMap(t))},getPixelIndex:function(e,a,t,i,r){if(0>e||e>=t||0>a||a>=i)switch(r){case 1:e=0>e?0:e>=t?t-1:e,a=0>a?0:a>=i?i-1:a;break;case 2:e=(e%=t)<0?e+t:e,a=(a%=i)<0?a+i:a;break;default:return null}return a*t+e<<2},getPixel:function(e,a,t,i,r,s){if(0>a||a>=i||0>t||t>=r)switch(s){case 1:a=0>a?0:a>=i?i-1:a,t=0>t?0:t>=r?r-1:t;break;case 2:a=(a%=i)<0?a+i:a,t=(t%=r)<0?t+r:t;break;default:return 0}var n=t*i+a<<2;return e[n+3]<<24|e[n]<<16|e[n+1]<<8|e[n+2]},getPixelByIndex:function(e,a){return e[a+3]<<24|e[a]<<16|e[a+1]<<8|e[a+2]},copyBilinear:function(e,a,t,i,r,s,n,o){var l,c,d,u,h,m,v,g=0>a?a-1|0:0|a,p=0>t?t-1|0:0|t,_=a-g,f=t-p,I=0,y=0,b=0,E=0;if(g>=0&&i-1>g&&p>=0&&r-1>p){if(l=p*i+g<<2,!_&&!f)return s[n]=e[l],s[n+1]=e[l+1],s[n+2]=e[l+2],void(s[n+3]=e[l+3]);I=e[l+3]<<24|e[l]<<16|e[l+1]<<8|e[l+2],l+=4,y=e[l+3]<<24|e[l]<<16|e[l+1]<<8|e[l+2],l=l-8+(i<<2),b=e[l+3]<<24|e[l]<<16|e[l+1]<<8|e[l+2],l+=4,E=e[l+3]<<24|e[l]<<16|e[l+1]<<8|e[l+2]}else{if(I=this.getPixel(e,g,p,i,r,o),!_&&!f)return s[n]=I>>16&255,s[n+1]=I>>8&255,s[n+2]=255&I,void(s[n+3]=I>>24&255);y=this.getPixel(e,g+1,p,i,r,o),b=this.getPixel(e,g,p+1,i,r,o),E=this.getPixel(e,g+1,p+1,i,r,o)}c=1-_,d=1-f,u=((I>>16&255)*c+(y>>16&255)*_)*d+((b>>16&255)*c+(E>>16&255)*_)*f,h=((I>>8&255)*c+(y>>8&255)*_)*d+((b>>8&255)*c+(E>>8&255)*_)*f,m=((255&I)*c+(255&y)*_)*d+((255&b)*c+(255&E)*_)*f,v=((I>>24&255)*c+(y>>24&255)*_)*d+((b>>24&255)*c+(E>>24&255)*_)*f,s[n]=u>255?255:0>u?0:0|u,s[n+1]=h>255?255:0>h?0:0|h,s[n+2]=m>255?255:0>m?0:0|m,s[n+3]=v>255?255:0>v?0:0|v},rgbToHsl:function(e,a,t){e/=255,a/=255,t/=255;var i=e>a?e>t?e:t:a>t?a:t,r=a>e?t>e?e:t:t>a?a:t,s=i-r,n=0,o=0,l=(r+i)/2;return 0!==s&&(n=e===i?(a-t)/s+(t>a?6:0):a===i?(t-e)/s+2:(e-a)/s+4,n/=6,o=l>.5?s/(2-i-r):s/(i+r)),[n,o,l]},hslToRgb:function(e,a,t){var i,r,s,n,o,l,c=[];if(0===a)n=o=l=255*t+.5|0,c=[n,o,l];else{r=.5>=t?t*(a+1):t+a-t*a,i=2*t-r,s=e+1/3;for(var d,u=0;3>u;u+=1)0>s?s+=1:s>1&&(s-=1),d=1>6*s?i+(r-i)*s*6:1>2*s?r:2>3*s?i+(r-i)*(2/3-s)*6:i,c[u]=255*d+.5|0,s-=1/3}return c}},ImageFilters.Translate=function(e,a,t,i){},ImageFilters.Scale=function(e,a,t,i){},ImageFilters.Rotate=function(e,a,t,i,r,s){},ImageFilters.Affine=function(e,a,t,i){},ImageFilters.UnsharpMask=function(e,a){},ImageFilters.ConvolutionFilter=function(e,a,t,i,r,s,n,o,l,c){var d=e.data,u=e.width,h=e.height,m=(d.length,this.utils.createImageData(u,h)),v=m.data;r=r||1,s=s||0,n!==!1&&(n=!0),o!==!1&&(o=!0),l=l||0,c=c||0;for(var g=0,p=a>>1,_=t>>1,f=l>>16&255,I=l>>8&255,y=255&l,b=255*c,E=0;h>E;E+=1)for(var T=0;u>T;T+=1,g+=4){for(var k,H=0,P=0,w=0,D=0,x=!1,S=0,R=-p;p>=R;R+=1){var z,A=E+R;A>=0&&h>A?z=A*u:o?z=E*u:x=!0;for(var G=-_;_>=G;G+=1){var L=i[S++];if(0!==L){var O=T+G;if(O>=0&&u>O||(o?O=T:x=!0),x)H+=L*f,P+=L*I,w+=L*y,D+=L*b;else{var C=z+O<<2;H+=L*d[C],P+=L*d[C+1],w+=L*d[C+2],D+=L*d[C+3]}}}}v[g]=(k=H/r+s)>255?255:0>k?0:0|k,v[g+1]=(k=P/r+s)>255?255:0>k?0:0|k,v[g+2]=(k=w/r+s)>255?255:0>k?0:0|k,v[g+3]=n?d[g+3]:(k=D/r+s)>255?255:0>k?0:0|k}return m},ImageFilters.Binarize=function(e,a){var t=e.data,i=e.width,r=e.height,s=t.length,n=this.utils.createImageData(i,r),o=n.data;isNaN(a)&&(a=.5),a*=255;for(var l=0;s>l;l+=4){var c=t[l]+t[l+1]+t[l+2]/3;o[l]=o[l+1]=o[l+2]=a>=c?0:255,o[l+3]=255}return n},ImageFilters.BlendAdd=function(e,a,t,i){for(var r,s=e.data,n=e.width,o=e.height,l=s.length,c=this.utils.createImageData(n,o),d=c.data,u=a.data,h=0;l>h;h+=4)d[h]=(r=s[h]+u[h])>255?255:r,d[h+1]=(r=s[h+1]+u[h+1])>255?255:r,d[h+2]=(r=s[h+2]+u[h+2])>255?255:r,d[h+3]=255;return c},ImageFilters.BlendSubtract=function(e,a,t,i){for(var r,s=e.data,n=e.width,o=e.height,l=s.length,c=this.utils.createImageData(n,o),d=c.data,u=a.data,h=0;l>h;h+=4)d[h]=(r=s[h]-u[h])<0?0:r,d[h+1]=(r=s[h+1]-u[h+1])<0?0:r,d[h+2]=(r=s[h+2]-u[h+2])<0?0:r,d[h+3]=255;return c},ImageFilters.BoxBlur=function(){var e=function(e,a,t,i,r){var s,n,o,l,c,d,u,h,m,v,g,p,_,f,I=2*r+1,y=r+1,b=t-1,E=0,T=[];for(m=0,v=256*I;v>m;m+=1)T[m]=m/I|0;for(p=0;i>p;p+=1){for(s=n=o=l=0,c=p,d=E<<2,s+=y*e[d],n+=y*e[d+1],o+=y*e[d+2],l+=y*e[d+3],m=1;r>=m;m+=1)d=E+(t>m?m:b)<<2,s+=e[d],n+=e[d+1],o+=e[d+2],l+=e[d+3];for(g=0;t>g;g+=1)d=c<<2,a[d]=T[s],a[d+1]=T[n],a[d+2]=T[o],a[d+3]=T[l],_=g+y,_>b&&(_=b),f=g-r,0>f&&(f=0),u=E+_<<2,h=E+f<<2,s+=e[u]-e[h],n+=e[u+1]-e[h+1],o+=e[u+2]-e[h+2],l+=e[u+3]-e[h+3],c+=i;E+=t}};return function(a,t,i,r){for(var s=a.data,n=a.width,o=a.height,l=(s.length,this.utils.createImageData(n,o)),c=l.data,d=this.utils.createImageData(n,o),u=d.data,h=0;r>h;h+=1)e(h?c:s,u,n,o,t),e(u,c,o,n,i);return l}}(),ImageFilters.GaussianBlur=function(e,a){var t,i,r;switch(a){case 2:t=5,i=[1,1,2,1,1,1,2,4,2,1,2,4,8,4,2,1,2,4,2,1,1,1,2,1,1],r=52;break;case 3:t=7,i=[1,1,2,2,2,1,1,1,2,2,4,2,2,1,2,2,4,8,4,2,2,2,4,8,16,8,4,2,2,2,4,8,4,2,2,1,2,2,4,2,2,1,1,1,2,2,2,1,1],r=140;break;case 4:t=15,i=[2,2,3,4,5,5,6,6,6,5,5,4,3,2,2,2,3,4,5,7,7,8,8,8,7,7,5,4,3,2,3,4,6,7,9,10,10,11,10,10,9,7,6,4,3,4,5,7,9,10,12,13,13,13,12,10,9,7,5,4,5,7,9,11,13,14,15,16,15,14,13,11,9,7,5,5,7,10,12,14,16,17,18,17,16,14,12,10,7,5,6,8,10,13,15,17,19,19,19,17,15,13,10,8,6,6,8,11,13,16,18,19,20,19,18,16,13,11,8,6,6,8,10,13,15,17,19,19,19,17,15,13,10,8,6,5,7,10,12,14,16,17,18,17,16,14,12,10,7,5,5,7,9,11,13,14,15,16,15,14,13,11,9,7,5,4,5,7,9,10,12,13,13,13,12,10,9,7,5,4,3,4,6,7,9,10,10,11,10,10,9,7,6,4,3,2,3,4,5,7,7,8,8,8,7,7,5,4,3,2,2,2,3,4,5,5,6,6,6,5,5,4,3,2,2],r=2044;break;default:t=3,i=[1,2,1,2,4,2,1,2,1],r=16}return this.ConvolutionFilter(e,t,t,i,r,0,!1)},ImageFilters.StackBlur=function(){function e(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var a=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],t=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];return function(i,r){var s,n,o,l,c,d,u,h,m,v,g,p,_,f,I,y,b,E,T,k,H,P,w,D,x,S,R,z=i.data,A=i.width,G=i.height,L=(z.length,this.Clone(i)),O=L.data,C=r+r+1,M=A-1,W=G-1,B=r+1,N=B*(B+1)/2,F=new e,V=F,Y=a[r],U=t[r];for(o=1;C>o;o+=1)V=V.next=new e,o==B&&(R=V);for(V.next=F,u=d=0,n=0;G>n;n+=1){for(y=b=E=T=h=m=v=g=0,p=B*(k=O[d]),_=B*(H=O[d+1]),f=B*(P=O[d+2]),I=B*(w=O[d+3]),h+=N*k,m+=N*H,v+=N*P,g+=N*w,V=F,o=0;B>o;o+=1)V.r=k,V.g=H,V.b=P,V.a=w,V=V.next;for(o=1;B>o;o+=1)l=d+((o>M?M:o)<<2),h+=(V.r=k=O[l])*(D=B-o),m+=(V.g=H=O[l+1])*D,v+=(V.b=P=O[l+2])*D,g+=(V.a=w=O[l+3])*D,y+=k,b+=H,E+=P,T+=w,V=V.next;for(x=F,S=R,s=0;A>s;s+=1)O[d]=h*Y>>U,O[d+1]=m*Y>>U,O[d+2]=v*Y>>U,O[d+3]=g*Y>>U,h-=p,m-=_,v-=f,g-=I,p-=x.r,_-=x.g,f-=x.b,I-=x.a,l=u+((l=s+r+1)<M?l:M)<<2,y+=x.r=O[l],b+=x.g=O[l+1],E+=x.b=O[l+2],T+=x.a=O[l+3],h+=y,m+=b,v+=E,g+=T,x=x.next,p+=k=S.r,_+=H=S.g,f+=P=S.b,I+=w=S.a,y-=k,b-=H,E-=P,T-=w,S=S.next,d+=4;u+=A}for(s=0;A>s;s+=1){for(b=E=T=y=m=v=g=h=0,d=s<<2,p=B*(k=O[d]),_=B*(H=O[d+1]),f=B*(P=O[d+2]),I=B*(w=O[d+3]),h+=N*k,m+=N*H,v+=N*P,g+=N*w,V=F,o=0;B>o;o+=1)V.r=k,V.g=H,V.b=P,V.a=w,V=V.next;for(c=A,o=1;r>=o;o+=1)d=c+s<<2,h+=(V.r=k=O[d])*(D=B-o),m+=(V.g=H=O[d+1])*D,v+=(V.b=P=O[d+2])*D,g+=(V.a=w=O[d+3])*D,y+=k,b+=H,E+=P,T+=w,V=V.next,W>o&&(c+=A);for(d=s,x=F,S=R,n=0;G>n;n+=1)l=d<<2,O[l]=h*Y>>U,O[l+1]=m*Y>>U,O[l+2]=v*Y>>U,O[l+3]=g*Y>>U,h-=p,m-=_,v-=f,g-=I,p-=x.r,_-=x.g,f-=x.b,I-=x.a,l=s+((l=n+B)<W?l:W)*A<<2,h+=y+=x.r=O[l],m+=b+=x.g=O[l+1],v+=E+=x.b=O[l+2],g+=T+=x.a=O[l+3],x=x.next,p+=k=S.r,_+=H=S.g,f+=P=S.b,I+=w=S.a,y-=k,b-=H,E-=P,T-=w,S=S.next,d+=A}return L}}(),ImageFilters.Brightness=function(e,a){var t=e.data,i=e.width,r=e.height,s=(t.length,this.utils.createImageData(i,r)),n=s.data;return this.utils.mapRGB(t,n,function(e){return e+=a,e>255?255:e}),s},ImageFilters.BrightnessContrastGimp=function(e,a,t){var i=e.data,r=e.width,s=e.height,n=i.length,o=this.utils.createImageData(r,s),l=o.data,c=Math.PI/4;a/=100,t*=.99,t/=100,t=Math.tan((t+1)*c);for(var d=0,u=0;n>u;u+=4)d+=19595*i[u]+38470*i[u+1]+7471*i[u+2]>>16;return d/=n/4,this.utils.mapRGB(i,l,function(e){return 0>a?e*=1+a:a>0&&(e+=(255-e)*a),0!==t&&(e=(e-d)*t+d),e+.5|0}),o},ImageFilters.BrightnessContrastPhotoshop=function(e,a,t){var i=e.data,r=e.width,s=e.height,n=(i.length,this.utils.createImageData(r,s)),o=n.data;return a=(a+100)/100,t=(t+100)/100,this.utils.mapRGB(i,o,function(e){return e*=a,e=(e-127.5)*t+127.5,e+.5|0}),n},ImageFilters.Channels=function(e,a){var t;switch(a){case 2:t=[0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0];break;case 3:t=[0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0];break;default:t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0]}return this.ColorMatrixFilter(e,t)},ImageFilters.Clone=function(e){return this.Copy(e,this.utils.createImageData(e.width,e.height))},ImageFilters.CloneBuiltin=function(e){var a,t=e.width,i=e.height,r=this.utils.getSampleCanvas(),s=this.utils.getSampleContext();return r.width=t,r.height=i,s.putImageData(e,0,0),a=s.getImageData(0,0,t,i),r.width=0,r.height=0,a},ImageFilters.ColorMatrixFilter=function(e,a){var t,i,r,s,n,o,l=e.data,c=e.width,d=e.height,u=l.length,h=this.utils.createImageData(c,d),m=h.data,v=a[0],g=a[1],p=a[2],_=a[3],f=a[4],I=a[5],y=a[6],b=a[7],E=a[8],T=a[9],k=a[10],H=a[11],P=a[12],w=a[13],D=a[14],x=a[15],S=a[16],R=a[17],z=a[18],A=a[19];for(i=0;u>i;i+=4)r=l[i],s=l[i+1],n=l[i+2],o=l[i+3],m[i]=(t=r*v+s*g+n*p+o*_+f)>255?255:0>t?0:0|t,m[i+1]=(t=r*I+s*y+n*b+o*E+T)>255?255:0>t?0:0|t,m[i+2]=(t=r*k+s*H+n*P+o*w+D)>255?255:0>t?0:0|t,m[i+3]=(t=r*x+s*S+n*R+o*z+A)>255?255:0>t?0:0|t;return h},ImageFilters.ColorTransformFilter=function(e,a,t,i,r,s,n,o,l){var c,d,u=e.data,h=e.width,m=e.height,v=u.length,g=this.utils.createImageData(h,m),p=g.data;for(c=0;v>c;c+=4)p[c]=(d=u[c]*a+s)>255?255:0>d?0:d,p[c+1]=(d=u[c+1]*t+n)>255?255:0>d?0:d,p[c+2]=(d=u[c+2]*i+o)>255?255:0>d?0:d,p[c+3]=(d=u[c+3]*r+l)>255?255:0>d?0:d;return g},ImageFilters.Copy=function(e,a){for(var t=e.data,i=t.length,r=a.data;i--;)r[i]=t[i];return a},ImageFilters.Crop=function(e,a,t,i,r){var s,n,o,l,c=e.data,d=e.width,u=e.height,h=(c.length,this.utils.createImageData(i,r)),m=h.data,v=Math.max(a,0),g=Math.max(t,0),p=Math.min(a+i,d),_=Math.min(t+r,u),f=v-a,I=g-t;for(s=g,dstRow=I;_>s;s+=1,dstRow+=1)for(n=v,dstCol=f;p>n;n+=1,dstCol+=1)o=s*d+n<<2,l=dstRow*i+dstCol<<2,m[l]=c[o],m[l+1]=c[o+1],m[l+2]=c[o+2],m[l+3]=c[o+3];return h},ImageFilters.CropBuiltin=function(e,a,t,i,r){var s=e.width,n=e.height,o=this.utils.getSampleCanvas(),l=this.utils.getSampleContext();o.width=s,o.height=n,l.putImageData(e,0,0);var c=l.getImageData(a,t,i,r);return o.width=0,o.height=0,c},ImageFilters.Desaturate=function(e){for(var a=e.data,t=e.width,i=e.height,r=a.length,s=this.utils.createImageData(t,i),n=s.data,o=0;r>o;o+=4){var l=a[o],c=a[o+1],d=a[o+2],u=l>c?l>d?l:d:c>d?c:d,h=c>l?d>l?l:d:d>c?c:d,m=(u+h)/2+.5|0;n[o]=n[o+1]=n[o+2]=m,n[o+3]=a[o+3]}return s},ImageFilters.DisplacementMapFilter=function(e,a,t,i,r,s,n,o,l){var c=e.data,d=e.width,u=e.height,h=(c.length,ImageFilters.Clone(e)),m=h.data;t||(t=0),i||(i=0),r||(r=0),s||(s=0),n||(n=0),o||(o=0),l||(l=2);var v,g,p,_,f,I,y,b,E,T=a.width,k=a.height,H=a.data,P=T+t,w=k+i;for(b=0;d>b;b+=1)for(E=0;u>E;E+=1)v=E*d+b<<2,t>b||i>E||b>=P||E>=w?g=v:(p=(E-i)*T+(b-t)<<2,_=H[p+r],I=b+((_-128)*n>>8),f=H[p+s],y=E+((f-128)*o>>8),g=ImageFilters.utils.getPixelIndex(I+.5|0,y+.5|0,d,u,l),null===g&&(g=v)),m[v]=c[g],m[v+1]=c[g+1],m[v+2]=c[g+2],m[v+3]=c[g+3];return h},ImageFilters.Dither=function(e,a){var t=e.width,i=e.height,r=this.Clone(e),s=r.data;a=2>a?2:a>255?255:a;var n,o,l=[],c=a-1,d=0,u=0;for(o=0;a>o;o+=1)l[o]=255*o/c;n=this.utils.buildMap(function(e){var t=l[d];return u+=a,u>255&&(u-=255,d+=1),t});var h,m,v,g,p,_,f,I,y,b,E,T,k,H,P,w=t-1,D=i-1,x=7/16,S=3/16,R=5/16,z=1/16;for(m=0;i>m;m+=1)for(h=0;t>h;h+=1)v=m*t+h<<2,g=s[v],p=s[v+1],_=s[v+2],f=n[g],I=n[p],y=n[_],s[v]=f,s[v+1]=I,s[v+2]=y,b=g-f,E=p-I,T=_-y,v+=4,w>h&&(k=s[v]+x*b,H=s[v+1]+x*E,P=s[v+2]+x*T,s[v]=k>255?255:0>k?0:0|k,s[v+1]=H>255?255:0>H?0:0|H,s[v+2]=P>255?255:0>P?0:0|P),v+=t-2<<2,h>0&&D>m&&(k=s[v]+S*b,H=s[v+1]+S*E,P=s[v+2]+S*T,s[v]=k>255?255:0>k?0:0|k,s[v+1]=H>255?255:0>H?0:0|H,s[v+2]=P>255?255:0>P?0:0|P),v+=4,D>m&&(k=s[v]+R*b,H=s[v+1]+R*E,P=s[v+2]+R*T,s[v]=k>255?255:0>k?0:0|k,s[v+1]=H>255?255:0>H?0:0|H,s[v+2]=P>255?255:0>P?0:0|P),v+=4,w>h&&D>m&&(k=s[v]+z*b,H=s[v+1]+z*E,P=s[v+2]+z*T,s[v]=k>255?255:0>k?0:0|k,s[v+1]=H>255?255:0>H?0:0|H,s[v+2]=P>255?255:0>P?0:0|P);return r},ImageFilters.Edge=function(e){return this.ConvolutionFilter(e,3,3,[-1,-1,-1,-1,8,-1,-1,-1,-1])},ImageFilters.Emboss=function(e){return this.ConvolutionFilter(e,3,3,[-2,-1,0,-1,1,1,0,1,2])},ImageFilters.Enrich=function(e){return this.ConvolutionFilter(e,3,3,[0,-2,0,-2,20,-2,0,-2,0],10,-40)},ImageFilters.Flip=function(e,a){var t,i,r,s,n=e.data,o=e.width,l=e.height,c=(n.length,this.utils.createImageData(o,l)),d=c.data;for(i=0;l>i;i+=1)for(t=0;o>t;t+=1)r=i*o+t<<2,s=a?(l-i-1)*o+t<<2:i*o+(o-t-1)<<2,d[s]=n[r],d[s+1]=n[r+1],d[s+2]=n[r+2],d[s+3]=n[r+3];return c},ImageFilters.Gamma=function(e,a){var t=e.data,i=e.width,r=e.height,s=(t.length,this.utils.createImageData(i,r)),n=s.data;return this.utils.mapRGB(t,n,function(e){return e=255*Math.pow(e/255,1/a)+.5,e>255?255:e+.5|0}),s},ImageFilters.GrayScale=function(e){for(var a=e.data,t=e.width,i=e.height,r=a.length,s=this.utils.createImageData(t,i),n=s.data,o=0;r>o;o+=4){var l=19595*a[o]+38470*a[o+1]+7471*a[o+2]>>16;n[o]=n[o+1]=n[o+2]=l,n[o+3]=a[o+3]}return s},ImageFilters.HSLAdjustment=function(e,a,t,i){var r=e.data,s=e.width,n=e.height,o=r.length,l=this.utils.createImageData(s,n),c=l.data;a/=360,t/=100,i/=100;var d,u,h,m,v,g,p=this.utils.rgbToHsl,_=this.utils.hslToRgb;for(g=0;o>g;g+=4){for(m=p(r[g],r[g+1],r[g+2]),d=m[0]+a;0>d;)d+=1;for(;d>1;)d-=1;u=m[1]+m[1]*t,0>u?u=0:u>1&&(u=1),h=m[2],i>0?h+=(1-h)*i:0>i&&(h+=h*i),v=_(d,u,h),c[g]=v[0],c[g+1]=v[1],c[g+2]=v[2],c[g+3]=r[g+3]}return l},ImageFilters.Invert=function(e){var a=e.data,t=e.width,i=e.height,r=(a.length,this.utils.createImageData(t,i)),s=r.data;return this.utils.mapRGB(a,s,function(e){return 255-e}),r},ImageFilters.Mosaic=function(e,a){var t,i,r,s,n,o,l,c,d,u,h,m,v,g,p,_=e.data,f=e.width,I=e.height,y=(_.length,this.utils.createImageData(f,I)),b=y.data,E=Math.ceil(f/a),T=Math.ceil(I/a);
for(t=0;T>t;t+=1)for(n=t*a,o=n+a,o>I&&(o=I),i=0;E>i;i+=1){for(r=i*a,s=r+a,s>f&&(s=f),m=v=g=p=0,h=(s-r)*(o-n),c=n;o>c;c+=1)for(d=c*f,l=r;s>l;l+=1)u=d+l<<2,m+=_[u],v+=_[u+1],g+=_[u+2],p+=_[u+3];for(m=m/h+.5|0,v=v/h+.5|0,g=g/h+.5|0,p=p/h+.5|0,c=n;o>c;c+=1)for(d=c*f,l=r;s>l;l+=1)u=d+l<<2,b[u]=m,b[u+1]=v,b[u+2]=g,b[u+3]=p}return y},ImageFilters.Oil=function(e,a,t){var i,r,s,n,o,l,c,d,u,h,m,v,g,p,_,f,I,y,b=e.data,E=e.width,T=e.height,k=(b.length,this.utils.createImageData(E,T)),H=k.data,P=0,w=[],D=[],x=[],S=[],R=[],z=[];for(r=0;T>r;r+=1)for(i=0;E>i;i+=1){for(s=0;t>s;s+=1)w[s]=D[s]=x[s]=S[s]=R[s]=z[s]=0;for(n=-a;a>=n;n+=1)if(l=r+n,!(0>l||l>=T))for(d=l*E,o=-a;a>=o;o+=1)c=i+o,0>c||c>=E||(u=d+c<<2,h=b[u],m=b[u+1],v=b[u+2],g=h*t>>8,p=m*t>>8,_=v*t>>8,S[g]+=h,R[p]+=m,z[_]+=v,w[g]+=1,D[p]+=1,x[_]+=1);for(f=I=y=0,s=1;t>s;s+=1)w[s]>w[f]&&(f=s),D[s]>D[I]&&(I=s),x[s]>x[y]&&(y=s);H[P]=S[f]/w[f]|0,H[P+1]=R[I]/D[I]|0,H[P+2]=z[y]/x[y]|0,H[P+3]=b[P+3],P+=4}return k},ImageFilters.OpacityFilter=function(e,a){for(var t=e.data,i=e.width,r=e.height,s=t.length,n=this.utils.createImageData(i,r),o=n.data,l=0;s>l;l+=4)o[l]=t[l],o[l+1]=t[l+1],o[l+2]=t[l+2],o[l+3]=a;return n},ImageFilters.Posterize=function(e,a){var t=e.data,i=e.width,r=e.height,s=(t.length,this.utils.createImageData(i,r)),n=s.data;a=2>a?2:a>255?255:a;var o,l=[],c=a-1,d=0,u=0;for(o=0;a>o;o+=1)l[o]=255*o/c;return this.utils.mapRGB(t,n,function(e){var t=l[d];return u+=a,u>255&&(u-=255,d+=1),t}),s},ImageFilters.Rescale=function(e,a){var t=e.data,i=e.width,r=e.height,s=(t.length,this.utils.createImageData(i,r)),n=s.data;return this.utils.mapRGB(t,n,function(e){return e*=a,e>255?255:e+.5|0}),s},ImageFilters.ResizeNearestNeighbor=function(e,a,t){var i,r,s,n,o=e.data,l=e.width,c=e.height,d=(o.length,this.utils.createImageData(a,t)),u=d.data,h=l/a,m=c/t,v=0;for(s=0;t>s;s+=1)for(n=(s*m|0)*l,r=0;a>r;r+=1)i=n+r*h<<2,u[v]=o[i],u[v+1]=o[i+1],u[v+2]=o[i+2],u[v+3]=o[i+3],v+=4;return d},ImageFilters.Resize=function(e,a,t){var i,r,s=e.data,n=e.width,o=e.height,l=(s.length,this.utils.createImageData(a,t)),c=l.data,d=n/a,u=o/t,h=0;for(r=0;t>r;r+=1)for(i=0;a>i;i+=1)this.utils.copyBilinear(s,i*d,r*u,n,o,c,h,0),h+=4;return l},ImageFilters.ResizeBuiltin=function(e,a,t){var i,r=e.width,s=e.height,n=this.utils.getSampleCanvas(),o=this.utils.getSampleContext();return n.width=Math.max(r,a),n.height=Math.max(s,t),o.save(),o.putImageData(e,0,0),o.scale(a/r,t/s),o.drawImage(n,0,0),i=o.getImageData(0,0,a,t),o.restore(),n.width=0,n.height=0,i},ImageFilters.Sepia=function(e){var a,t,i,r,s,n=e.data,o=e.width,l=e.height,c=n.length,d=this.utils.createImageData(o,l),u=d.data;for(r=0;c>r;r+=4)a=n[r],t=n[r+1],i=n[r+2],u[r]=(s=.393*a+.769*t+.189*i)>255?255:0>s?0:s+.5|0,u[r+1]=(s=.349*a+.686*t+.168*i)>255?255:0>s?0:s+.5|0,u[r+2]=(s=.272*a+.534*t+.131*i)>255?255:0>s?0:s+.5|0,u[r+3]=n[r+3];return d},ImageFilters.Sharpen=function(e,a){return this.ConvolutionFilter(e,3,3,[-a/16,-a/8,-a/16,-a/8,.75*a+1,-a/8,-a/16,-a/8,-a/16])},ImageFilters.Solarize=function(e){var a=e.data,t=e.width,i=e.height,r=(a.length,this.utils.createImageData(t,i)),s=r.data;return this.utils.mapRGB(a,s,function(e){return e>127?2*(e-127.5):2*(127.5-e)}),r},ImageFilters.Transpose=function(e){var a,t,i=e.data,r=e.width,s=e.height,n=(i.length,this.utils.createImageData(s,r)),o=n.data;for(y=0;y<s;y+=1)for(x=0;x<r;x+=1)a=y*r+x<<2,t=x*s+y<<2,o[t]=i[a],o[t+1]=i[a+1],o[t+2]=i[a+2],o[t+3]=i[a+3];return n},ImageFilters.Twril=function(e,a,t,i,r,s,n){var o=e.data,l=e.width,c=e.height,d=(o.length,this.utils.createImageData(l,c)),u=d.data;a=l*a,t=c*t,r*=Math.PI/180;var h,m,v,g,p,_,f,I,y,b=i*i,E=0;for(m=0;c>m;m+=1)for(h=0;l>h;h+=1)v=h-a,g=m-t,p=v*v+g*g,p>b?(u[E]=o[E],u[E+1]=o[E+1],u[E+2]=o[E+2],u[E+3]=o[E+3]):(p=Math.sqrt(p),_=Math.atan2(g,v)+r*(i-p)/i,f=a+p*Math.cos(_),I=t+p*Math.sin(_),n?this.utils.copyBilinear(o,f,I,l,c,u,E,s):(y=(I+.5|0)*l+(f+.5|0)<<2,u[E]=o[y],u[E+1]=o[y+1],u[E+2]=o[y+2],u[E+3]=o[y+3])),E+=4;return d};var sketchy_brush={context:null,prevMouseX:null,prevMouseY:null,points:null,count:null,init:function(e){this.context=e,this.context.globalCompositeOperation="source-over",this.points=new Array,this.count=0},destroy:function(){},strokeStart:function(e,a){this.prevMouseX=e,this.prevMouseY=a},stroke:function(e,a,t,i){var r,s,n,o;for(this.points.push([a,t]),this.context.strokeStyle="rgba("+e.r+", "+e.g+", "+e.b+", 0.1)",this.context.beginPath(),this.context.moveTo(this.prevMouseX,this.prevMouseY),this.context.lineTo(a,t),this.context.stroke(),this.context.strokeStyle="rgba("+e.r+", "+e.g+", "+e.b+", 0.1 )",r=0;r<this.points.length;r++)s=this.points[r][0]-this.points[this.count][0],n=this.points[r][1]-this.points[this.count][1],o=s*s+n*n,o<800*i&&Math.random()>o/(400*i)&&(this.context.beginPath(),this.context.moveTo(this.points[this.count][0]+.3*s,this.points[this.count][1]+.3*n),this.context.lineTo(this.points[r][0]-.3*s,this.points[r][1]-.3*n),this.context.stroke());this.prevMouseX=a,this.prevMouseY=t,this.count++},strokeEnd:function(e,a){}},shaded_brush={context:null,prevMouseX:null,prevMouseY:null,points:null,count:null,init:function(e){this.context=e,this.context.globalCompositeOperation="source-over",this.points=new Array,this.count=0},destroy:function(){},strokeStart:function(e,a){this.prevMouseX=e,this.prevMouseY=a},stroke:function(e,a,t,i){var r,s,n,o;for(this.points.push([a,t]),r=0;r<this.points.length;r++)s=this.points[r][0]-this.points[this.count][0],n=this.points[r][1]-this.points[this.count][1],o=s*s+n*n,o<200*i&&(this.context.strokeStyle="rgba("+e.r+", "+e.g+", "+e.b+", "+.1*(1-o/(200*i))+" )",this.context.beginPath(),this.context.moveTo(this.points[this.count][0],this.points[this.count][1]),this.context.lineTo(this.points[r][0],this.points[r][1]),this.context.stroke());this.prevMouseX=a,this.prevMouseY=t,this.count++},strokeEnd:function(e,a){}},chrome_brush={context:null,prevMouseX:null,prevMouseY:null,points:null,count:null,init:function(e){this.context=e,this.points=new Array,this.count=0},destroy:function(){},strokeStart:function(e,a){this.prevMouseX=e,this.prevMouseY=a},stroke:function(e,a,t,i){var r,s,n,o;for(this.points.push([a,t]),this.context.strokeStyle="rgba("+e.r+", "+e.g+", "+e.b+", 0.1)",this.context.beginPath(),this.context.moveTo(this.prevMouseX,this.prevMouseY),this.context.lineTo(a,t),this.context.stroke(),r=0;r<this.points.length;r++)s=this.points[r][0]-this.points[this.count][0],n=this.points[r][1]-this.points[this.count][1],o=s*s+n*n,o<200*i&&(this.context.strokeStyle="rgba("+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", 0.1 )",this.context.beginPath(),this.context.moveTo(this.points[this.count][0]+.2*s,this.points[this.count][1]+.2*n),this.context.lineTo(this.points[r][0]-.2*s,this.points[r][1]-.2*n),this.context.stroke());this.prevMouseX=a,this.prevMouseY=t,this.count++},strokeEnd:function(e,a){}};!function(e){"use strict";var a=null,t=null,i=65280,r=16711935,s=16711680,n=65280,o=255,l=3145728,c=1792,d=6,u=e.Math,h=function(e){var a=(16711680&e)>>16,t=(65280&e)>>8,i=255&e;return((.299*a+.587*t+.114*i|0)<<16)+((-.169*a-.331*t+.5*i+128|0)<<8)+(.5*a-.419*t-.081*i+128|0)},m=function(e,a){var t=h(e),i=h(a);return u.abs((t&s)-(i&s))>l||u.abs((t&n)-(i&n))>c||u.abs((t&o)-(i&o))>d},v=function(e,a,s){return a===s?void(t[e]=a):(t[e]=(3*(a&i)+(s&i)>>2&i)+(3*(a&r)+(s&r)>>2&r),void(t[e]|=4278190080&a))},g=function(e,a,s,n){t[e]=(((a&i)<<1)+(s&i)+(n&i)>>2&i)+(((a&r)<<1)+(s&r)+(n&r)>>2&r),t[e]|=4278190080&a},p=function(e,a,s){return a===s?void(t[e]=a):(t[e]=(7*(a&i)+(s&i)>>3&i)+(7*(a&r)+(s&r)>>3&r),void(t[e]|=4278190080&a))},_=function(e,a,s,n){t[e]=(((a&i)<<1)+7*(s&i)+7*(n&i)>>4&i)+(((a&r)<<1)+7*(s&r)+7*(n&r)>>4&r),t[e]|=4278190080&a},f=function(e,a,s){return a===s?void(t[e]=a):(t[e]=((a&i)+(s&i)>>1&i)+((a&r)+(s&r)>>1&r),void(t[e]|=4278190080&a))},I=function(e,a,s,n){t[e]=(5*(a&i)+((s&i)<<1)+(n&i)>>3&i)+(5*(a&r)+((s&r)<<1)+(n&r)>>3&r),t[e]|=4278190080&a},y=function(e,a,s,n){t[e]=(6*(a&i)+(s&i)+(n&i)>>3&i)+(6*(a&r)+(s&r)+(n&r)>>3&r),t[e]|=4278190080&a},b=function(e,a,s){return a===s?void(t[e]=a):(t[e]=(5*(a&i)+3*(s&i)>>3&i)+(5*(a&r)+3*(s&r)>>3&r),void(t[e]|=4278190080&a))},E=function(e,a,s,n){t[e]=(((a&i)<<1)+3*(s&i)+3*(n&i)>>3&i)+(((a&r)<<1)+3*(s&r)+3*(n&r)>>3&r),t[e]|=4278190080&a},T=function(e,a){var t=a.charAt(0).toUpperCase()+a.substr(1);return e[a]||e["ms"+t]||e["moz"+t]||e["webkit"+t]||e["o"+t]},k=function(e,a,t,i,r){var s=document.createElement("canvas"),n=s.getContext("2d"),o=T(n,"backingStorePixelRatio")||1;n.getImageDataHD=T(n,"getImageDataHD");var l=e.width/o,c=e.height/o;return s.width=Math.ceil(l),s.height=Math.ceil(c),n.drawImage(e,0,0,l,c),1===o?n.getImageData(a,t,i,r):n.getImageDataHD(a,t,i,r)};e.hqx=function(e,i){if(-1===[2,3,4].indexOf(i))return e;var r,s,n,o;e instanceof HTMLCanvasElement?(r=e,s=r.getContext("2d"),n=r,o=s.getImageData(0,0,r.width,r.height).data):(o=k(e,0,0,e.width,e.height).data,n=document.createElement("canvas"));for(var l,c=e.width*e.height,d=a=new Array(c),u=t=new Array(c*i*i),h=0;c>h;h++)d[h]=(o[(l=h<<2)+3]<<24)+(o[l+2]<<16)+(o[l+1]<<8)+o[l];2===i?H(e.width,e.height):3===i?P(e.width,e.height):4===i&&w(e.width,e.height),n.width=e.width*i,n.height=e.height*i;for(var m,v,g=n.getContext("2d"),p=g.getImageData(0,0,n.width,n.height),_=p.data,f=u.length,I=0;f>I;I++)v=(4278190080&(m=u[I]))>>24,_[(l=I<<2)+3]=0>v?v+256:0,_[l+2]=(16711680&m)>>16,_[l+1]=(65280&m)>>8,_[l]=255&m;return a=d=null,t=u=null,p};var H=function(e,i){var r,p,_,f,b,T,k,H=[],P=e<<1,w=0,D=0,x=m,S=u,R=h,z=v,A=g,G=I,L=y,O=E,C=a,M=t,W=s,B=n,N=o,F=l,V=c,Y=d;for(p=0;i>p;p++){for(f=p>0?-e:0,b=i-1>p?e:0,r=0;e>r;r++){H[2]=C[D+f],H[5]=C[D],H[8]=C[D+b],r>0?(H[1]=C[D+f-1],H[4]=C[D-1],H[7]=C[D+b-1]):(H[1]=H[2],H[4]=H[5],H[7]=H[8]),e-1>r?(H[3]=C[D+f+1],H[6]=C[D+1],H[9]=C[D+b+1]):(H[3]=H[2],H[6]=H[5],H[9]=H[8]);var U=0,j=1;for(T=R(H[5]),_=1;10>_;_++)5!==_&&(H[_]!==H[5]&&(k=R(H[_]),(S.abs((T&W)-(k&W))>F||S.abs((T&B)-(k&B))>V||S.abs((T&N)-(k&N))>Y)&&(U|=j)),j<<=1);switch(U){case 0:case 1:case 4:case 32:case 128:case 5:case 132:case 160:case 33:case 129:case 36:case 133:case 164:case 161:case 37:case 165:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[6],H[8]);break;case 2:case 34:case 130:case 162:A(w,H[5],H[1],H[4]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[6],H[8]);break;case 16:case 17:case 48:case 49:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[8]);break;case 64:case 65:case 68:case 69:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 8:case 12:case 136:case 140:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 3:case 35:case 131:case 163:z(w,H[5],H[4]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[6],H[8]);break;case 6:case 38:case 134:case 166:A(w,H[5],H[1],H[4]),z(w+1,H[5],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[6],H[8]);break;case 20:case 21:case 52:case 53:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[8]);break;case 144:case 145:case 176:case 177:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[8]);break;case 192:case 193:case 196:case 197:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[4]),z(w+P+1,H[5],H[6]);break;case 96:case 97:case 100:case 101:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 40:case 44:case 168:case 172:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 9:case 13:case 137:case 141:z(w,H[5],H[2]),A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 18:case 50:A(w,H[5],H[1],H[4]),x(H[2],H[6])?z(w+1,H[5],H[3]):A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[8]);break;case 80:case 81:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):A(w+P+1,H[5],H[6],H[8]);break;case 72:case 76:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 10:case 138:x(H[4],H[2])?z(w,H[5],H[4]):A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 66:A(w,H[5],H[1],H[4]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[7],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 24:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 7:case 39:case 135:z(w,H[5],H[4]),z(w+1,H[5],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[6],H[8]);break;case 148:case 149:case 180:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[8]);break;case 224:case 228:case 225:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[6]);break;case 41:case 169:case 45:z(w,H[5],H[2]),A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 22:case 54:A(w,H[5],H[1],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[8]);break;case 208:case 209:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 104:case 108:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 11:case 139:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 19:case 51:x(H[2],H[6])?(z(w,H[5],H[4]),z(w+1,H[5],H[3])):(G(w,H[5],H[2],H[4]),O(w+1,H[5],H[2],H[6])),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[8]);break;case 146:case 178:A(w,H[5],H[1],H[4]),x(H[2],H[6])?(z(w+1,H[5],H[3]),z(w+P+1,H[5],H[8])):(O(w+1,H[5],H[2],H[6]),G(w+P+1,H[5],H[6],H[8])),A(w+P,H[5],H[8],H[4]);break;case 84:case 85:A(w,H[5],H[4],H[2]),x(H[6],H[8])?(z(w+1,H[5],H[2]),z(w+P+1,H[5],H[9])):(G(w+1,H[5],H[6],H[2]),O(w+P+1,H[5],H[6],H[8])),A(w+P,H[5],H[7],H[4]);break;case 112:case 113:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[2]),x(H[6],H[8])?(z(w+P,H[5],H[4]),z(w+P+1,H[5],H[9])):(G(w+P,H[5],H[8],H[4]),O(w+P+1,H[5],H[6],H[8]));break;case 200:case 204:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?(z(w+P,H[5],H[7]),z(w+P+1,H[5],H[6])):(O(w+P,H[5],H[8],H[4]),G(w+P+1,H[5],H[8],H[6]));break;case 73:case 77:x(H[8],H[4])?(z(w,H[5],H[2]),z(w+P,H[5],H[7])):(G(w,H[5],H[4],H[2]),O(w+P,H[5],H[8],H[4])),A(w+1,H[5],H[2],H[6]),A(w+P+1,H[5],H[9],H[6]);break;case 42:case 170:x(H[4],H[2])?(z(w,H[5],H[4]),z(w+P,H[5],H[8])):(O(w,H[5],H[4],H[2]),G(w+P,H[5],H[4],H[8])),A(w+1,H[5],H[3],H[6]),A(w+P+1,H[5],H[6],H[8]);break;case 14:case 142:x(H[4],H[2])?(z(w,H[5],H[4]),z(w+1,H[5],H[6])):(O(w,H[5],H[4],H[2]),G(w+1,H[5],H[2],H[6])),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 67:z(w,H[5],H[4]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[7],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 70:A(w,H[5],H[1],H[4]),z(w+1,H[5],H[6]),A(w+P,H[5],H[7],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 28:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 152:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 194:A(w,H[5],H[1],H[4]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[7],H[4]),z(w+P+1,H[5],H[6]);break;case 98:A(w,H[5],H[1],H[4]),A(w+1,H[5],H[3],H[6]),z(w+P,H[5],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 56:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[3],H[2]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 25:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 26:case 31:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 82:case 214:A(w,H[5],H[1],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 88:case 248:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[3],H[2]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 74:case 107:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 27:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[3]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 86:A(w,H[5],H[1],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[4]),z(w+P+1,H[5],H[9]);break;case 216:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[3],H[2]),z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 106:z(w,H[5],H[4]),A(w+1,H[5],H[3],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 30:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 210:A(w,H[5],H[1],H[4]),z(w+1,H[5],H[3]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 120:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[3],H[2]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[9]);break;case 75:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),z(w+P,H[5],H[7]),A(w+P+1,H[5],H[9],H[6]);break;case 29:z(w,H[5],H[2]),z(w+1,H[5],H[2]),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 198:A(w,H[5],H[1],H[4]),z(w+1,H[5],H[6]),A(w+P,H[5],H[7],H[4]),z(w+P+1,H[5],H[6]);break;case 184:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[3],H[2]),z(w+P,H[5],H[8]),z(w+P+1,H[5],H[8]);break;case 99:z(w,H[5],H[4]),A(w+1,H[5],H[3],H[6]),z(w+P,H[5],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 57:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 71:z(w,H[5],H[4]),z(w+1,H[5],H[6]),A(w+P,H[5],H[7],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 156:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 226:A(w,H[5],H[1],H[4]),A(w+1,H[5],H[3],H[6]),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[6]);break;case 60:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 195:z(w,H[5],H[4]),A(w+1,H[5],H[3],H[6]),A(w+P,H[5],H[7],H[4]),z(w+P+1,H[5],H[6]);break;case 102:A(w,H[5],H[1],H[4]),z(w+1,H[5],H[6]),z(w+P,H[5],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 153:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 58:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 83:z(w,H[5],H[4]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 92:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 202:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[6]);break;case 78:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),z(w+1,H[5],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 154:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 114:A(w,H[5],H[1],H[4]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 89:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 90:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 55:case 23:x(H[2],H[6])?(z(w,H[5],H[4]),M[w+1]=H[5]):(G(w,H[5],H[2],H[4]),O(w+1,H[5],H[2],H[6])),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[8]);break;case 182:case 150:A(w,H[5],H[1],H[4]),x(H[2],H[6])?(M[w+1]=H[5],z(w+P+1,H[5],H[8])):(O(w+1,H[5],H[2],H[6]),G(w+P+1,H[5],H[6],H[8])),A(w+P,H[5],H[8],H[4]);break;case 213:case 212:A(w,H[5],H[4],H[2]),x(H[6],H[8])?(z(w+1,H[5],H[2]),M[w+P+1]=H[5]):(G(w+1,H[5],H[6],H[2]),O(w+P+1,H[5],H[6],H[8])),A(w+P,H[5],H[7],H[4]);break;case 241:case 240:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[2]),x(H[6],H[8])?(z(w+P,H[5],H[4]),M[w+P+1]=H[5]):(G(w+P,H[5],H[8],H[4]),O(w+P+1,H[5],H[6],H[8]));break;case 236:case 232:A(w,H[5],H[1],H[2]),A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?(M[w+P]=H[5],z(w+P+1,H[5],H[6])):(O(w+P,H[5],H[8],H[4]),G(w+P+1,H[5],H[8],H[6]));break;case 109:case 105:x(H[8],H[4])?(z(w,H[5],H[2]),M[w+P]=H[5]):(G(w,H[5],H[4],H[2]),O(w+P,H[5],H[8],H[4])),A(w+1,H[5],H[2],H[6]),A(w+P+1,H[5],H[9],H[6]);break;case 171:case 43:x(H[4],H[2])?(M[w]=H[5],z(w+P,H[5],H[8])):(O(w,H[5],H[4],H[2]),G(w+P,H[5],H[4],H[8])),A(w+1,H[5],H[3],H[6]),A(w+P+1,H[5],H[6],H[8]);break;case 143:case 15:x(H[4],H[2])?(M[w]=H[5],z(w+1,H[5],H[6])):(O(w,H[5],H[4],H[2]),G(w+1,H[5],H[2],H[6])),A(w+P,H[5],H[7],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 124:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[9]);break;case 203:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),z(w+P,H[5],H[7]),z(w+P+1,H[5],H[6]);break;case 62:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 211:z(w,H[5],H[4]),z(w+1,H[5],H[3]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 118:A(w,H[5],H[1],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[9]);break;case 217:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 110:z(w,H[5],H[4]),z(w+1,H[5],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 155:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[3]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 188:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[8]),z(w+P+1,H[5],H[8]);break;case 185:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),z(w+P,H[5],H[8]),z(w+P+1,H[5],H[8]);break;case 61:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 157:z(w,H[5],H[2]),z(w+1,H[5],H[2]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 103:z(w,H[5],H[4]),z(w+1,H[5],H[6]),z(w+P,H[5],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 227:z(w,H[5],H[4]),A(w+1,H[5],H[3],H[6]),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[6]);break;case 230:A(w,H[5],H[1],H[4]),z(w+1,H[5],H[6]),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[6]);break;case 199:z(w,H[5],H[4]),z(w+1,H[5],H[6]),A(w+P,H[5],H[7],H[4]),z(w+P+1,H[5],H[6]);break;case 220:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 158:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 234:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[6]);break;case 242:A(w,H[5],H[1],H[4]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 59:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 121:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 87:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 79:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 122:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 94:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 218:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 91:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 229:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[6]);break;case 167:z(w,H[5],H[4]),z(w+1,H[5],H[6]),A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[6],H[8]);break;case 173:z(w,H[5],H[2]),A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 181:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[8]);break;case 186:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),z(w+P+1,H[5],H[8]);break;case 115:z(w,H[5],H[4]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 93:z(w,H[5],H[2]),z(w+1,H[5],H[2]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 206:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),z(w+1,H[5],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[6]);break;case 205:case 201:z(w,H[5],H[2]),A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?z(w+P,H[5],H[7]):L(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[6]);break;case 174:case 46:x(H[4],H[2])?z(w,H[5],H[4]):L(w,H[5],H[4],H[2]),z(w+1,H[5],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 179:case 147:z(w,H[5],H[4]),x(H[2],H[6])?z(w+1,H[5],H[3]):L(w+1,H[5],H[2],H[6]),A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[8]);break;case 117:case 116:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[4]),x(H[6],H[8])?z(w+P+1,H[5],H[9]):L(w+P+1,H[5],H[6],H[8]);break;case 189:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[8]),z(w+P+1,H[5],H[8]);break;case 231:z(w,H[5],H[4]),z(w+1,H[5],H[6]),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[6]);break;case 126:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[9]);break;case 219:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[3]),z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 125:x(H[8],H[4])?(z(w,H[5],H[2]),M[w+P]=H[5]):(G(w,H[5],H[4],H[2]),O(w+P,H[5],H[8],H[4])),z(w+1,H[5],H[2]),z(w+P+1,H[5],H[9]);break;case 221:z(w,H[5],H[2]),x(H[6],H[8])?(z(w+1,H[5],H[2]),M[w+P+1]=H[5]):(G(w+1,H[5],H[6],H[2]),O(w+P+1,H[5],H[6],H[8])),z(w+P,H[5],H[7]);break;case 207:x(H[4],H[2])?(M[w]=H[5],z(w+1,H[5],H[6])):(O(w,H[5],H[4],H[2]),G(w+1,H[5],H[2],H[6])),z(w+P,H[5],H[7]),z(w+P+1,H[5],H[6]);break;case 238:z(w,H[5],H[4]),z(w+1,H[5],H[6]),x(H[8],H[4])?(M[w+P]=H[5],z(w+P+1,H[5],H[6])):(O(w+P,H[5],H[8],H[4]),G(w+P+1,H[5],H[8],H[6]));break;case 190:z(w,H[5],H[4]),x(H[2],H[6])?(M[w+1]=H[5],z(w+P+1,H[5],H[8])):(O(w+1,H[5],H[2],H[6]),G(w+P+1,H[5],H[6],H[8])),z(w+P,H[5],H[8]);break;case 187:x(H[4],H[2])?(M[w]=H[5],z(w+P,H[5],H[8])):(O(w,H[5],H[4],H[2]),G(w+P,H[5],H[4],H[8])),z(w+1,H[5],H[3]),z(w+P+1,H[5],H[8]);break;case 243:z(w,H[5],H[4]),z(w+1,H[5],H[3]),x(H[6],H[8])?(z(w+P,H[5],H[4]),M[w+P+1]=H[5]):(G(w+P,H[5],H[8],H[4]),O(w+P+1,H[5],H[6],H[8]));break;case 119:x(H[2],H[6])?(z(w,H[5],H[4]),M[w+1]=H[5]):(G(w,H[5],H[2],H[4]),O(w+1,H[5],H[2],H[6])),z(w+P,H[5],H[4]),z(w+P+1,H[5],H[9]);break;case 237:case 233:z(w,H[5],H[2]),A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?M[w+P]=H[5]:z(w+P,H[5],H[7]),z(w+P+1,H[5],H[6]);break;case 175:case 47:x(H[4],H[2])?M[w]=H[5]:z(w,H[5],H[4]),z(w+1,H[5],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[6],H[8]);break;case 183:case 151:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:z(w+1,H[5],H[3]),A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[8]);break;case 245:case 244:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:z(w+P+1,H[5],H[9]);break;case 250:z(w,H[5],H[4]),z(w+1,H[5],H[3]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 123:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[3]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[9]);break;case 95:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[7]),z(w+P+1,H[5],H[9]);break;case 222:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 252:A(w,H[5],H[1],H[2]),z(w+1,H[5],H[2]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:z(w+P+1,H[5],H[9]);break;case 249:z(w,H[5],H[2]),A(w+1,H[5],H[3],H[2]),x(H[8],H[4])?M[w+P]=H[5]:z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 235:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),A(w+1,H[5],H[3],H[6]),x(H[8],H[4])?M[w+P]=H[5]:z(w+P,H[5],H[7]),z(w+P+1,H[5],H[6]);break;case 111:x(H[4],H[2])?M[w]=H[5]:z(w,H[5],H[4]),z(w+1,H[5],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),A(w+P+1,H[5],H[9],H[6]);break;case 63:x(H[4],H[2])?M[w]=H[5]:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[8]),A(w+P+1,H[5],H[9],H[8]);break;case 159:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),x(H[2],H[6])?M[w+1]=H[5]:z(w+1,H[5],H[3]),A(w+P,H[5],H[7],H[8]),z(w+P+1,H[5],H[8]);break;case 215:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:z(w+1,H[5],H[3]),A(w+P,H[5],H[7],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 246:A(w,H[5],H[1],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),z(w+P,H[5],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:z(w+P+1,H[5],H[9]);break;case 254:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:z(w+P+1,H[5],H[9]);break;case 253:z(w,H[5],H[2]),z(w+1,H[5],H[2]),x(H[8],H[4])?M[w+P]=H[5]:z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:z(w+P+1,H[5],H[9]);break;case 251:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[3]),x(H[8],H[4])?M[w+P]=H[5]:z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 239:x(H[4],H[2])?M[w]=H[5]:z(w,H[5],H[4]),z(w+1,H[5],H[6]),x(H[8],H[4])?M[w+P]=H[5]:z(w+P,H[5],H[7]),z(w+P+1,H[5],H[6]);break;case 127:x(H[4],H[2])?M[w]=H[5]:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:A(w+1,H[5],H[2],H[6]),x(H[8],H[4])?M[w+P]=H[5]:A(w+P,H[5],H[8],H[4]),z(w+P+1,H[5],H[9]);break;case 191:x(H[4],H[2])?M[w]=H[5]:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:z(w+1,H[5],H[3]),z(w+P,H[5],H[8]),z(w+P+1,H[5],H[8]);break;case 223:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),x(H[2],H[6])?M[w+1]=H[5]:z(w+1,H[5],H[3]),z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:A(w+P+1,H[5],H[6],H[8]);break;case 247:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:z(w+1,H[5],H[3]),z(w+P,H[5],H[4]),x(H[6],H[8])?M[w+P+1]=H[5]:z(w+P+1,H[5],H[9]);break;case 255:x(H[4],H[2])?M[w]=H[5]:z(w,H[5],H[4]),x(H[2],H[6])?M[w+1]=H[5]:z(w+1,H[5],H[3]),x(H[8],H[4])?M[w+P]=H[5]:z(w+P,H[5],H[7]),x(H[6],H[8])?M[w+P+1]=H[5]:z(w+P+1,H[5],H[9])}D++,w+=2}w+=P}},P=function(e,i){var r,I,y,b,E,T,k,H=[],P=3*e,w=0,D=0,x=m,S=u,R=h,z=v,A=g,G=p,L=_,O=f,C=a,M=t,W=s,B=n,N=o,F=l,V=c,Y=d;for(I=0;i>I;I++){for(b=I>0?-e:0,E=i-1>I?e:0,r=0;e>r;r++){H[2]=C[D+b],H[5]=C[D],H[8]=C[D+E],r>0?(H[1]=C[D+b-1],H[4]=C[D-1],H[7]=C[D+E-1]):(H[1]=H[2],H[4]=H[5],H[7]=H[8]),e-1>r?(H[3]=C[D+b+1],H[6]=C[D+1],H[9]=C[D+E+1]):(H[3]=H[2],H[6]=H[5],H[9]=H[8]);var U=0,j=1;for(T=R(H[5]),y=1;10>y;y++)5!==y&&(H[y]!==H[5]&&(k=R(H[y]),(S.abs((T&W)-(k&W))>F||S.abs((T&B)-(k&B))>V||S.abs((T&N)-(k&N))>Y)&&(U|=j)),j<<=1);switch(U){case 0:case 1:case 4:case 32:case 128:case 5:case 132:case 160:case 33:
case 129:case 36:case 133:case 164:case 161:case 37:case 165:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 2:case 34:case 130:case 162:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 16:case 17:case 48:case 49:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 64:case 65:case 68:case 69:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 8:case 12:case 136:case 140:z(w,H[5],H[1]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 3:case 35:case 131:case 163:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 6:case 38:case 134:case 166:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 20:case 21:case 52:case 53:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 144:case 145:case 176:case 177:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 192:case 193:case 196:case 197:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 96:case 97:case 100:case 101:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 40:case 44:case 168:case 172:z(w,H[5],H[1]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 9:case 13:case 137:case 141:z(w,H[5],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 18:case 50:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],z(w+2,H[5],H[3]),M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 80:case 81:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9])):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 72:case 76:z(w,H[5],H[1]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?(M[w+P]=H[5],z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 10:case 138:x(H[4],H[2])?(z(w,H[5],H[1]),M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 66:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 24:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 7:case 39:case 135:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 148:case 149:case 180:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 224:case 228:case 225:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 41:case 169:case 45:z(w,H[5],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 22:case 54:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 208:case 209:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 104:case 108:z(w,H[5],H[1]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 11:case 139:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 19:case 51:x(H[2],H[6])?(z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),M[w+P+2]=H[5]):(A(w,H[5],H[4],H[2]),z(w+1,H[2],H[5]),O(w+2,H[2],H[6]),z(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 146:case 178:x(H[2],H[6])?(M[w+1]=H[5],z(w+2,H[5],H[3]),M[w+P+2]=H[5],z(w+(P<<1)+2,H[5],H[8])):(z(w+1,H[5],H[2]),O(w+2,H[2],H[6]),z(w+P+2,H[6],H[5]),A(w+(P<<1)+2,H[5],H[6],H[8])),z(w,H[5],H[1]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]);break;case 84:case 85:x(H[6],H[8])?(z(w+2,H[5],H[2]),M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9])):(A(w+2,H[5],H[2],H[6]),z(w+P+2,H[6],H[5]),z(w+(P<<1)+1,H[5],H[8]),O(w+(P<<1)+2,H[6],H[8])),A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]);break;case 112:case 113:x(H[6],H[8])?(M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9])):(z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[8],H[5]),O(w+(P<<1)+2,H[6],H[8])),A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5];break;case 200:case 204:x(H[8],H[4])?(M[w+P]=H[5],z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6])):(z(w+P,H[5],H[4]),O(w+(P<<1),H[8],H[4]),z(w+(P<<1)+1,H[8],H[5]),A(w+(P<<1)+2,H[5],H[6],H[8])),z(w,H[5],H[1]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]);break;case 73:case 77:x(H[8],H[4])?(z(w,H[5],H[2]),M[w+P]=H[5],z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5]):(A(w,H[5],H[4],H[2]),z(w+P,H[4],H[5]),O(w+(P<<1),H[8],H[4]),z(w+(P<<1)+1,H[5],H[8])),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1)+2,H[5],H[9]);break;case 42:case 170:x(H[4],H[2])?(z(w,H[5],H[1]),M[w+1]=H[5],M[w+P]=H[5],z(w+(P<<1),H[5],H[8])):(O(w,H[4],H[2]),z(w+1,H[5],H[2]),z(w+P,H[4],H[5]),A(w+(P<<1),H[5],H[8],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 14:case 142:x(H[4],H[2])?(z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5]):(O(w,H[4],H[2]),z(w+1,H[2],H[5]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4])),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 67:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 70:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 28:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 152:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 194:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 98:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 56:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 25:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 26:case 31:x(H[4],H[2])?(M[w]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+P,H[5],H[4])),M[w+1]=H[5],x(H[2],H[6])?(M[w+2]=H[5],M[w+P+2]=H[5]):(L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 82:case 214:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 88:case 248:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P+1]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4])),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 74:case 107:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2])),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?(M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 27:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 86:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 216:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 106:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 30:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 210:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 120:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 75:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 29:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 198:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 184:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 99:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 57:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 71:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 156:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 226:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 60:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 195:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 102:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 153:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 58:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 83:z(w,H[5],H[4]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 92:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 202:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 78:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 154:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 114:z(w,H[5],H[1]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 89:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 90:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 55:case 23:x(H[2],H[6])?(z(w,H[5],H[4]),M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(A(w,H[5],H[4],H[2]),z(w+1,H[2],H[5]),O(w+2,H[2],H[6]),z(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 182:case 150:x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5],z(w+(P<<1)+2,H[5],H[8])):(z(w+1,H[5],H[2]),O(w+2,H[2],H[6]),z(w+P+2,H[6],H[5]),A(w+(P<<1)+2,H[5],H[6],H[8])),z(w,H[5],H[1]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]);break;case 213:case 212:x(H[6],H[8])?(z(w+2,H[5],H[2]),M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(A(w+2,H[5],H[2],H[6]),z(w+P+2,H[6],H[5]),z(w+(P<<1)+1,H[5],H[8]),O(w+(P<<1)+2,H[6],H[8])),A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]);break;case 241:case 240:x(H[6],H[8])?(M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[8],H[5]),O(w+(P<<1)+2,H[6],H[8])),A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5];break;case 236:case 232:x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6])):(z(w+P,H[5],H[4]),O(w+(P<<1),H[8],H[4]),z(w+(P<<1)+1,H[8],H[5]),A(w+(P<<1)+2,H[5],H[6],H[8])),z(w,H[5],H[1]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]);break;case 109:case 105:x(H[8],H[4])?(z(w,H[5],H[2]),M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(A(w,H[5],H[4],H[2]),z(w+P,H[4],H[5]),O(w+(P<<1),H[8],H[4]),z(w+(P<<1)+1,H[5],H[8])),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1)+2,H[5],H[9]);break;case 171:case 43:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5],z(w+(P<<1),H[5],H[8])):(O(w,H[4],H[2]),z(w+1,H[5],H[2]),z(w+P,H[4],H[5]),A(w+(P<<1),H[5],H[8],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 143:case 15:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5]):(O(w,H[4],H[2]),z(w+1,H[2],H[5]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4])),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 124:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 203:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 62:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 211:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 118:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 217:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 110:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 155:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 188:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 185:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 61:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 157:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 103:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 227:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 230:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 199:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 220:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 158:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 234:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[6]);break;case 242:z(w,H[5],H[1]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[4]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 59:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 121:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 87:z(w,H[5],H[4]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 79:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 122:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 94:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P]=H[5],M[w+P+1]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 218:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 91:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 229:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 167:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 173:z(w,H[5],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 181:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 186:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 115:z(w,H[5],H[4]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 93:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 206:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 205:case 201:z(w,H[5],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?z(w+(P<<1),H[5],H[7]):A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 174:case 46:x(H[4],H[2])?z(w,H[5],H[1]):A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 179:case 147:z(w,H[5],H[4]),M[w+1]=H[5],x(H[2],H[6])?z(w+2,H[5],H[3]):A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 117:case 116:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?z(w+(P<<1)+2,H[5],H[9]):A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 189:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 231:z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 126:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P+1]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 219:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 125:x(H[8],H[4])?(z(w,H[5],H[2]),M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(A(w,H[5],H[4],H[2]),z(w+P,H[4],H[5]),O(w+(P<<1),H[8],H[4]),z(w+(P<<1)+1,H[5],H[8])),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 221:x(H[6],H[8])?(z(w+2,H[5],H[2]),M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(A(w+2,H[5],H[2],H[6]),z(w+P+2,H[6],H[5]),z(w+(P<<1)+1,H[5],H[8]),O(w+(P<<1)+2,H[6],H[8])),z(w,H[5],H[2]),z(w+1,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]);break;case 207:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5]):(O(w,H[4],H[2]),z(w+1,H[2],H[5]),A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4])),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 238:x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6])):(z(w+P,H[5],H[4]),O(w+(P<<1),H[8],H[4]),z(w+(P<<1)+1,H[8],H[5]),A(w+(P<<1)+2,H[5],H[6],H[8])),z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P+1]=H[5],z(w+P+2,H[5],H[6]);break;case 190:x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5],z(w+(P<<1)+2,H[5],H[8])):(z(w+1,H[5],H[2]),O(w+2,H[2],H[6]),z(w+P+2,H[6],H[5]),A(w+(P<<1)+2,H[5],H[6],H[8])),z(w,H[5],H[1]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]);break;case 187:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5],z(w+(P<<1),H[5],H[8])):(O(w,H[4],H[2]),z(w+1,H[5],H[2]),z(w+P,H[4],H[5]),A(w+(P<<1),H[5],H[8],H[4])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 243:x(H[6],H[8])?(M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(z(w+P+2,H[5],H[6]),A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[8],H[5]),O(w+(P<<1)+2,H[6],H[8])),z(w,H[5],H[4]),M[w+1]=H[5],z(w+2,H[5],H[3]),z(w+P,H[5],H[4]),M[w+P+1]=H[5];break;case 119:x(H[2],H[6])?(z(w,H[5],H[4]),M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(A(w,H[5],H[4],H[2]),
z(w+1,H[2],H[5]),O(w+2,H[2],H[6]),z(w+P+2,H[5],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 237:case 233:z(w,H[5],H[2]),z(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?M[w+(P<<1)]=H[5]:A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 175:case 47:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 183:case 151:z(w,H[5],H[4]),M[w+1]=H[5],x(H[2],H[6])?M[w+2]=H[5]:A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],A(w+(P<<1),H[5],H[8],H[4]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 245:case 244:A(w,H[5],H[4],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?M[w+(P<<1)+2]=H[5]:A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 250:z(w,H[5],H[1]),M[w+1]=H[5],z(w+2,H[5],H[3]),M[w+P+1]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4])),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 123:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2])),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?(M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 95:x(H[4],H[2])?(M[w]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+P,H[5],H[4])),M[w+1]=H[5],x(H[2],H[6])?(M[w+2]=H[5],M[w+P+2]=H[5]):(L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[9]);break;case 222:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6])),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 252:z(w,H[5],H[1]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4])),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?M[w+(P<<1)+2]=H[5]:A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 249:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],x(H[8],H[4])?M[w+(P<<1)]=H[5]:A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 235:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2])),z(w+2,H[5],H[3]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?M[w+(P<<1)]=H[5]:A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 111:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?(M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 63:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?(M[w+2]=H[5],M[w+P+2]=H[5]):(L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P]=H[5],M[w+P+1]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[9]);break;case 159:x(H[4],H[2])?(M[w]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+P,H[5],H[4])),M[w+1]=H[5],x(H[2],H[6])?M[w+2]=H[5]:A(w+2,H[5],H[2],H[6]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 215:z(w,H[5],H[4]),M[w+1]=H[5],x(H[2],H[6])?M[w+2]=H[5]:A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 246:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6])),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?M[w+(P<<1)+2]=H[5]:A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 254:z(w,H[5],H[1]),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5]):(G(w+1,H[5],H[2]),L(w+2,H[5],H[2],H[6])),M[w+P+1]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5]):(G(w+P,H[5],H[4]),L(w+(P<<1),H[5],H[8],H[4])),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),G(w+(P<<1)+1,H[5],H[8]),A(w+(P<<1)+2,H[5],H[6],H[8]));break;case 253:z(w,H[5],H[2]),z(w+1,H[5],H[2]),z(w+2,H[5],H[2]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?M[w+(P<<1)]=H[5]:A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?M[w+(P<<1)+2]=H[5]:A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 251:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5]):(L(w,H[5],H[4],H[2]),G(w+1,H[5],H[2])),z(w+2,H[5],H[3]),M[w+P+1]=H[5],x(H[8],H[4])?(M[w+P]=H[5],M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(G(w+P,H[5],H[4]),A(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),x(H[6],H[8])?(M[w+P+2]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+P+2,H[5],H[6]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 239:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),M[w+1]=H[5],z(w+2,H[5],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],z(w+P+2,H[5],H[6]),x(H[8],H[4])?M[w+(P<<1)]=H[5]:A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],z(w+(P<<1)+2,H[5],H[6]);break;case 127:x(H[4],H[2])?(M[w]=H[5],M[w+1]=H[5],M[w+P]=H[5]):(A(w,H[5],H[4],H[2]),G(w+1,H[5],H[2]),G(w+P,H[5],H[4])),x(H[2],H[6])?(M[w+2]=H[5],M[w+P+2]=H[5]):(L(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P+1]=H[5],x(H[8],H[4])?(M[w+(P<<1)]=H[5],M[w+(P<<1)+1]=H[5]):(L(w+(P<<1),H[5],H[8],H[4]),G(w+(P<<1)+1,H[5],H[8])),z(w+(P<<1)+2,H[5],H[9]);break;case 191:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?M[w+2]=H[5]:A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[8]),z(w+(P<<1)+1,H[5],H[8]),z(w+(P<<1)+2,H[5],H[8]);break;case 223:x(H[4],H[2])?(M[w]=H[5],M[w+P]=H[5]):(L(w,H[5],H[4],H[2]),G(w+P,H[5],H[4])),x(H[2],H[6])?(M[w+1]=H[5],M[w+2]=H[5],M[w+P+2]=H[5]):(G(w+1,H[5],H[2]),A(w+2,H[5],H[2],H[6]),G(w+P+2,H[5],H[6])),M[w+P+1]=H[5],z(w+(P<<1),H[5],H[7]),x(H[6],H[8])?(M[w+(P<<1)+1]=H[5],M[w+(P<<1)+2]=H[5]):(G(w+(P<<1)+1,H[5],H[8]),L(w+(P<<1)+2,H[5],H[6],H[8]));break;case 247:z(w,H[5],H[4]),M[w+1]=H[5],x(H[2],H[6])?M[w+2]=H[5]:A(w+2,H[5],H[2],H[6]),z(w+P,H[5],H[4]),M[w+P+1]=H[5],M[w+P+2]=H[5],z(w+(P<<1),H[5],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?M[w+(P<<1)+2]=H[5]:A(w+(P<<1)+2,H[5],H[6],H[8]);break;case 255:x(H[4],H[2])?M[w]=H[5]:A(w,H[5],H[4],H[2]),M[w+1]=H[5],x(H[2],H[6])?M[w+2]=H[5]:A(w+2,H[5],H[2],H[6]),M[w+P]=H[5],M[w+P+1]=H[5],M[w+P+2]=H[5],x(H[8],H[4])?M[w+(P<<1)]=H[5]:A(w+(P<<1),H[5],H[8],H[4]),M[w+(P<<1)+1]=H[5],x(H[6],H[8])?M[w+(P<<1)+2]=H[5]:A(w+(P<<1)+2,H[5],H[6],H[8])}D++,w+=3}w+=P<<1}},w=function(e,i){var r,_,E,T,k,H,P,w=[],D=e<<2,x=0,S=0,R=m,z=u,A=h,G=v,L=g,O=p,C=f,M=I,W=y,B=b,N=a,F=t,V=s,Y=n,U=o,j=l,q=c,Z=d;for(_=0;i>_;_++){for(T=_>0?-e:0,k=i-1>_?e:0,r=0;e>r;r++){w[2]=N[S+T],w[5]=N[S],w[8]=N[S+k],r>0?(w[1]=N[S+T-1],w[4]=N[S-1],w[7]=N[S+k-1]):(w[1]=w[2],w[4]=w[5],w[7]=w[8]),e-1>r?(w[3]=N[S+T+1],w[6]=N[S+1],w[9]=N[S+k+1]):(w[3]=w[2],w[6]=w[5],w[9]=w[8]);var J=0,X=1;for(H=A(w[5]),E=1;10>E;E++)5!==E&&(w[E]!==w[5]&&(P=A(w[E]),(z.abs((H&V)-(P&V))>j||z.abs((H&Y)-(P&Y))>q||z.abs((H&U)-(P&U))>Z)&&(J|=X)),X<<=1);switch(J){case 0:case 1:case 4:case 32:case 128:case 5:case 132:case 160:case 33:case 129:case 36:case 133:case 164:case 161:case 37:case 165:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 2:case 34:case 130:case 162:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 16:case 17:case 48:case 49:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 64:case 65:case 68:case 69:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 8:case 12:case 136:case 140:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 3:case 35:case 131:case 163:B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 6:case 38:case 134:case 166:B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 20:case 21:case 52:case 53:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 144:case 145:case 176:case 177:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 192:case 193:case 196:case 197:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 96:case 97:case 100:case 101:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 40:case 44:case 168:case 172:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 9:case 13:case 137:case 141:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 18:case 50:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),F[x+D+2]=w[5],C(x+D+3,w[6],w[5])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 80:case 81:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 72:case 76:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(C(x+(D<<1),w[4],w[5]),F[x+(D<<1)+1]=w[5],C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 10:case 138:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5]),F[x+D+1]=w[5]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 66:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 24:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 7:case 39:case 135:B(x,w[5],w[4]),O(x+1,w[5],w[4]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 148:case 149:case 180:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 224:case 228:case 225:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 41:case 169:case 45:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 22:case 54:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 208:case 209:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 104:case 108:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 11:case 139:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 19:case 51:R(w[2],w[6])?(B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x,w[5],w[2]),G(x+1,w[2],w[5]),B(x+2,w[2],w[6]),C(x+3,w[2],w[6]),W(x+D+2,w[5],w[6],w[2]),L(x+D+3,w[6],w[5],w[2])),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 146:case 178:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D+3,w[5],w[8])):(L(x+2,w[2],w[5],w[6]),C(x+3,w[2],w[6]),W(x+D+2,w[5],w[6],w[2]),B(x+D+3,w[6],w[2]),G(x+(D<<1)+3,w[6],w[5]),G(x+3*D+3,w[5],w[6])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),B(x+3*D+2,w[5],w[8]);break;case 84:case 85:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),B(x+2,w[5],w[2]),R(w[6],w[8])?(B(x+3,w[5],w[2]),O(x+D+3,w[5],w[2]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(G(x+3,w[5],w[6]),G(x+D+3,w[6],w[5]),W(x+(D<<1)+2,w[5],w[6],w[8]),B(x+(D<<1)+3,w[6],w[8]),L(x+3*D+2,w[8],w[5],w[6]),C(x+3*D+3,w[8],w[6])),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[2]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 112:case 113:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(W(x+(D<<1)+2,w[5],w[6],w[8]),L(x+(D<<1)+3,w[6],w[5],w[8]),G(x+3*D,w[5],w[8]),G(x+3*D+1,w[8],w[5]),B(x+3*D+2,w[8],w[6]),C(x+3*D+3,w[8],w[6]));break;case 200:case 204:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6])):(L(x+(D<<1),w[4],w[5],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),C(x+3*D,w[8],w[4]),B(x+3*D+1,w[8],w[4]),G(x+3*D+2,w[8],w[5]),G(x+3*D+3,w[5],w[8])),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]);break;case 73:case 77:R(w[8],w[4])?(B(x,w[5],w[2]),O(x+D,w[5],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x,w[5],w[4]),G(x+D,w[4],w[5]),B(x+(D<<1),w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),C(x+3*D,w[8],w[4]),L(x+3*D+1,w[8],w[5],w[4])),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),O(x+D+1,w[5],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 42:case 170:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+(D<<1),w[5],w[8]),B(x+3*D,w[5],w[8])):(C(x,w[2],w[4]),L(x+1,w[2],w[5],w[4]),B(x+D,w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),G(x+(D<<1),w[4],w[5]),G(x+3*D,w[5],w[4])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),O(x+(D<<1)+1,w[5],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 14:case 142:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(C(x,w[2],w[4]),B(x+1,w[2],w[4]),G(x+2,w[2],w[5]),G(x+3,w[5],w[2]),L(x+D,w[4],w[5],w[2]),W(x+D+1,w[5],w[4],w[2])),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 67:B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 70:B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 28:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 152:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 194:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 98:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 56:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 25:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 26:case 31:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),F[x+D+1]=w[5],F[x+D+2]=w[5],G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 82:case 214:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 88:case 248:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6]));break;case 74:case 107:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 27:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 86:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 216:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 106:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 30:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 210:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 120:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 75:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 29:B(x,w[5],w[2]),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 198:B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 184:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 99:B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 57:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),
B(x+3*D+3,w[5],w[9]);break;case 71:B(x,w[5],w[4]),O(x+1,w[5],w[4]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 156:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 226:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 60:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 195:B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 102:B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 153:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 58:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 83:B(x,w[5],w[4]),O(x+1,w[5],w[4]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 92:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 202:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 78:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 154:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 114:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6])),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]);break;case 89:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 90:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 55:case 23:R(w[2],w[6])?(B(x,w[5],w[4]),O(x+1,w[5],w[4]),F[x+2]=w[5],F[x+3]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5]):(G(x,w[5],w[2]),G(x+1,w[2],w[5]),B(x+2,w[2],w[6]),C(x+3,w[2],w[6]),W(x+D+2,w[5],w[6],w[2]),L(x+D+3,w[6],w[5],w[2])),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 182:case 150:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5],O(x+(D<<1)+3,w[5],w[8]),B(x+3*D+3,w[5],w[8])):(L(x+2,w[2],w[5],w[6]),C(x+3,w[2],w[6]),W(x+D+2,w[5],w[6],w[2]),B(x+D+3,w[6],w[2]),G(x+(D<<1)+3,w[6],w[5]),G(x+3*D+3,w[5],w[6])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),B(x+3*D+2,w[5],w[8]);break;case 213:case 212:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),B(x+2,w[5],w[2]),R(w[6],w[8])?(B(x+3,w[5],w[2]),O(x+D+3,w[5],w[2]),F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(G(x+3,w[5],w[6]),G(x+D+3,w[6],w[5]),W(x+(D<<1)+2,w[5],w[6],w[8]),B(x+(D<<1)+3,w[6],w[8]),L(x+3*D+2,w[8],w[5],w[6]),C(x+3*D+3,w[8],w[6])),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[2]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 241:case 240:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),R(w[6],w[8])?(F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(W(x+(D<<1)+2,w[5],w[6],w[8]),L(x+(D<<1)+3,w[6],w[5],w[8]),G(x+3*D,w[5],w[8]),G(x+3*D+1,w[8],w[5]),B(x+3*D+2,w[8],w[6]),C(x+3*D+3,w[8],w[6]));break;case 236:case 232:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5],O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6])):(L(x+(D<<1),w[4],w[5],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),C(x+3*D,w[8],w[4]),B(x+3*D+1,w[8],w[4]),G(x+3*D+2,w[8],w[5]),G(x+3*D+3,w[5],w[8])),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]);break;case 109:case 105:R(w[8],w[4])?(B(x,w[5],w[2]),O(x+D,w[5],w[2]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(G(x,w[5],w[4]),G(x+D,w[4],w[5]),B(x+(D<<1),w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),C(x+3*D,w[8],w[4]),L(x+3*D+1,w[8],w[5],w[4])),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),O(x+D+1,w[5],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 171:case 43:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5],F[x+D+1]=w[5],O(x+(D<<1),w[5],w[8]),B(x+3*D,w[5],w[8])):(C(x,w[2],w[4]),L(x+1,w[2],w[5],w[4]),B(x+D,w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),G(x+(D<<1),w[4],w[5]),G(x+3*D,w[5],w[4])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),O(x+(D<<1)+1,w[5],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 143:case 15:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),F[x+D]=w[5],F[x+D+1]=w[5]):(C(x,w[2],w[4]),B(x+1,w[2],w[4]),G(x+2,w[2],w[5]),G(x+3,w[5],w[2]),L(x+D,w[4],w[5],w[2]),W(x+D+1,w[5],w[4],w[2])),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 124:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 203:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 62:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 211:B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 118:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 217:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 110:B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 155:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 188:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 185:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 61:B(x,w[5],w[2]),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 157:B(x,w[5],w[2]),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 103:B(x,w[5],w[4]),O(x+1,w[5],w[4]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 227:B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 230:B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 199:B(x,w[5],w[4]),O(x+1,w[5],w[4]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 220:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6]));break;case 158:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),F[x+D+2]=w[5],G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 234:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 242:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]);break;case 59:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),F[x+D+1]=w[5],O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 121:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 87:B(x,w[5],w[4]),O(x+1,w[5],w[4]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),F[x+D+2]=w[5],M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 79:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),F[x+D+1]=w[5],O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 122:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 94:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),F[x+D+2]=w[5],R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 218:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6]));break;case 91:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),F[x+D+1]=w[5],R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 229:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 167:B(x,w[5],w[4]),O(x+1,w[5],w[4]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 173:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 181:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 186:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 115:B(x,w[5],w[4]),O(x+1,w[5],w[4]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6])),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]);break;case 93:B(x,w[5],w[2]),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6]));break;case 206:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 205:case 201:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),R(w[8],w[4])?(G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7])):(G(x+(D<<1),w[5],w[4]),F[x+(D<<1)+1]=w[5],L(x+3*D,w[5],w[8],w[4]),G(x+3*D+1,w[5],w[8])),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 174:case 46:R(w[4],w[2])?(B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1])):(L(x,w[5],w[2],w[4]),G(x+1,w[5],w[2]),G(x+D,w[5],w[4]),F[x+D+1]=w[5]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 179:case 147:B(x,w[5],w[4]),O(x+1,w[5],w[4]),R(w[2],w[6])?(G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3])):(G(x+2,w[5],w[2]),L(x+3,w[5],w[2],w[6]),F[x+D+2]=w[5],G(x+D+3,w[5],w[6])),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 117:case 116:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),R(w[6],w[8])?(O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9])):(F[x+(D<<1)+2]=w[5],G(x+(D<<1)+3,w[5],w[6]),G(x+3*D+2,w[5],w[8]),L(x+3*D+3,w[5],w[8],w[6])),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]);break;case 189:B(x,w[5],w[2]),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 231:B(x,w[5],w[4]),O(x+1,w[5],w[4]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 126:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 219:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 125:R(w[8],w[4])?(B(x,w[5],w[2]),O(x+D,w[5],w[2]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(G(x,w[5],w[4]),G(x+D,w[4],w[5]),B(x+(D<<1),w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),C(x+3*D,w[8],w[4]),L(x+3*D+1,w[8],w[5],w[4])),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 221:B(x,w[5],w[2]),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),R(w[6],w[8])?(B(x+3,w[5],w[2]),O(x+D+3,w[5],w[2]),F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(G(x+3,w[5],w[6]),G(x+D+3,w[6],w[5]),W(x+(D<<1)+2,w[5],w[6],w[8]),B(x+(D<<1)+3,w[6],w[8]),L(x+3*D+2,w[8],w[5],w[6]),C(x+3*D+3,w[8],w[6])),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 207:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),F[x+D]=w[5],F[x+D+1]=w[5]):(C(x,w[2],w[4]),B(x+1,w[2],w[4]),G(x+2,w[2],w[5]),G(x+3,w[5],w[2]),L(x+D,w[4],w[5],w[2]),W(x+D+1,w[5],w[4],w[2])),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 238:B(x,w[5],w[1]),G(x+1,w[5],w[1]),O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),
G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5],O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6])):(L(x+(D<<1),w[4],w[5],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),C(x+3*D,w[8],w[4]),B(x+3*D+1,w[8],w[4]),G(x+3*D+2,w[8],w[5]),G(x+3*D+3,w[5],w[8])),O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]);break;case 190:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5],O(x+(D<<1)+3,w[5],w[8]),B(x+3*D+3,w[5],w[8])):(L(x+2,w[2],w[5],w[6]),C(x+3,w[2],w[6]),W(x+D+2,w[5],w[6],w[2]),B(x+D+3,w[6],w[2]),G(x+(D<<1)+3,w[6],w[5]),G(x+3*D+3,w[5],w[6])),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]);break;case 187:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5],F[x+D+1]=w[5],O(x+(D<<1),w[5],w[8]),B(x+3*D,w[5],w[8])):(C(x,w[2],w[4]),L(x+1,w[2],w[5],w[4]),B(x+D,w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),G(x+(D<<1),w[4],w[5]),G(x+3*D,w[5],w[4])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 243:B(x,w[5],w[4]),O(x+1,w[5],w[4]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),R(w[6],w[8])?(F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(W(x+(D<<1)+2,w[5],w[6],w[8]),L(x+(D<<1)+3,w[6],w[5],w[8]),G(x+3*D,w[5],w[8]),G(x+3*D+1,w[8],w[5]),B(x+3*D+2,w[8],w[6]),C(x+3*D+3,w[8],w[6]));break;case 119:R(w[2],w[6])?(B(x,w[5],w[4]),O(x+1,w[5],w[4]),F[x+2]=w[5],F[x+3]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5]):(G(x,w[5],w[2]),G(x+1,w[2],w[5]),B(x+2,w[2],w[6]),C(x+3,w[2],w[6]),W(x+D+2,w[5],w[6],w[2]),L(x+D+3,w[6],w[5],w[2])),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 237:case 233:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[6]),L(x+3,w[5],w[2],w[6]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),W(x+D+2,w[5],w[6],w[2]),M(x+D+3,w[5],w[6],w[2]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),R(w[8],w[4])?F[x+3*D]=w[5]:L(x+3*D,w[5],w[8],w[4]),F[x+3*D+1]=w[5],O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 175:case 47:R(w[4],w[2])?F[x]=w[5]:L(x,w[5],w[2],w[4]),F[x+1]=w[5],O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),F[x+D]=w[5],F[x+D+1]=w[5],O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),W(x+(D<<1)+2,w[5],w[6],w[8]),M(x+(D<<1)+3,w[5],w[6],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[6]),L(x+3*D+3,w[5],w[8],w[6]);break;case 183:case 151:B(x,w[5],w[4]),O(x+1,w[5],w[4]),F[x+2]=w[5],R(w[2],w[6])?F[x+3]=w[5]:L(x+3,w[5],w[2],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),F[x+D+2]=w[5],F[x+D+3]=w[5],M(x+(D<<1),w[5],w[4],w[8]),W(x+(D<<1)+1,w[5],w[4],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),L(x+3*D,w[5],w[8],w[4]),M(x+3*D+1,w[5],w[8],w[4]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 245:case 244:L(x,w[5],w[2],w[4]),M(x+1,w[5],w[2],w[4]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),M(x+D,w[5],w[4],w[2]),W(x+D+1,w[5],w[4],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),F[x+3*D+2]=w[5],R(w[6],w[8])?F[x+3*D+3]=w[5]:L(x+3*D+3,w[5],w[8],w[6]);break;case 250:B(x,w[5],w[1]),G(x+1,w[5],w[1]),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6]));break;case 123:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 95:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),F[x+D+1]=w[5],F[x+D+2]=w[5],G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 222:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 252:B(x,w[5],w[1]),M(x+1,w[5],w[2],w[1]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],R(w[6],w[8])?F[x+3*D+3]=w[5]:L(x+3*D+3,w[5],w[8],w[6]);break;case 249:B(x,w[5],w[2]),B(x+1,w[5],w[2]),M(x+2,w[5],w[2],w[3]),B(x+3,w[5],w[3]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),R(w[8],w[4])?F[x+3*D]=w[5]:L(x+3*D,w[5],w[8],w[4]),F[x+3*D+1]=w[5];break;case 235:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),M(x+D+3,w[5],w[6],w[3]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),R(w[8],w[4])?F[x+3*D]=w[5]:L(x+3*D,w[5],w[8],w[4]),F[x+3*D+1]=w[5],O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 111:R(w[4],w[2])?F[x]=w[5]:L(x,w[5],w[2],w[4]),F[x+1]=w[5],O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),F[x+D]=w[5],F[x+D+1]=w[5],O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),M(x+(D<<1)+3,w[5],w[6],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 63:R(w[4],w[2])?F[x]=w[5]:L(x,w[5],w[2],w[4]),F[x+1]=w[5],R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),F[x+D]=w[5],F[x+D+1]=w[5],F[x+D+2]=w[5],O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),M(x+3*D+2,w[5],w[8],w[9]),B(x+3*D+3,w[5],w[9]);break;case 159:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),F[x+2]=w[5],R(w[2],w[6])?F[x+3]=w[5]:L(x+3,w[5],w[2],w[6]),F[x+D+1]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5],G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[7]),M(x+3*D+1,w[5],w[8],w[7]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 215:B(x,w[5],w[4]),O(x+1,w[5],w[4]),F[x+2]=w[5],R(w[2],w[6])?F[x+3]=w[5]:L(x+3,w[5],w[2],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),F[x+D+2]=w[5],F[x+D+3]=w[5],M(x+(D<<1),w[5],w[4],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 246:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),M(x+D,w[5],w[4],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),F[x+3*D+2]=w[5],R(w[6],w[8])?F[x+3*D+3]=w[5]:L(x+3*D+3,w[5],w[8],w[6]);break;case 254:B(x,w[5],w[1]),G(x+1,w[5],w[1]),R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),G(x+D,w[5],w[1]),O(x+D+1,w[5],w[1]),F[x+D+2]=w[5],R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],R(w[6],w[8])?F[x+3*D+3]=w[5]:L(x+3*D+3,w[5],w[8],w[6]);break;case 253:B(x,w[5],w[2]),B(x+1,w[5],w[2]),B(x+2,w[5],w[2]),B(x+3,w[5],w[2]),O(x+D,w[5],w[2]),O(x+D+1,w[5],w[2]),O(x+D+2,w[5],w[2]),O(x+D+3,w[5],w[2]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],R(w[8],w[4])?F[x+3*D]=w[5]:L(x+3*D,w[5],w[8],w[4]),F[x+3*D+1]=w[5],F[x+3*D+2]=w[5],R(w[6],w[8])?F[x+3*D+3]=w[5]:L(x+3*D+3,w[5],w[8],w[6]);break;case 251:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),G(x+2,w[5],w[3]),B(x+3,w[5],w[3]),F[x+D+1]=w[5],O(x+D+2,w[5],w[3]),G(x+D+3,w[5],w[3]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),R(w[8],w[4])?F[x+3*D]=w[5]:L(x+3*D,w[5],w[8],w[4]),F[x+3*D+1]=w[5];break;case 239:R(w[4],w[2])?F[x]=w[5]:L(x,w[5],w[2],w[4]),F[x+1]=w[5],O(x+2,w[5],w[6]),B(x+3,w[5],w[6]),F[x+D]=w[5],F[x+D+1]=w[5],O(x+D+2,w[5],w[6]),B(x+D+3,w[5],w[6]),F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[6]),B(x+(D<<1)+3,w[5],w[6]),R(w[8],w[4])?F[x+3*D]=w[5]:L(x+3*D,w[5],w[8],w[4]),F[x+3*D+1]=w[5],O(x+3*D+2,w[5],w[6]),B(x+3*D+3,w[5],w[6]);break;case 127:R(w[4],w[2])?F[x]=w[5]:L(x,w[5],w[2],w[4]),F[x+1]=w[5],R(w[2],w[6])?(F[x+2]=w[5],F[x+3]=w[5],F[x+D+3]=w[5]):(C(x+2,w[2],w[5]),C(x+3,w[2],w[6]),C(x+D+3,w[6],w[5])),F[x+D]=w[5],F[x+D+1]=w[5],F[x+D+2]=w[5],R(w[8],w[4])?(F[x+(D<<1)]=w[5],F[x+3*D]=w[5],F[x+3*D+1]=w[5]):(C(x+(D<<1),w[4],w[5]),C(x+3*D,w[8],w[4]),C(x+3*D+1,w[8],w[5])),F[x+(D<<1)+1]=w[5],O(x+(D<<1)+2,w[5],w[9]),G(x+(D<<1)+3,w[5],w[9]),G(x+3*D+2,w[5],w[9]),B(x+3*D+3,w[5],w[9]);break;case 191:R(w[4],w[2])?F[x]=w[5]:L(x,w[5],w[2],w[4]),F[x+1]=w[5],F[x+2]=w[5],R(w[2],w[6])?F[x+3]=w[5]:L(x+3,w[5],w[2],w[6]),F[x+D]=w[5],F[x+D+1]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5],O(x+(D<<1),w[5],w[8]),O(x+(D<<1)+1,w[5],w[8]),O(x+(D<<1)+2,w[5],w[8]),O(x+(D<<1)+3,w[5],w[8]),B(x+3*D,w[5],w[8]),B(x+3*D+1,w[5],w[8]),B(x+3*D+2,w[5],w[8]),B(x+3*D+3,w[5],w[8]);break;case 223:R(w[4],w[2])?(F[x]=w[5],F[x+1]=w[5],F[x+D]=w[5]):(C(x,w[2],w[4]),C(x+1,w[2],w[5]),C(x+D,w[4],w[5])),F[x+2]=w[5],R(w[2],w[6])?F[x+3]=w[5]:L(x+3,w[5],w[2],w[6]),F[x+D+1]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5],G(x+(D<<1),w[5],w[7]),O(x+(D<<1)+1,w[5],w[7]),F[x+(D<<1)+2]=w[5],R(w[6],w[8])?(F[x+(D<<1)+3]=w[5],F[x+3*D+2]=w[5],F[x+3*D+3]=w[5]):(C(x+(D<<1)+3,w[6],w[5]),C(x+3*D+2,w[8],w[5]),C(x+3*D+3,w[8],w[6])),B(x+3*D,w[5],w[7]),G(x+3*D+1,w[5],w[7]);break;case 247:B(x,w[5],w[4]),O(x+1,w[5],w[4]),F[x+2]=w[5],R(w[2],w[6])?F[x+3]=w[5]:L(x+3,w[5],w[2],w[6]),B(x+D,w[5],w[4]),O(x+D+1,w[5],w[4]),F[x+D+2]=w[5],F[x+D+3]=w[5],B(x+(D<<1),w[5],w[4]),O(x+(D<<1)+1,w[5],w[4]),F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],B(x+3*D,w[5],w[4]),O(x+3*D+1,w[5],w[4]),F[x+3*D+2]=w[5],R(w[6],w[8])?F[x+3*D+3]=w[5]:L(x+3*D+3,w[5],w[8],w[6]);break;case 255:R(w[4],w[2])?F[x]=w[5]:L(x,w[5],w[2],w[4]),F[x+1]=w[5],F[x+2]=w[5],R(w[2],w[6])?F[x+3]=w[5]:L(x+3,w[5],w[2],w[6]),F[x+D]=w[5],F[x+D+1]=w[5],F[x+D+2]=w[5],F[x+D+3]=w[5],F[x+(D<<1)]=w[5],F[x+(D<<1)+1]=w[5],F[x+(D<<1)+2]=w[5],F[x+(D<<1)+3]=w[5],R(w[8],w[4])?F[x+3*D]=w[5]:L(x+3*D,w[5],w[8],w[4]),F[x+3*D+1]=w[5],F[x+3*D+2]=w[5],R(w[6],w[8])?F[x+3*D+3]=w[5]:L(x+3*D+3,w[5],w[8],w[6])}S++,x+=4}x+=3*D}}}(this),function(e){e.fn.translate=function(a){var t=this,i={css:"trn",attrs:["alt","placeholder","title"],lang:"pt",langDefault:"pt"};i=e.extend(i,a||{}),0!==i.css.lastIndexOf(".",0)&&(i.css="."+i.css);var r=i.t;return this.lang=function(e){return e&&(i.lang=e,this.translate(i)),i.lang},this.get=function(e){var a=e;try{a=r[e][i.lang]}catch(a){return e}return a?a:e},this.g=this.get,this.find(i.css).each(function(a){var r=e(this),s=r.attr("data-trn-key");s||(s=r.html(),r.attr("data-trn-key",s)),e.each(this.attributes,function(){if(e.inArray(this.name,i.attrs)!==-1){var a=r.attr("data-trn-attr");a||(a=r.attr(this.name),r.attr("data-trn-attr",a)),r.attr(this.name,t.get(a))}}),r.html(t.get(s))}),this}}(jQuery);var VINTAGE=new VINTAGE_CLASS,SIFT=new SIFT_CLASS,HELPER=new HELPER_CLASS,POP=new popup,dict_es={"2d":{es:"2d"},"3D position:":{es:"Posicin 3d:"},"3D size:":{es:"3d tamao:"},About:{es:"Acerca de"},"Add new layer":{es:"Aadir nueva capa"},All:{es:"Todas"},Alpha:{es:"Alfa"},"Alpha:":{es:"Alfa:"},"Amount:":{es:"Cantidad:"},Anonymous:{es:"Annimo"},"Anti aliasing":{es:"Submuestreo"},"Area:":{es:"Zona:"},Arial:{es:"Arial"},Arrow:{es:"Flecha"},"Arrow keys":{es:"Teclas de flecha"},Attributes:{es:"Atributos"},"Author:":{es:"Autor:"},"Auto adjust colors":{es:"Ajuste automtico de colores"},"Auto colorize":{es:"Colorear auto"},"Average:":{es:"Promedio:"},"BMP - Windows Bitmap":{es:"Bmp - ventanas de mapa de bits"},Background:{es:"Fondo"},Basic:{es:"Basic"},BezierCurve:{es:"Curva de bzier"},"Big grains level:":{es:"Granos grandes de nivel:"},"Black and White":{es:"En blanco y negro"},Blend:{es:"Mezcla"},"Blend:":{es:"Mezcla:"},Blue:{es:"Azul"},"Blue channel:":{es:"Canal azul:"},Blur:{es:"Difuminar"},"Blur Radius:":{es:"Radio de desenfoque:"},"Blur tool":{es:"Herramienta de desenfoque"},"Blur-Box":{es:"Falta de definicin de la caja"},"Blur-Gaussian":{es:"Desenfoque gaussiano"},"Blur-Stack":{es:"Blur-pila"},"Blur-Zoom":{es:"Blur-zoom"},"Blur:":{es:"Difuminar:"},Bold:{es:"Negrita"},"Bold Italic":{es:"Negrita cursiva"},Borders:{es:"Fronteras"},Both:{es:"Ambos"},"Bottom-left":{es:"Abajo a la izquierda"},"Bottom-right":{es:"Abajo a la derecha"},"Brightness Contrast":{es:"Contraste de brillo"},"Brightness:":{es:"Brillo:"},Brush:{es:"Cepillo"},"Brush styles":{es:"Estilos de pincel"},"Bulge/Pinch":{es:"Abultamiento / pizca"},Burn:{es:"Quemar"},"Burn/Dodge tool":{es:"Burn herramienta / esquivar"},"CTRL + Arrow keys":{es:"Ctrl + teclas de flecha"},Cancel:{es:"Cancelar"},"Center x:":{es:"Centro de x:"},"Center y:":{es:"Centro y:"},"Center:":{es:"Centrar:"},"Channel:":{es:"Canal:"},Chrome:{es:"Cromo"},Circle:{es:"Circulo"},Clear:{es:"Claro"},"Clear selection":{es:"Seleccin clara"},"Clone tool":{es:"Herramienta de clonacin"},"Color #1:":{es:"Color # 1:"},"Color #2:":{es:"Color # 2:"},"Color Zoom":{es:"Zoom de color"},"Color adjust:":{es:"Ajuste de color:"},"Color corrections":{es:"Correcciones de color"},"Color to Alpha":{es:"Color a alfa"},"Color to alpha":{es:"Color a alfa"},"Color:":{es:"Color:"},Colorize:{es:"Colorear"},"Colors:":{es:"Colores:"},Composite:{es:"Compuesto"},"Composition:":{es:"Composicin:"},"Contrast:":{es:"Contraste:"},"Copy selection":{es:"Seleccin de copia"},Courier:{es:"Mensajero"},Crop:{es:"Cultivo"},"Crop Selection":{es:"Seleccin de cultivos"},Curve:{es:"Curva"},"Cut selection":{es:"Cortar la seleccin"},"Decrease color depth":{es:"Disminuir la profundidad de color"},"Decrease colors":{es:"Disminuir los colores"},Default:{es:"Defecto"},Del:{es:"Del"},Delete:{es:"Borrar"},"Delete selection":{es:"Eliminar la seleccin"},Denoise:{es:"Eliminacin de ruido"},Desaturate:{es:"Desaturar"},"Desaturation:":{es:"Desaturacin:"},"Description:":{es:"Descripcin:"},Differences:{es:"Diferencias"},"Differences Down":{es:"Diferencias abajo"},Dither:{es:"Vacilar"},"Dithering:":{es:"Difuminado:"},"Dot Screen":{es:"Trama de puntos"},Down:{es:"Abajo"},Downloaded:{es:"Descargado"},"Drag & Drop":{es:"Arrastrar y soltar"},"Draw circle":{es:"Dibujar crculo"},"Draw letters":{es:"Dibujar letras"},"Draw line":{es:"Dibujar linea"},"Draw rectangle":{es:"Dibujar rectngulo"},Dublicate:{es:"Dublicate"},"Dusts level:":{es:"Los polvos nivel:"},Edge:{es:"Borde"},Edit:{es:"Editar"},Effects:{es:"Efectos"},"Effects library":{es:"Librera de efectos"},"Email:":{es:"Email:"},Emboss:{es:"Realzar"},"Empty data":{es:"De datos vaca"},English:{es:"Ingls"},Enrich:{es:"Enriquecer"},"Enter angle (0-360):":{es:"Introduzca el ngulo (0-360):"},Erase:{es:"Borrar"},Error:{es:"Error"},"Error, can not find active layer.":{es:"Error, no se puede encontrar capa activa."},"Error:":{es:"Error:"},"Exponent:":{es:"Exponente:"},"Exposure level:":{es:"Nivel de exposicin:"},"Factor:":{es:"Factor:"},File:{es:"Archivo"},"File name:":{es:"Nombre del archivo:"},Fill:{es:"Llenar"},"Fill style:":{es:"Estilo de relleno:"},"Flatten Image":{es:"Imagen aplanada"},Flip:{es:"Dar la vuelta"},"Font family:":{es:"Familia tipogrfica:"},"Font style:":{es:"Estilo de fuente:"},Fur:{es:"Pelaje"},Gamma:{es:"Gama"},"Gamma:":{es:"Gama:"},"Gap:":{es:"Brecha:"},Gradient:{es:"Gradiente"},"Gradient Radius:":{es:"Radio de gradiente:"},Grains:{es:"Granos"},"Grains level:":{es:"Granos nivel:"},Gray:{es:"Gris"},GrayScale:{es:"Escala de grises"},Green:{es:"Verde"},"Green channel:":{es:"Canal verde:"},"Greyscale:":{es:"Escala de grises:"},Grid:{es:"Cuadrcula"},"Grid on/off":{es:"Rejilla de encendido / apagado"},Grouped:{es:"Agrupados"},"H Radius:":{es:"Radio h:"},"HSL Adjustment":{es:"Ajuste de hsl"},Harmony:{es:"Armona"},Heatmap:{es:"Mapa de calor"},"Height (%):":{es:"Altura (%):"},"Height (pixels):":{es:"Altura (pxeles):"},"Height:":{es:"Altura:"},Help:{es:"Ayuda"},Helvetica:{es:"Helvetica"},Hermite:{es:"Hermite"},Histogram:{es:"Histograma"},"Histogram:":{es:"Histograma:"},Horizontal:{es:"Horizontal"},"Horizontal gap:":{es:"Brecha horizontal:"},"Hue:":{es:"Matiz:"},Image:{es:"Imagen"},"Image filters":{es:"Filtros de imagen"},Impact:{es:"Impacto"},"Imports images":{es:"Importa imgenes"},Information:{es:"Informacin"},"Invalid color component":{es:"Componente de color no vlido"},Italic:{es:"Itlico"},"JPG - JPG/JPEG Format":{es:"Jpg - formato jpg / jpeg"},"JPG Compression":{es:"Compresin jpg"},"JSON - Full layers data":{es:"Json - capas de datos completos"},"KD-tree":{es:"Kd-tree"},"Key-points":{es:"Puntos clave"},"Keyboard Shortcuts":{es:"Atajos de teclado"},Language:{es:"Idioma"},Layer:{es:"Capa"},"Layer #":{es:"La capa #"},Layers:{es:"Capas"},Left:{es:"Izquierda"},"Level:":{es:"Nivel:"},"Levels:":{es:"Niveles:"},"Lietuvi":{es:"Lietuvi"},"Light leak:":{es:"Fuga de luz:"},"Limit:":{es:"Lmite:"},"Luminance:":{es:"Luminancia:"},"Luminosity:":{es:"Luminosidad:"},"Magic Wand Tool":{es:"Varita mgica"},Merge:{es:"Unir"},"Merge Down":{es:"Fusionar"},"Mode:":{es:"Modo:"},Mosaic:{es:"Mosaico"},"Mouse:":{es:"Ratn:"},Move:{es:"Movimiento"},"Move active layer by 10px":{es:"Mover la capa activa de 10px"},"Move active layer by 1px":{es:"Mover la capa activa de 1px"},"Move active layer by 50px":{es:"Mover la capa activa de 50 px"},"Move down":{es:"Mover hacia abajo"},"Move up":{es:"Ascender"},"Multi-line":{es:"Multilnea"},"Name:":{es:"Nombre:"},Negative:{es:"Negativo"},New:{es:"Nuevo"},"New file...":{es:"Archivo nuevo..."},"New layer":{es:"Nueva capa"},No:{es:"No"},Normal:{es:"Normal"},Notice:{es:"Darse cuenta"},"Notice:":{es:"Darse cuenta:"},Oil:{es:"Petrleo"},Ok:{es:"De acuerdo"},"Online image editor":{es:"Editor de imgenes en lnea"},Opacity:{es:"Opacidad"},Open:{es:"Abierto"},"Open file(s)":{es:"Abrir archivos)"},"PNG - Portable Network Graphics":{es:"Png - portable network graphics"},Paste:{es:"Pegar"},"Paste selection":{es:"La seleccin de pasta"},Pencil:{es:"Lpiz"},Perspective:{es:"Perspectiva"},"Pick Color":{es:"Color de la seleccin"},Posterize:{es:"Posterizar"},"Power:":{es:"Poder:"},"Pre-Blur:":{es:"Pre-desenfoque:"},Preview:{es:"Avance"},Print:{es:"Impresin"},"Quality (jpeg):":{es:"Calidad (jpeg):"},"Quality:":{es:"Calidad:"},Radial:{es:"Radial"},"Radius:":{es:"Radio:"},"Range:":{es:"Distancia:"},"Reason:":{es:"Razn:"},"Recover alpha":{es:"Recuperar alfa"},Red:{es:"Rojo"},"Red channel:":{es:"Canal rojo:"},"Resample - Hermite":{es:"Volver a muestrear - hermite"},Resize:{es:"Cambiar el tamao"},"Restore alpha":{es:"Restaurar alfa"},Right:{es:"Derecha"},Rotate:{es:"Girar"},"Rotate left":{es:"Girar a la izquierda"},Rotation:{es:"Rotacin"},"SHIFT + Arrow keys":{es:"Teclas shift + flecha"},"Saturation:":{es:"Saturacin:"},Save:{es:"Salvar"},"Save as":{es:"Guardar como"},"Save as type:":{es:"Guardar como tipo:"},"Save layers:":{es:"Guardar capas:"},"Select all":{es:"Seleccionar todo"},"Select area first":{es:"Elija un rea de primera"},"Select area tool":{es:"Seleccionar herramienta de rea"},"Select color":{es:"Seleccionar el color"},"Select object tool":{es:"Herramienta de seleccin de objetos"},Selected:{es:"Seleccionado"},"Sensitivity:":{es:"Sensibilidad:"},Sepia:{es:"Sepia"},Shaded:{es:"Sombreada"},"Shadow blur:":{es:"Sombra desenfoque:"},"Shadow color:":{es:"Color de la sombra:"},"Shadow:":{es:"Sombra:"},Sharpen:{es:"Afilar"},"Sharpen tool":{es:"Afilar herramientas"},"Sharpen:":{es:"Afilar:"},"Show / Hide":{es:"Mostrar ocultar"},Simple:{es:"Sencillo"},Size:{es:"Tamao"},"Size:":{es:"Tamao:"},Sketchy:{es:"Incompleto"},Solarize:{es:"Solarize"},Sorry:{es:"Lo siento"},"Source is empty, right click on image first.":{es:"Fuente est vaca, haga clic derecho en la imagen primero."},"Source:":{es:"Fuente:"},Sprites:{es:"Sprites"},Square:{es:"Cuadrado"},"Strength:":{es:"Fuerza:"},Strict:{es:"Estricto"},Stroke:{es:"Carrera"},"Stroke size:":{es:"El tamao del trazo:"},Text:{es:"Texto"},"Text:":{es:"Texto:"},"The image could not be loaded.":{es:"La imagen no se pudo cargar."},"This can not be last layer":{es:"Esto no puede ser la ltima capa"},"This can not be last layer.":{es:"Esto no puede ser la ltima capa."},"Tilt Shift":{es:"Cambio de inclinacin"},"Times New Roman":{es:"Times new roman"},"To paste from clipboard, use Ctrl-V.":{es:"Para pegar desde el portapapeles, use ctrl-v."},Tools:{es:"Herramientas"},"Top-left":{es:"Arriba a la izquierda"},"Top-right":{es:"Parte superior derecha"},"Total pixels:":{es:"Pxeles en total:"},"Translate error, can not find dictionary:":{es:"Traducir el error, no puede encontrar el diccionario:"},"Transparency #1:":{es:"Transparencia # 1:"},"Transparency #2:":{es:"Transparencia # 2:"},"Transparent:":{es:"Transparente:"},Trim:{es:"Recortar"},"Trim:":{es:"Recortar:"},Undo:{es:"Deshacer"},"Unique colors:":{es:"Colores nicas:"},Up:{es:"Arriba"},"V Radius:":{es:"Radio de v:"},Verdana:{es:"Verdana"},Vertical:{es:"Vertical"},"Vertical gap:":{es:"Espacio vertical:"},Vignette:{es:"Vieta"},"Vignette amount:":{es:"Cantidad vieta:"},"Vignette size:":{es:"Tamao de vieta:"},ViliusL:{es:"Viliusl"},Vintage:{es:"Vendimia"},"Visible:":{es:"Visible:"},"WEBP - Weppy File Format":{es:"Webp - formato de archivo weppy"},Website:{es:"Sitio web"},"Width (%):":{es:"Anchura (%):"},"Width (pixels):":{es:"Ancho (pxeles):"},"Width:":{es:"Anchura:"},"X end:":{es:"X final:"},"X start:":{es:"Inicio x:"},"Y end:":{es:"Y final:"},"Y start:":{es:"Y de inicio:"},Yes:{es:"S"},"Your browser do not support this format.":{es:"Su navegador no soporta este formato."},"Your browser doesn't support canvas.":{es:"Su navegador no soporta lienzo."},Zoom:{es:"Enfocar"},"Zoom in":{es:"Acercarse"},"Zoom out":{es:"Disminuir el zoom"},"Zoom:":{es:"Enfocar:"}},dict_it={"2d":{it:"2d"},"3D position:":{it:"Posizione 3d:"},"3D size:":{it:"Formato 3d:"},About:{it:"Di"},"Add new layer":{it:"Aggiungere nuovo livello"},All:{it:"Tutti"},Alpha:{it:"Alfa"},"Alpha:":{it:"Alfa:"},"Amount:":{it:"Quantit:"},Anonymous:{it:"Anonimo"},"Anti aliasing":{it:"Anti aliasing"},"Area:":{it:"La zona:"},Arial:{it:"Arial"},Arrow:{it:"Freccia"},"Arrow keys":{it:"Tasti freccia"},Attributes:{it:"Attributi"},"Author:":{it:"Autore:"},"Auto adjust colors":{it:"Regolazione automatica colori"},"Auto colorize":{it:"Colorare auto"},"Average:":{it:"Media:"},"BMP - Windows Bitmap":{it:"Bmp - windows bitmap"},Background:{it:"Sfondo"},Basic:{it:"Di base"},BezierCurve:{it:"Curva di bzier"},"Big grains level:":{it:"Di livello grani grossi:"},"Black and White":{it:"Bianco e nero"},Blend:{it:"Miscela"},"Blend:":{it:"Miscela:"},Blue:{it:"Blu"},"Blue channel:":{it:"Blue channel:"},Blur:{it:"Blur"},"Blur Radius:":{it:"Raggio di sfocatura:"},"Blur tool":{it:"Strumento blur"},"Blur-Box":{it:"Blur-box"},"Blur-Gaussian":{it:"Blur-gaussiano"},"Blur-Stack":{it:"Blur-stack"},"Blur-Zoom":{it:"Blur-zoom"},"Blur:":{it:"Blur:"},Bold:{it:"Grassetto"},"Bold Italic":{it:"Italico grassetto"},Borders:{it:"Frontiere"},Both:{it:"Entrambi"},"Bottom-left":{it:"In basso a sinistra"},"Bottom-right":{it:"In basso a destra"},"Brightness Contrast":{it:"Contrasto di luminosit"},"Brightness:":{it:"Luminosit:"},Brush:{it:"Pennello"},"Brush styles":{it:"Stili di pennello"},"Bulge/Pinch":{it:"Bulge / pinch"},Burn:{it:"Bruciare"},"Burn/Dodge tool":{it:"Masterizzare strumento / dodge"},"CTRL + Arrow keys":{it:"Tasti freccia ctrl +"},Cancel:{it:"Annulla"},"Center x:":{it:"Centro x:"},"Center y:":{it:"Centro y:"},"Center:":{it:"Centro:"},"Channel:":{it:"Canale:"},Chrome:{it:"Cromo"},Circle:{it:"Cerchio"},Clear:{it:"Pulire"},"Clear selection":{it:"Cancella selezione"},"Clone tool":{it:"Strumento clone"},"Color #1:":{it:"Colore # 1:"},"Color #2:":{it:"Colore # 2:"},"Color Zoom":{it:"Zoom colore"},"Color adjust:":{it:"Regola colore:"},"Color corrections":{it:"Correzioni di colore"},"Color to Alpha":{it:"Colore ad alfa"},"Color to alpha":{it:"Colore ad alfa"},"Color:":{it:"Colore:"},Colorize:{it:"Colorize"},"Colors:":{it:"Colori:"},Composite:{it:"Composito"},"Composition:":{it:"Composizione:"},"Contrast:":{it:"Contrasto:"},"Copy selection":{it:"Selezione copy"},Courier:{it:"Corriere"},Crop:{it:"Raccolto"},"Crop Selection":{it:"Selezione di ritaglio"},Curve:{it:"Curva"},"Cut selection":{it:"Selezione cut"},"Decrease color depth":{it:"Diminuire la profondit di colore"},"Decrease colors":{it:"Diminuzione colori"},Default:{it:"Predefinito"},Del:{it:"Del"},Delete:{it:"Cancellare"},"Delete selection":{it:"Elimina la selezione"},Denoise:{it:"Denoise"},Desaturate:{it:"Desatura"},"Desaturation:":{it:"Desaturazione:"},"Description:":{it:"Descrizione:"},Differences:{it:"Differenze"},"Differences Down":{it:"Differenze gi"},Dither:{it:"Agitarsi"},"Dithering:":{it:"Dithering:"},"Dot Screen":{it:"Schermo dot"},Down:{it:"Gi"},Downloaded:{it:"Scaricati"},"Drag & Drop":{it:"Drag & drop"},"Draw circle":{it:"Disegna cerchio"},"Draw letters":{it:"Disegnare le lettere"},"Draw line":{it:"Draw line"},"Draw rectangle":{it:"Disegna rettangolo"},Dublicate:{it:"Dublicate"},"Dusts level:":{it:"Polveri di livello:"},Edge:{it:"Bordo"},Edit:{it:"Modifica"},Effects:{it:"Effetti"},"Effects library":{it:"Libreria di effetti"},"Email:":{it:"E-mail:"},Emboss:{it:"Rilievo"},"Empty data":{it:"Dati vuota"},English:{it:"Inglese"},Enrich:{it:"Arricchire"},"Enter angle (0-360):":{it:"Digitare l'angolo (0-360):"},Erase:{it:"Cancellare"},Error:{it:"Errore"},"Error, can not find active layer.":{it:"Errore, non riesce a trovare livello attivo."},"Error:":{it:"Errore:"},"Espaol":{it:"Espaol"},"Exponent:":{it:"Esponente:"},"Exposure level:":{it:"Livello di esposizione:"},"Factor:":{it:"Fattore:"},File:{it:"File"},"File name:":{it:"Nome del file:"},Fill:{it:"Riempire"},"Fill style:":{it:"Fill stile:"},"Flatten Image":{it:"Immagine piatta"},Flip:{it:"Capovolgere"},"Font family:":{it:"Famiglia di font:"},"Font style:":{it:"Stile carattere:"},Fur:{it:"Pelliccia"},Gamma:{it:"Gamma"},"Gamma:":{it:"Gamma:"},"Gap:":{it:"Gap:"},Gradient:{it:"Pendenza"},"Gradient Radius:":{it:"Raggio gradiente:"},Grains:{it:"Grani"},"Grains level:":{it:"Di livello grains:"},Gray:{it:"Grigio"},GrayScale:{it:"Scala di grigi"},Green:{it:"Verde"},"Green channel:":{it:"Canale verde:"},"Greyscale:":{it:"Scala di grigi:"},Grid:{it:"Griglia"},"Grid on/off":{it:"Griglia on / off"},Grouped:{it:"Raggruppate"},"H Radius:":{it:"Raggio h:"},"HSL Adjustment":{it:"Regolazione hsl"},Harmony:{it:"Armonia"},Heatmap:{it:"Mappa di calore"},"Height (%):":{it:"Altezza (%):"},"Height (pixels):":{it:"Altezza (pixel):"},"Height:":{it:"Altezza:"},Help:{it:"Aiuto"},Helvetica:{it:"Helvetica"},Hermite:{it:"Hermite"},Histogram:{it:"Istogramma"},"Histogram:":{it:"Istogramma:"},Horizontal:{it:"Orizzontale"},"Horizontal gap:":{it:"Gap orizzontale:"},"Hue:":{it:"Hue:"},Image:{it:"Immagine"},"Image filters":{it:"Filtri per le immagini"},Impact:{it:"Urto"},"Imports images":{it:"Immagini importazioni"},Information:{it:"Informazioni"},"Invalid color component":{it:"Componente di colore non valido"},Italic:{it:"Corsivo"},"JPG - JPG/JPEG Format":{it:"Jpg - jpg / jpeg"},"JPG Compression":{it:"Compressione jpg"},"JSON - Full layers data":{it:"Json - strati pieni di dati"},"KD-tree":{it:"Kd-albero"},"Key-points":{it:"Punti chiave"},"Keyboard Shortcuts":{it:"Tasti rapidi"},Language:{it:"Lingua"},Layer:{it:"Strato"},"Layer #":{it:"Strato #"},Layers:{it:"Livelli"},Left:{it:"Sinistra"},"Level:":{it:"Livello:"},"Levels:":{it:"Livelli:"},"Lietuvi":{it:"Lietuvi"},"Light leak:":{it:"Perdita di luce:"},"Limit:":{it:"Limite:"},"Luminance:":{it:"Luminance:"},"Luminosity:":{it:"Luminosit:"},"Magic Wand Tool":{it:"Strumento bacchetta magica"},Merge:{it:"Fondere"},"Merge Down":{it:"Fondere"},"Mode:":{it:"Modalit:"},Mosaic:{it:"Mosaico"},"Mouse:":{it:"Topo:"},Move:{it:"Mossa"},"Move active layer by 10px":{it:"Spostare strato attivo da 10px"},"Move active layer by 1px":{it:"Spostare strato attivo da 1px"},"Move active layer by 50px":{it:"Spostare strato attivo da 50px"},"Move down":{it:"Abbassati"},"Move up":{it:"Rimontare"},"Multi-line":{it:"Multi-line"},"Name:":{it:"Nome:"},Negative:{it:"Negativo"},New:{it:"Nuovo"},"New file...":{it:"Nuovo file..."},"New layer":{it:"Nuovo livello"},No:{it:"No"},Normal:{it:"Normale"},Notice:{it:"Avviso"},"Notice:":{it:"Avviso:"},Oil:{it:"Olio"},Ok:{it:"Ok"},"Online image editor":{it:"Editor di immagini online"},Opacity:{it:"Opacit"},Open:{it:"Aperto"},"Open file(s)":{it:"Aprire il file (s)"},"PNG - Portable Network Graphics":{it:"Png - portable network graphics"},Paste:{it:"Incolla"},"Paste selection":{it:"Selezione incolla"},Pencil:{it:"Matita"},Perspective:{it:"Prospettiva"},"Pick Color":{it:"Scegli il colore"},Posterize:{it:"Posterizzare"},"Power:":{it:"Energia:"},"Pre-Blur:":{it:"Pre-sfocatura:"},Preview:{it:"Anteprima"},Print:{it:"Stampare"},"Quality (jpeg):":{it:"Qualit (jpeg):"},"Quality:":{it:"Qualit:"},Radial:{it:"Radiale"},"Radius:":{it:"Raggio:"},"Range:":{it:"Gamma:"},"Reason:":{it:"Ragionare:"},"Recover alpha":{it:"Recuperare alpha"},Red:{it:"Rosso"},"Red channel:":{it:"Canale rosso:"},"Resample - Hermite":{it:"Resample - hermite"},Resize:{it:"Ridimensiona"},"Restore alpha":{it:"Ripristinare alpha"},Right:{it:"Destra"},Rotate:{it:"Ruotare"},"Rotate left":{it:"Gira a sinistra"},Rotation:{it:"Rotazione"},"SHIFT + Arrow keys":{it:"Tasti shift + freccia"},"Saturation:":{it:"Saturazione:"},Save:{it:"Salvare"},"Save as":{it:"Salva come"},"Save as type:":{it:"Salva come tipo:"},"Save layers:":{it:"Salva strati:"},"Select all":{it:"Seleziona tutto"},"Select area first":{it:"Seleziona l'area prima"},"Select area tool":{it:"Selezionare lo strumento zona"},"Select color":{it:"Scegli il colore"},"Select object tool":{it:"Selezionare lo strumento oggetto"},Selected:{it:"Selezionato"},"Sensitivity:":{it:"Sensibilit:"},Sepia:{it:"Nero di seppia"},Shaded:{it:"Ombroso"},"Shadow blur:":{
it:"Ombra sfocatura:"},"Shadow color:":{it:"Colore dell'ombra:"},"Shadow:":{it:"Ombra:"},Sharpen:{it:"Affilare"},"Sharpen tool":{it:"Contrasta strumento"},"Sharpen:":{it:"Affilare:"},"Show / Hide":{it:"Mostra nascondi"},Simple:{it:"Semplice"},Size:{it:"Dimensione"},"Size:":{it:"Dimensione:"},Sketchy:{it:"Abbozzato"},Solarize:{it:"Solarizzare"},Sorry:{it:"Scusate"},"Source is empty, right click on image first.":{it:"Source  vuoto, fate clic destro sull'immagine prima."},"Source:":{it:"Fonte:"},Sprites:{it:"Sprites"},Square:{it:"Piazza"},"Strength:":{it:"Forza:"},Strict:{it:"Rigoroso"},Stroke:{it:"Ictus"},"Stroke size:":{it:"Dimensioni corsa:"},Text:{it:"Testo"},"Text:":{it:"Testo:"},"The image could not be loaded.":{it:"L'immagine non pu essere caricato."},"This can not be last layer":{it:"Questo non pu essere ultimo strato"},"This can not be last layer.":{it:"Questo non pu essere ultimo strato."},"Tilt Shift":{it:"Tilt shift"},"Times New Roman":{it:"Times new roman"},"To paste from clipboard, use Ctrl-V.":{it:"Per incollare dagli appunti, utilizzare ctrl-v."},Tools:{it:"Utensili"},"Top-left":{it:"A sinistra in alto"},"Top-right":{it:"In alto a destra"},"Total pixels:":{it:"Pixel totali:"},"Translate error, can not find dictionary:":{it:"Tradurre errore, non riesce a trovare dizionario:"},"Transparency #1:":{it:"Trasparenza # 1:"},"Transparency #2:":{it:"Trasparenza # 2:"},"Transparent:":{it:"Trasparente:"},Trim:{it:"Tagliare"},"Trim:":{it:"Trim:"},Undo:{it:"Disfare"},"Unique colors:":{it:"Colori unici:"},Up:{it:"Su"},"V Radius:":{it:"Raggio v:"},Verdana:{it:"Verdana"},Vertical:{it:"Verticale"},"Vertical gap:":{it:"Gap verticale:"},Vignette:{it:"Vignette"},"Vignette amount:":{it:"Importo vignette:"},"Vignette size:":{it:"Dimensioni vignette:"},ViliusL:{it:"Viliusl"},Vintage:{it:"Annata"},"Visible:":{it:"Visibile:"},"WEBP - Weppy File Format":{it:"Webp - formato di file weppy"},Website:{it:"Sito web"},"Width (%):":{it:"Larghezza (%):"},"Width (pixels):":{it:"Larghezza (pixel):"},"Width:":{it:"Larghezza:"},"X end:":{it:"X fine:"},"X start:":{it:"X inizio:"},"Y end:":{it:"Fine y:"},"Y start:":{it:"Y inizio:"},Yes:{it:"S"},"Your browser do not support this format.":{it:"Il tuo browser non supporta questo formato."},"Your browser doesn't support canvas.":{it:"Il tuo browser non supporta tela."},Zoom:{it:"Ingrandimento"},"Zoom in":{it:"Ingrandire"},"Zoom out":{it:"Zoom indietro"},"Zoom:":{it:"Ingrandimento:"}},dict_lt={"2d":{lt:"2d"},"3D position:":{lt:"3d vieta:"},"3D size:":{lt:"3d dydis:"},About:{lt:"Apie"},"Add new layer":{lt:"Naujas sluoksnis"},All:{lt:"Visi"},Alpha:{lt:"Alfa"},"Alpha:":{lt:"Alfa:"},"Amount:":{lt:"Kiekis:"},Anonymous:{lt:"Anoniminis"},"Anti aliasing":{lt:"Sulieti"},"Area:":{lt:"Plotas:"},Arial:{lt:"Arial"},Arrow:{lt:"Rodykl"},"Arrow keys":{lt:"Rodykli klaviai"},Attributes:{lt:"Atributai"},"Author:":{lt:"Autorius:"},"Auto adjust colors":{lt:"Automatinis spalv reguliavimas"},"Auto colorize":{lt:"Spalvinimas"},"Average:":{lt:"Vidurkis:"},"BMP - Windows Bitmap":{lt:"BMP - Windows Bitmap"},Background:{lt:"Fonas"},Basic:{lt:"Paprastas"},BezierCurve:{lt:"Bezj kreiv"},"Big grains level:":{lt:"Didelio grdtumo lygis:"},"Black and White":{lt:"Juoda ir balta"},Blend:{lt:"Miinys"},"Blend:":{lt:"Miinys:"},Blue:{lt:"Mlynas"},"Blue channel:":{lt:"Mlyna kanalas:"},Blur:{lt:"Migla"},"Blur Radius:":{lt:"Migla-spindulys:"},"Blur tool":{lt:"Migla-rankis"},"Blur-Box":{lt:"Migla-d"},"Blur-Gaussian":{lt:"Migla-Gaussian"},"Blur-Stack":{lt:"Migla-daugyb"},"Blur-Zoom":{lt:"Migla-priartinimas"},"Blur:":{lt:"Migla:"},Bold:{lt:"Drsus"},"Bold Italic":{lt:"Bold italic"},Borders:{lt:"Kratai"},Both:{lt:"Abu"},"Bottom-left":{lt:"Apatiniame kairiajame"},"Bottom-right":{lt:"Apatiniame deiniajame"},"Brightness Contrast":{lt:"Rykumas kontrastas"},"Brightness:":{lt:"Rykumas:"},Brush:{lt:"epetys"},"Brush styles":{lt:"epei stilius"},"Bulge/Pinch":{lt:"Iptimas/Sutraukimas"},Burn:{lt:"Deginti"},"Burn/Dodge tool":{lt:"Burn / dodge nuorod"},"CTRL + Arrow keys":{lt:"Ctrl + rodykli klavius"},Cancel:{lt:"Ataukti"},"Center x:":{lt:"Centras x:"},"Center y:":{lt:"Centras y:"},"Center:":{lt:"Centras:"},"Channel:":{lt:"Kanalas:"},Chrome:{lt:"Chromas"},Circle:{lt:"Ratas"},Clear:{lt:"Ivalyti"},"Clear selection":{lt:"Ataukti paymt srit"},"Clone tool":{lt:"Klonas rankis"},"Color #1:":{lt:"Spalva # 1:"},"Color #2:":{lt:"Spalva # 2:"},"Color Zoom":{lt:"Spalv analiz"},"Color adjust:":{lt:"Spalva reguliuoti:"},"Color corrections":{lt:"Spalv korekcijos"},"Color to Alpha":{lt:"Spalva alfa"},"Color to alpha":{lt:"Keisti spalvos permatomum"},"Color:":{lt:"Spalva:"},Colorize:{lt:"Spalvinimas"},"Colors:":{lt:"Spalvos:"},Composite:{lt:"Sudtinis"},"Composition:":{lt:"Sudtis:"},"Contrast:":{lt:"Kontrastas:"},"Copy selection":{lt:"Kopijuoti pasirinkimas"},Courier:{lt:"Kurjeris"},Crop:{lt:"Apkarpyti"},"Crop Selection":{lt:"Apkarpyti pasirinkim"},Curve:{lt:"Kreiv"},"Cut selection":{lt:"Ikirpti pasirinkimas"},"Decrease color depth":{lt:"Sumainti spalv gyl"},"Decrease colors":{lt:"Sumainti spalvos"},Default:{lt:"Numatytas"},Del:{lt:"Trinti"},Delete:{lt:"Panaikinti"},"Delete selection":{lt:"Itrinti pasirinkim"},Denoise:{lt:"Triukmo alinimas"},Desaturate:{lt:"Maiau sodrumo"},"Desaturation:":{lt:"Maiau sodrumo:"},"Description:":{lt:"Apraymas:"},Differences:{lt:"Skirtumai"},"Differences Down":{lt:"Skirtumai emyn"},Dither:{lt:"Papildymas"},"Dithering:":{lt:"Papildymu:"},"Dot Screen":{lt:"Tak ekranas"},Down:{lt:"emyn"},Downloaded:{lt:"Parsistas"},"Downloading...":{lt:"Atsisiuniama..."},"Drag & Drop":{lt:"Nutempti & paleisti"},"Draw circle":{lt:"Pieti apskritim"},"Draw letters":{lt:"Pieti raides"},"Draw line":{lt:"Pieti linij"},"Draw rectangle":{lt:"Pieti staiakamp"},Dublicate:{lt:"Dauginti"},"Dusts level:":{lt:"Dulki lygis:"},Edge:{lt:"Kratas"},Edit:{lt:"Redaguoti"},Effects:{lt:"Efektai"},"Effects library":{lt:"Efekt biblioteka"},"Email:":{lt:"E-Patas:"},Emboss:{lt:"spausti"},"Empty data":{lt:"Nra duomen"},English:{lt:"English"},Enrich:{lt:"Praturtinti"},"Enter angle (0-360):":{lt:"veskite kamp (0-360):"},Erase:{lt:"Itrinti"},Error:{lt:"Klaida"},"Error, can not find active layer.":{lt:"Klaida, negalima rasti aktyvaus sluoksnio."},"Error:":{lt:"Klaida:"},"Exponent:":{lt:"Eksponent:"},"Exposure level:":{lt:"Ekspozicijos lygis:"},"Factor:":{lt:"Veiksnys:"},File:{lt:"Byla"},"File name:":{lt:"Failo vardas:"},Fill:{lt:"Pildyti"},"Fill style:":{lt:"Upildykite stilius:"},"Flatten Image":{lt:"Sujungti sluoksnius"},Flip:{lt:"Apversti"},"Font family:":{lt:"rifto eima:"},"Font style:":{lt:"rifto stilius:"},Format:{lt:"Formatas"},Fur:{lt:"Kailis"},Gamma:{lt:"viesumas"},"Gamma:":{lt:"viesumas:"},"Gap:":{lt:"Tarpas:"},Gradient:{lt:"Gradientas"},"Gradient Radius:":{lt:"Gradientas spindulys:"},Grains:{lt:"Grdtumas"},"Grains level:":{lt:"Grdtumo lygis:"},Gray:{lt:"Pilkas"},GrayScale:{lt:"Pilkai"},Green:{lt:"alias"},"Green channel:":{lt:"alioji kanalas:"},"Greyscale:":{lt:"Pilkieji pustoniai:"},Grid:{lt:"Tinklelis"},"Grid on/off":{lt:"Tinklelis jungtas/ijungtas"},Grouped:{lt:"Grupuoti"},"H Radius:":{lt:"Horizontalus spindulys:"},"HSL Adjustment":{lt:"HSL reguliavimas"},Harmony:{lt:"Harmonija"},Heatmap:{lt:"Spalvin diagrama"},"Height (%):":{lt:"Auktis (%):"},"Height (pixels):":{lt:"Auktis (takai):"},"Height:":{lt:"Auktis:"},Help:{lt:"Pagalba"},Helvetica:{lt:"Helvetica"},Hermite:{lt:"Hermite"},Histogram:{lt:"Histograma"},"Histogram:":{lt:"Histograma:"},Horizontal:{lt:"Horizontalus"},"Horizontal gap:":{lt:"Horizontali tarpas:"},"Hue:":{lt:"Atspalvis:"},Image:{lt:"Vaizdas"},"Image filters":{lt:"Vaizdo filtrai"},Impact:{lt:"Poveikis"},"Imports images":{lt:"Importas vaizdai"},Information:{lt:"Informacija"},"Invalid color component":{lt:"Neteisingas spalva komponentas"},Italic:{lt:"Italic"},"JPG - JPG/JPEG Format":{lt:"JPG - jpg / jpeg formatas"},"JPG Compression":{lt:"Jpg suspaudimas"},"JSON - Full layers data":{lt:"JSON - visi sluoksni duomenys"},"KD-tree":{lt:"KD-medis"},"Key-points":{lt:"Pagrindiniai takai"},"Keyboard Shortcuts":{lt:"Klaviatros nuorodos"},Language:{lt:"Kalba"},Layer:{lt:"Sluoksnis"},"Layer #":{lt:"Sluoksnio #"},Layers:{lt:"Sluoksniai"},Left:{lt:" kair"},"Level:":{lt:"Lygis:"},"Levels:":{lt:"Lygiais:"},"Lietuvi":{lt:"Lietuvi"},"Light leak:":{lt:"viesos nuotkio:"},"Limit:":{lt:"Riba:"},"Luminosity:":{lt:"viesumas:"},"Luminance:":{lt:"Apvietimo lygis:"},"Magic Wand Tool":{lt:"Stebuklinga lazdel"},Merge:{lt:"Susijungti"},"Merge Down":{lt:"Sujungti emyn"},"Mode:":{lt:"Reimas:"},Mosaic:{lt:"Mozaika"},"Mouse:":{lt:"Pel:"},Move:{lt:"Perkelti"},"Move active layer by 10px":{lt:"Perkelti aktyv sluoksn per 10px"},"Move active layer by 1px":{lt:"Perkelti aktyv sluoksn per 1px"},"Move active layer by 50px":{lt:"Perkelti aktyv sluoksn per 50px"},"Move down":{lt:"Perkelti emyn"},"Move up":{lt:"Perkelti"},"Multi-line":{lt:"Keli eilui"},"Name:":{lt:"Vardas:"},Negative:{lt:"Neigiamas"},New:{lt:"Nauja"},"New file...":{lt:"Naujas failas..."},"New layer":{lt:"Nauja sluoksnis"},No:{lt:"Ne"},Normal:{lt:"Normalus"},Notice:{lt:"Pastebti"},"Notice:":{lt:"Pastebti:"},Oil:{lt:"Aliejus"},Ok:{lt:"Gerai"},"Online image editor":{lt:"Internetinis grafinis redaktorius"},Opacity:{lt:"Nepermatomumas"},Open:{lt:"Atidaryti"},"Open file(s)":{lt:"Atidaryti fail(us)"},"PNG - Portable Network Graphics":{lt:"PNG - Portable Network Graphics"},Paste:{lt:"kelti"},"Paste selection":{lt:"Nukopijuokite pasirinkimas"},Pencil:{lt:"Pietukas"},Perspective:{lt:"Perspektyva"},"Pick Color":{lt:"Pasirinkite spalv"},Posterize:{lt:"Mainti spalvas"},"Power:":{lt:"Galia:"},"Pre-Blur:":{lt:"Iankstinis iliejimas:"},Preview:{lt:"Perirti"},Print:{lt:"Spausdinti"},"Quality (jpeg):":{lt:"Kokyb (jpeg):"},"Quality:":{lt:"Kokyb:"},Radial:{lt:"Radialinis"},"Radius:":{lt:"Spindulys:"},"Range:":{lt:"Kategorijos:"},"Reason:":{lt:"Prieastis:"},"Recover alpha":{lt:"Atkurti nepermatomum"},Red:{lt:"Raudonas"},"Red channel:":{lt:"Raudonasis kanalas:"},"Resample - Hermite":{lt:"Paangus-Hermite"},Resize:{lt:"Keisti dyd"},"Restore alpha":{lt:"Atkurti alfa"},Right:{lt:" dein"},Rotate:{lt:"Sukti"},"Rotate left":{lt:"Pasukti  kair"},Rotation:{lt:"Rotacija"},"SHIFT + Arrow keys":{lt:"Shift + rodykli klavias"},"Saturation:":{lt:"Spalvingumas:"},Save:{lt:"Isaugoti"},"Save as":{lt:"Isaugoti kaip"},"Save as type:":{lt:"Failo tipas:"},"Save layers:":{lt:"Isaugoti sluoksnius:"},"Select all":{lt:"Paymti visk"},"Select area first":{lt:"Pasirinkite plotas pirmas"},"Select area tool":{lt:"Pasirinkite plotas rankis"},"Select color":{lt:"Pasirinkite spalv"},"Select object tool":{lt:"Pasirinkite objektas rankis"},Selected:{lt:"Pasirinkti"},"Sensitivity:":{lt:"Jautrumas:"},Sepia:{lt:"Sepija"},Shaded:{lt:"Tamsioje"},"Shadow blur:":{lt:"eli blur:"},"Shadow color:":{lt:"eli spalva:"},"Shadow:":{lt:"elis:"},Sharpen:{lt:"Pagalsti"},"Sharpen tool":{lt:"Parykinti nuorod"},"Sharpen:":{lt:"Parykinti:"},"Show / Hide":{lt:"Rodyti/slpti"},Simple:{lt:"Paprastas"},Size:{lt:"Dydis"},"Size:":{lt:"Dydis:"},Sketchy:{lt:"Pavirutinikas"},Solarize:{lt:"Sauls poveikis"},Sorry:{lt:"Atsipraome"},"Source is empty, right click on image first.":{lt:"altinis yra tuias, deiniuoju pels mygtuku spustelkite ant nuotraukos."},"Source:":{lt:"Kodas:"},Sprites:{lt:"Sprites"},Square:{lt:"Kvadratas"},"Strength:":{lt:"Jga:"},Strict:{lt:"Grietas"},Stroke:{lt:"Brknys"},"Stroke size:":{lt:"Brknio dydis:"},Text:{lt:"Tekstas"},"Text:":{lt:"Tekstas:"},"The image could not be loaded.":{lt:"Vaizdas negali bti keltas."},"This can not be last layer":{lt:"Tai gali bti ne paskutinis sluoksnis"},"This can not be last layer.":{lt:"Tai gali bti ne paskutinis sluoksnis."},"Tilt Shift":{lt:"Tentinis perjimas"},"Times New Roman":{lt:"Times new roman"},"To paste from clipboard, use Ctrl-V.":{lt:"Nordami klijuoti i main srities, naudokite ctrl-v."},Tools:{lt:"rankiai"},"Top-left":{lt:"Virutiniame kairiajame"},"Top-right":{lt:"Virutiniame deiniajame"},"Total pixels:":{lt:"I viso tak:"},"Translate error, can not find dictionary:":{lt:"Versti klaid, negali rasti odyn:"},"Transparency #1:":{lt:"Permatomumas # 1:"},"Transparency #2:":{lt:"Permatomumas # 2:"},"Transparent:":{lt:"Permatomumas:"},Trim:{lt:"Apkarpyti"},"Trim:":{lt:"Apkarpyti:"},Undo:{lt:"Anuliuoti"},"Unique colors:":{lt:"Unikalios spalvos:"},Up:{lt:"Auktyn"},"V Radius:":{lt:"Verticalus spindulys:"},Verdana:{lt:"Verdana"},Vertical:{lt:"Vertikalus"},"Vertical gap:":{lt:"Vertikali atotrkis:"},Vignette:{lt:"Vinjet"},"Vignette amount:":{lt:"Vinjet suma:"},"Vignette size:":{lt:"Vinjet dydis:"},ViliusL:{lt:"Viliusl"},Vintage:{lt:"Senovikas"},"Visible:":{lt:"Matomas:"},"WEBP - Weppy File Format":{lt:"WEBP - Weppy File Format"},Website:{lt:"Internetin svetain"},"Width (%):":{lt:"Plotis (%):"},"Width (pixels):":{lt:"Plotis (takai):"},"Width:":{lt:"Plotis:"},"X end:":{lt:"X pabaiga:"},"X start:":{lt:"X pradia:"},"Y end:":{lt:"Y pabaiga:"},"Y start:":{lt:"Y pradia:"},Yes:{lt:"Taip"},"Your browser do not support this format.":{lt:"Js narykl nepalaiko ito formato."},"Your browser doesn't support canvas.":{lt:"Js narykl nepalaiko naujausi technologij."},Zoom:{lt:"Padidinti"},"Zoom in":{lt:"Priartinti"},"Zoom out":{lt:"Nutolinti"},"Zoom:":{lt:"Priartinimas:"}},dict_zh={"2d":{zh:"2d"},"3D position:":{zh:""},"3D size:":{zh:""},About:{zh:""},"Add new layer":{zh:""},All:{zh:""},Alpha:{zh:""},"Alpha:":{zh:""},"Amount:":{zh:""},Anonymous:{zh:""},"Anti aliasing":{zh:""},"Area:":{zh:""},Arial:{zh:""},Arrow:{zh:""},"Arrow keys":{zh:""},Attributes:{zh:""},"Author:":{zh:""},"Auto adjust colors":{zh:""},"Auto colorize":{zh:""},"Average:":{zh:""},"BMP - Windows Bitmap":{zh:"Bmp - windows"},Background:{zh:""},Basic:{zh:""},BezierCurve:{zh:""},"Big grains level:":{zh:""},"Black and White":{zh:""},Blend:{zh:""},"Blend:":{zh:""},Blue:{zh:""},"Blue channel:":{zh:""},Blur:{zh:""},"Blur Radius:":{zh:""},"Blur tool":{zh:""},"Blur-Box":{zh:""},"Blur-Gaussian":{zh:" - "},"Blur-Stack":{zh:""},"Blur-Zoom":{zh:""},"Blur:":{zh:""},Bold:{zh:""},"Bold Italic":{zh:""},Borders:{zh:""},Both:{zh:""},"Bottom-left":{zh:""},"Bottom-right":{zh:""},"Brightness Contrast":{zh:""},"Brightness:":{zh:""},Brush:{zh:""},"Brush styles":{zh:""},"Bulge/Pinch":{zh:"/"},Burn:{zh:""},"Burn/Dodge tool":{zh:"/"},"CTRL + Arrow keys":{zh:"ctrl +"},Cancel:{zh:""},"Center x:":{zh:"x"},"Center y:":{zh:"y"},"Center:":{zh:""},"Channel:":{zh:""},Chinese:{zh:""},Chrome:{zh:""},Circle:{zh:""},Clear:{zh:""},"Clear selection":{zh:""},"Clone tool":{zh:""},"Color #1:":{zh:"1"},"Color #2:":{zh:"2"},"Color Zoom":{zh:""},"Color adjust:":{zh:""},"Color corrections":{zh:""},"Color to Alpha":{zh:""},"Color to alpha":{zh:""},"Color:":{zh:""},Colorize:{zh:""},"Colors:":{zh:""},Composite:{zh:""},"Composition:":{zh:""},"Contrast:":{zh:""},"Copy selection":{zh:""},Courier:{zh:""},Crop:{zh:""},"Crop Selection":{zh:""},Curve:{zh:""},"Cut selection":{zh:""},"Decrease color depth":{zh:""},"Decrease colors":{zh:""},Default:{zh:""},Del:{zh:""},Delete:{zh:""},"Delete selection":{zh:""},Denoise:{zh:""},Desaturate:{zh:""},"Desaturation:":{zh:""},"Description:":{zh:""},Differences:{zh:""},"Differences Down":{zh:""},Dither:{zh:""},"Dithering:":{zh:""},"Dot Screen":{zh:""},Down:{zh:""},Downloaded:{zh:""},"Drag & Drop":{zh:""},"Draw circle":{zh:""},"Draw letters":{zh:""},"Draw line":{zh:""},"Draw rectangle":{zh:""},Dublicate:{zh:"Dublicate"},"Dusts level:":{zh:""},Edge:{zh:""},Edit:{zh:""},Effects:{zh:""},"Effects library":{zh:""},"Email:":{zh:""},Emboss:{zh:""},"Empty data":{zh:""},English:{zh:""},Enrich:{zh:""},"Enter angle (0-360):":{zh:"0-360"},Erase:{zh:""},Error:{zh:""},"Error, can not find active layer.":{zh:""},"Error:":{zh:""},"Exponent:":{zh:""},"Exposure level:":{zh:""},"Factor:":{zh:""},File:{zh:""},"File name:":{zh:""},Fill:{zh:""},"Fill style:":{zh:""},"Flatten Image":{zh:""},Flip:{zh:""},"Font family:":{zh:""},"Font style:":{zh:""},Fur:{zh:""},Gamma:{zh:""},"Gamma:":{zh:""},"Gap:":{zh:""},Gradient:{zh:""},"Gradient Radius:":{zh:""},Grains:{zh:""},"Grains level:":{zh:""},Gray:{zh:""},GrayScale:{zh:""},Green:{zh:""},"Green channel:":{zh:""},"Greyscale:":{zh:""},Grid:{zh:""},"Grid on/off":{zh:"/"},Grouped:{zh:""},"H Radius:":{zh:"^ h"},"HSL Adjustment":{zh:"Hsl"},Harmony:{zh:""},Heatmap:{zh:""},"Height (%):":{zh:""},"Height (pixels):":{zh:""},"Height:":{zh:""},Help:{zh:""},Helvetica:{zh:""},Hermite:{zh:""},Histogram:{zh:""},"Histogram:":{zh:""},Horizontal:{zh:""},"Horizontal gap:":{zh:""},"Hue:":{zh:""},Image:{zh:""},"Image filters":{zh:""},Impact:{zh:""},"Imports images":{zh:""},Information:{zh:""},"Invalid color component":{zh:""},Italic:{zh:""},"JPG - JPG/JPEG Format":{zh:"Jpg - jpg / jpeg"},"JPG Compression":{zh:"Jpg"},"JSON - Full layers data":{zh:"Json - "},"KD-tree":{zh:"Kd"},"Key-points":{zh:""},"Keyboard Shortcuts":{zh:""},Language:{zh:""},Layer:{zh:""},"Layer #":{zh:""},Layers:{zh:""},Left:{zh:""},"Level:":{zh:""},"Levels:":{zh:""},"Lietuvi":{zh:""},"Light leak:":{zh:""},"Limit:":{zh:""},"Luminance:":{zh:""},"Luminosity:":{zh:""},"Magic Wand Tool":{zh:""},Merge:{zh:""},"Merge Down":{zh:""},"Mode:":{zh:""},Mosaic:{zh:""},"Mouse:":{zh:""},Move:{zh:""},"Move active layer by 10px":{zh:"10px"},"Move active layer by 1px":{zh:"1px"},"Move active layer by 50px":{zh:"50"},"Move down":{zh:""},"Move up":{zh:""},"Multi-line":{zh:""},"Name:":{zh:""},Negative:{zh:""},New:{zh:""},"New file...":{zh:"..."},"New layer":{zh:""},No:{zh:""},Normal:{zh:""},Notice:{zh:""},"Notice:":{zh:""},Oil:{zh:""},Ok:{zh:""},"Online image editor":{zh:""},Opacity:{zh:""},Open:{zh:""},"Open file(s)":{zh:"s"},"PNG - Portable Network Graphics":{zh:"Png - "},Paste:{zh:""},"Paste selection":{zh:""},Pencil:{zh:""},Perspective:{zh:""},"Pick Color":{zh:""},Posterize:{zh:""},"Power:":{zh:""},"Pre-Blur:":{zh:""},Preview:{zh:""},Print:{zh:""},"Quality (jpeg):":{zh:"jpeg"},"Quality:":{zh:""},Radial:{zh:""},"Radius:":{zh:""},"Range:":{zh:""},"Reason:":{zh:""},"Recover alpha":{zh:""},Red:{zh:""},"Red channel:":{zh:""},"Resample - Hermite":{zh:" - "},Resize:{zh:""},"Restore alpha":{zh:""},Right:{zh:""},Rotate:{zh:""},"Rotate left":{zh:""},Rotation:{zh:""},"SHIFT + Arrow keys":{zh:"Shift +"},"Saturation:":{zh:""},Save:{zh:""},"Save as":{zh:""},"Save as type:":{zh:""},"Save layers:":{zh:""},"Select all":{zh:""},"Select area first":{zh:""},"Select area tool":{zh:""},"Select color":{zh:""},"Select object tool":{zh:""},Selected:{zh:""},"Sensitivity:":{zh:""},Sepia:{zh:""},Shaded:{zh:""},"Shadow blur:":{zh:""},"Shadow color:":{zh:""},"Shadow:":{zh:""},Sharpen:{zh:""},"Sharpen tool":{zh:""},"Sharpen:":{zh:""},"Show / Hide":{zh:""},Simple:{zh:""},Size:{zh:""},"Size:":{zh:""},Sketchy:{zh:""},Solarize:{zh:""},Sorry:{zh:""},"Source is empty, right click on image first.":{zh:""},"Source:":{zh:""},Sprites:{zh:""},Square:{zh:""},"Strength:":{zh:""},Strict:{zh:""},Stroke:{zh:""},"Stroke size:":{zh:""},Text:{zh:""},"Text:":{zh:""},"The image could not be loaded.":{zh:""},"This can not be last layer":{zh:""},"This can not be last layer.":{zh:""},"Tilt Shift":{zh:""},"Times New Roman":{zh:""},"To paste from clipboard, use Ctrl-V.":{zh:"ctrl-v"},Tools:{zh:""},"Top-left":{zh:""},"Top-right":{zh:""},"Total pixels:":{zh:""},"Translate error, can not find dictionary:":{zh:""},"Transparency #1:":{zh:"1"},"Transparency #2:":{zh:"2"},"Transparent:":{zh:""},Trim:{zh:""},"Trim:":{zh:""},Undo:{zh:""},"Unique colors:":{zh:""},Up:{zh:""},"V Radius:":{zh:"V"},Verdana:{zh:""},Vertical:{zh:""},"Vertical gap:":{zh:""},Vignette:{zh:""},"Vignette amount:":{zh:""},"Vignette size:":{zh:""},ViliusL:{zh:"Viliusl"},Vintage:{zh:""},"Visible:":{zh:""},"WEBP - Weppy File Format":{zh:"Webp - weppy"},Website:{zh:""},"Width (%):":{zh:""},"Width (pixels):":{zh:""},"Width:":{zh:""},"X end:":{zh:"X"},"X start:":{zh:"X"},"Y end:":{zh:"Y"},"Y start:":{zh:""},Yes:{zh:""},"Your browser do not support this format.":{zh:""},"Your browser doesn't support canvas.":{zh:""},Zoom:{zh:""},"Zoom in":{zh:""},"Zoom out":{zh:""},"Zoom:":{zh:""}},EL=new ELEMENTS_CLASS,BezierCurveBrush={iPrevX:0,iPrevY:0,points:null,init:function(){},startCurve:function(e,a){this.iPrevX=e,this.iPrevY=a,this.points=new Array},getPoint:function(e,a){var t,i=a.length-e;for(t=i;t<a.length;t++)if(a[t])return a[t]},draw:function(e,a,t,i,r){if(Math.abs(this.iPrevX-t)>5||Math.abs(this.iPrevY-i)>5){this.points.push([t,i]),e.beginPath(),e.moveTo(this.iPrevX,this.iPrevY),e.lineTo(t,i),e.lineWidth=r,e.lineCap="round",e.lineJoin="round",e.strokeStyle="rgba("+a.r+", "+a.g+", "+a.b+", 0.9)",e.stroke(),e.closePath(),e.lineWidth=1,e.strokeStyle="rgba("+a.r+", "+a.g+", "+a.b+", 0.2)",e.beginPath();var s=this.getPoint(25,this.points),n=this.getPoint(1,this.points),o=this.getPoint(5,this.points);e.moveTo(s[0],s[1]),e.bezierCurveTo(n[0],n[1],o[0],o[1],t,i),e.stroke(),e.closePath(),this.iPrevX=t,this.iPrevY=i}}},EVENTS=new EVENTS_CLASS,CLIPBOARD=new CLIPBOARD_CLASS("",(!1)),FILE=new FILE_CLASS,EDIT=new EDIT_CLASS,IMAGE=new IMAGE_CLASS,LAYER=new LAYER_CLASS,EFFECTS=new EFFECTS_CLASS,TOOLS=new TOOLS_CLASS,DRAW=new DRAW_TOOLS_CLASS,GUI=new GUI_CLASS,HELP=new HELP_CLASS,canvas_back,canvas_front,canvas_grid,canvas_preview,layers_archive=[{},{},{}],VERSION="3.1.1",WIDTH,HEIGHT,COLOR="#0000ff",ALPHA=255,LANG="en",DRAW_TOOLS_CONFIG=[{name:"select_tool",title:"Select object tool",icon:[null,7,2],attributes:{}},{name:"select_square",title:"Select area tool",icon:[null,-46,5],attributes:{}},{name:"magic_wand",title:"Magic Wand Tool",icon:[null,-149,-48],attributes:{power:40,anti_aliasing:!0}},{name:"erase",title:"Erase",icon:[null,-97,4],attributes:{size:20,circle:!0,strict:!0}},{name:"fill",title:"Fill",icon:[null,-147,3],attributes:{power:0,anti_aliasing:!1}},{name:"pick_color",title:"Pick Color",icon:[null,-197,3],attributes:{}},{name:"pencil",title:"Pencil",icon:[null,-247,3],attributes:{}},{name:"line",title:"Draw line",icon:[null,-297,3],attributes:{size:1,type_values:["Simple","Multi-line","Arrow","Curve"]}},{name:"letters",title:"Draw letters",icon:[null,-347,4],attributes:{}},{name:"draw_square",title:"Draw rectangle",icon:[null,-397,5],attributes:{fill:!1,square:!1}},{name:"draw_circle",title:"Draw circle",icon:[null,-447,5],attributes:{fill:!1,circle:!1}},{name:"brush",title:"Brush",icon:[null,-494,3],attributes:{type:"Brush",type_values:["Brush","BezierCurve","Chrome","Fur","Grouped","Shaded","Sketchy"],size:5,anti_aliasing:!1},on_update:"update_brush"},{name:"blur_tool",title:"Blur tool",icon:[null,-245,-48],attributes:{size:30,power:1}},{name:"sharpen_tool",title:"Sharpen tool",icon:[null,-295,-48],attributes:{size:30}},{name:"burn_dodge_tool",title:"Burn/Dodge tool",icon:[null,-497,-46],attributes:{burn:!0,size:30,power:50}},{name:"desaturate_tool",title:"Desaturate",icon:[null,-547,4],attributes:{size:50,anti_aliasing:!0}},{name:"clone_tool",title:"Clone tool",icon:[null,-346,-47],attributes:{size:30,anti_aliasing:!0}},{name:"gradient_tool",title:"Gradient",icon:[null,-397,-46],attributes:{radial:!1,power:50}},{name:"crop_tool",title:"Crop",icon:[null,-448,-48],attributes:{}}],COLORS_DATA=[["#ff0000","#ff5b31","#ffa500","#ff007f","#ff00ff"],["#00ff00","#008000","#7fff00","#00ff7f","#8ac273"],["#0000ff","#007fff","#37629c","#000080","#8000ff"],["#ffff00","#ffff80","#ddd06a","#808000","#bcb88a"],["#ffffff","#c0c0c0","#808080","#404040","#000000"]];ddsmoothmenu.arrowimages={down:["downarrowclass","",23],right:["rightarrowclass","",6],left:["leftarrowclass",""]};var MENU_ID="main_menu",MAIN=new MAIN_CLASS;